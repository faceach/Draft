<!DOCTYPE html><html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:Web="http://schemas.live.com/Web/"><script type="text/javascript">//<![CDATA[
si_ST=new Date;
//]]></script><head><!--pc--><title>Remind me to buy milk at 9 o'clock tomorrow. - Bing</title><meta content="text/html; charset=utf-8" http-equiv="content-type"/><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="mobileoptimized" content="0"/><link href="/search?format=rss&amp;speech=1&amp;input=2&amp;cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1" rel="alternate" title="XML" type="text/xml"/><link href="/search?format=rss&amp;speech=1&amp;input=2&amp;cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1" rel="alternate" title="RSS" type="application/rss+xml"/><link href="/sa/simg/bing_p_rr_teal_min.ico" rel="shortcut icon"/><script type="text/javascript">//<![CDATA[
_G={ST:(si_ST?si_ST:new Date),Mkt:"en-US",RTL:false,Ver:"21",IG:"eb79d25414acf5972aaf91eb2256152c",EventID:"BD173DDF797A4F5BA406E39519A96088",MN:"SERP",V:"web",P:"SERP",DA:"HK2",SUIH:"6L6HK5vf0HcWnonykcnXKw",gpUrl:"\/fd\/ls\/GLinkPing.aspx?"};_G.lsUrl="/fd/ls/l?IG="+_G.IG;curUrl="https:\/\/www.bing.com\/speech_render";_G.XLS="\/threshold\/xls.aspx";;_G.nclid='5843B1284CE21CF49556CE1C9F256103';///<reference path="..\..\..\answers\services\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
if (!window.onerror) {
    // Chrome recently started passing in 5th argument as errorObject that contains error stack
    window.onerror = function (message, url, lineNumber, columnNumber, errorObject) {
        var undefined = "undefined";
        var logData;
        if (typeof errorObject === undefined && typeof event !== undefined && event) {
            // on IE and Edge, errorObject argument is not set, but the same data is available in event.error
            errorObject = event["error"];
        }
        if (typeof message === "object" && message.srcElement && message.srcElement.src) {
            //BUGBUG: 628140 -  JS Script Error Inst:  Investigate why we never hit the supposed special error 
            //                  handler for Chrome
            //Chrome passes only a ScriptError Object to the onerror function.
            logData = { ScriptSrc: message.srcElement.src };
            if (sj_evt) {
                sj_evt.fire("ErrorInstrumentation", JSON.stringify(logData));
            }
        }
        else {
            if (typeof SharedLogHelper !== undefined) {
                //for others we get a message, url and a line number.
                SharedLogHelper.LogError(url, message.toString(), errorObject, lineNumber, columnNumber);
            }
            else {
                window.addEventListener("load", function () { return SharedLogHelper.LogError(url, message.toString(), errorObject, lineNumber, columnNumber); });
            }
        }
    };
}
;
//]]></script><style type="text/css">img,.cbtn,.sb_meta li,.exp_trwr .sc_rc1,.topBar .bg,.vidr cite.nowrap{vertical-align:bottom}img.img_fav,img.twss,img.twsi,img.sa_iconR{vertical-align:baseline}img.img_msn_icon,td.msn_btn_icon img{vertical-align:text-top}#sb_foot{margin-top:-3px}div.sb_adsWv2 h2.sb_title{display:block}#fbpgbt{background:#f2f2f2;border:1px solid #999;bottom:0;color:#36b;cursor:pointer;display:block;font-family:Arial,sans-serif;font-size:13px;font-weight:bold;height:28px;line-height:28px;min-width:110px;padding:0 5px;position:fixed;right:0;text-align:center;z-index:1000000}#fbpgbt:hover{background:#e5e5e5;text-decoration:none}#fbpgbt img{border:0;height:14px;margin:0 5px -4px 0;width:14px;vertical-align:baseline}a{a:1}/* Prevent pinch and zoom and double tap zoom */
html,body
{
    -ms-content-zooming: none;
}
/* set font-faces for Segoe UI typography */

@font-face {
    font-family: Segoe;
    font-weight: 200;
    src: local("Segoe UI Light"), local("Segoe WP Light");
}
@font-face {
    font-family: Segoe;
    font-weight: 300;
    src: local("Segoe UI Semilight"), local("Segoe WP Semilight");
}
@font-face {
    font-family: Segoe;
    font-weight: normal;
    src: local("Segoe UI"), local("Segoe WP");
}
@font-face {
    font-family: Segoe;
    font-weight: 600;
    src: local("Segoe UI Semibold"), local("Segoe WP Semibold");
}
@font-face {
    font-family: Segoe;
    font-weight: 700;
    src: local("Segoe UI Bold"), local("Segoe WP Bold");
}
/* The lang attribute match is a goofy hack to increase selector specificity on the top-level element. */

html[lang] {
  overflow-y: auto;
  -ms-overflow-style: -ms-autohiding-scrollbar;
}
/* register with SegoeFontFaces as a dependency */

header#b_header:not(:empty) {
  border-bottom/*bingcss-ignore hardcoding a Threshold-specific color */: 1px solid #cccccc;
}
#b_header:not(:empty),
.peek .b_msg/* See more recourse link also needs to be 15px */ {
  font: normal 15px/20px Segoe, Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(am, ti) {
  font-family: Ebrima, Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(as, bn, gu, hi, kn, kok, ml, mr, ne, or, pa, si, ta, te) {
  font-family: "Nirmala UI", Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(chr-CHER-US) {
  font-family: Gadugi, Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(ja) {
  font-family: "Yu Gothic UI", Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(ko) {
  font-family: "Malgun Gothic", Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(th, km, lo) {
  font-family: "Leelawadee UI", Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(zh-CN, zh-Hans, zh-SG) {
  font-family: "Microsoft YaHei UI", Arial, sans-serif;
}
#b_header:not(:empty):-ms-lang(zh-HK, zh-TW, zh-Hant, zh-MO) {
  font-family: "Microsoft JhengHei UI", Arial, sans-serif;
}
#b_header .square_mi,
.b_msg .square_mi {
  width: 24px;
  font-size: 24px;
  line-height: 24px;
}
body header:not(:empty):not(.b_hide)#b_header ~ #b_content {
  margin-top: 45px;
}
/* Peek pages want no top margin since they've hidden the header */

header.b_hide#b_header ~ #b_content,
header:empty#b_header ~ #b_content {
  margin-top: 0px;
}
#b_header .b_scopebar {
  background-color: #eeeeee;
}
#b_header .b_scopebar,
#b_header .b_scopebar a,
#b_header .b_scopebar a:visited,
#b_header .b_mystuff::before,
header#b_header .b_symb {
  color/*bingcss-ignore hardcoding a Threshold-specific color */: #767676;
}
#b_header .b_scopebar li.b_active a,
#b_header .b_scopebar li.b_active a:visited,
#b_header .b_scopebar span {
  color/*bingcss-ignore hardcoding a Threshold-specific color */: black;
  border-color/*bingcss-ignore hardcoding a Threshold-specific color */: #f84e29;
}
/* This is page-specific CSS in the header bundle that we need to retain */

#b_results a.sb_pagS {
  color/* bingcss-ignore: hardcoded from brand bundle header */: #333333;
  border: none;
  font-weight: normal;
}
#b_results .sb_pag a {
  padding/* bingcss-ignore: hardcoded from brand bundle header */: 9px 13px;
}
.sw_plus,
.b_cm,
.sw_up,
.sw_down,
.sw_st,
.sw_sth,
.sw_ste,
.idp_wlid,
.sw_meIc,
.sw_pref,
.sw_tpcbk,
.sw_play,
.sw_playd,
/* disabled */ .sw_playa,
/* active */ .sw_playp,
/* paused */ .sw_spd,
.b_fLogo,
.sb_pagIconN,
.sb_pagIconP {
  background-image: url(/sa/simg/sw_mg_l_4f_m_w2.png);
  background-repeat: no-repeat;
  background-size: 320px 38px;
}
/* Add icon */

.sw_plus {
  background-position: -216px 0;
  height: 10px;
  width: 10px;
}
.idp_wlid,
.sw_meIc,
.sw_pref,
.sw_play,
/*Play icon*/ .sw_playa,
/* active */ .sw_playd,
/* disabled */ .sw_playp/* paused */ {
  height: 16px;
  width: 16px;
}
.sw_play {
  background-position: -228px 0;
}
.sw_playa,
.sw_playd {
  background-position: -246px 0;
}
.sw_playp {
  background-position: -264px 0;
}
.b_cm,
/* Check mark */ .sw_up,
/* Up (collapse) */ .sw_down/* down (expand) */ {
  height: 14px;
  width: 14px;
}
.sw_down {
  background-position: -184px 0;
}
.sw_up {
  background-position: -152px 0;
}
*:active > .sw_up,
*:focus > .sw_up {
  background-position: -168px 0;
}
*:active > .sw_down,
*:focus > .sw_down {
  background-position: -200px 0;
}
/* Check mark */

.b_cm {
  background-position: -282px 0;
}
/* rating star */

.sw_st,
/* full gold */ .sw_sth,
/* left half star */ .sw_ste/* empty (light grey) */ {
  height: 14px;
  width: 14px;
  display: inline-block;
}
.sw_st {
  background-position: -238px -22px;
}
.sw_sth {
  background-position: -270px -22px;
}
.sw_ste {
  background-position: -254px -22px;
}
/* Rewards */

.sw_meIc {
  background-position: -180px -22px;
}
#spcv .sw_meIc,
.rigleamon .sw_meIc {
  background-position: -198px -22px;
}
/* Preference */

.sw_pref {
  background-position: -301px -22px;
}
/* Windows Live ID Icon */

.idp_wlid {
  background-position: -75px -22px;
}
/* default user icon */

.sw_spd {
  background-position: -299px 0;
  height: 20px;
  width: 20px;
}
/* Footer logo */

.b_fLogo {
  background-position: -94px -22px;
  height: 16px;
  width: 81px;
}
.sw_tpcbk {
  background-position: -124px 0px;
}
.sb_pagIconN {
  background-position: -168px 0;
}
.sb_pagIconP {
  background-position: -200px 0;
}
.sb_pagIconN,
.sb_pagIconP {
  -webkit-transform: rotate(90deg);
  -moz-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  -o-transform: rotate(90deg);
  transform: rotate(90deg);
}
/* START COLORS */

html,
body {
  background-color: #e5e5e5;
}
#b_results > .b_pag/* Task 1249184 : [Mobile 1st][wholepage] Paginiation - Remove legacy style after change ajax pagination */ {
  background-color: #e5e5e5;
}
body,
.b_promoteText {
  color: #404040;
}
input[type="text"] {
  color: #bbbbbb;
  border-color: #bbbbbb;
}
input[type="text"]:focus {
  color: #404040;
  border-color: #404040;
}
#b_pole .b_ans {
  background-color: white;
}
#b_results,
#b_results .b_defaultText,
.cbl/* label in Factrow */ {
  color: #404040;
}
#b_results > li a {
  color: #1020d0;
}
.b_pag a.sb_pagS,
/* Task 1249184 : [Mobile 1st][wholepage] Paginiation - Remove legacy style after change ajax pagination */ #b_results > li,
#b_content > .sml/* Morepage pagination */ {
  background-color: white;
}
#b_results > .b_ad {
  color: #303030;
  background-color: #f9fcf7;
}
#b_results > .b_ad a {
  color: #0a0cd9;
}
#b_results > .b_ad a:visited {
  color: #600090;
}
#b_results p {
  color: #333333;
}
a,
#b_results .b_no a {
  color: #1020d0;
}
a:visited,
#b_results > li a:visited,
#sb_feedback:visited {
  color: #600090;
}
cite,
#b_results cite.sb_crmb a,
/* Even breadcrumb links in the cite tag need to respect its color */ #b_results cite a.sb_metalink/* Even attribution links in the cite tag need to respect its color */ {
  color: #008900;
}
.b_factrow,
.b_attribution,
.b_focusLabel,
.b_secondaryFocus,
.b_secondaryText,
.b_demoteText,
.b_footnote,
.b_footnote .cbl,
.b_entitySubTitle {
  color: #737373;
}
#b_content .b_imagePair .b_footnote a,
#b_content .b_imagePair .b_footnote a:visited,
#b_content .b_floatR_img .b_footnote a,
#b_content .b_floatR_img .b_footnote a:visited {
  color: #737373;
}
/* footer */

footer {
  color: #777777;
  background-color: #e5e5e5;
  /* Task 5408580 [change to transparent]: Need remove when flight mobvertcard ship */

}
footer a,
footer a:visited,
footer span {
  color: #333333;
}
/* end of footer */

/*secondary text styles*/

.sb_meta,
label {
  color: #737373;
}
/* highlighted buttons */

.cbtn input {
  color: #1020d0;
  background-color: white;
}
.cbtn input:active {
  color: white;
  background-color: #737373;
}
.s_btn.brd.b_highlighted,
.cbtn.b_highlighted input {
  background: #1020d0;
  border-color: #1020d0;
}
.cbtn.b_highlighted input,
input.b_highlighted:focus,
#b_results .s_btn.b_highlighted a:visited,
#b_results .s_btn.b_highlighted a,
#b_results .s_btn.b_highlighted/* #b_results is needed to fix a bug that the button text color remains blue when the background turns blue in highlighted mode, and it is to revert "#b_results>li a { color:blue}" */ {
  color: white;
}
.cbtn.b_highlighted input:active {
  background: #666666;
  border-color: #666666;
}
.b_touchable,
.b_touchable > li {
  border-color: #eeeeee;
}
select {
  background-color: white;
}
.b_subModule,
.b_suppModule {
  border-bottom-color: #e5e5e5;
}
/* Primary alteration in spell suggest */

#b_results .b_pAlt {
  color: #d90026;
}
.b_alert,
#b_results .b_no .b_alert {
  color: #d90026;
}
#b_results .b_alert {
  color: #d90026;
}
.pushpin {
  background: #4499ff;
  color: white;
}
.b_posText {
  color: #339900;
}
.b_negText {
  color: #d90026;
}
/* END COLORS */

/*This file is intentionally left empty*/
z
{
    a:1;
}h3,
h4,
h5 {
  font: inherit;
  font-size: 100%;
}
body {
  font-family: "-apple-system", HelveticaNeue, Roboto, Arial, sans-serif;
  font-weight: normal;
  font-size: 14px;
  line-height: 18px;
}
cite {
  font-style: normal;
  white-space: nowrap;
}
.b_strong,
strong,
.b_no h4 {
  font-weight: 700;
  font-family: "-apple-system", HelveticaNeue, Roboto, Arial, sans-serif;
}
h1,
h2,
.b_focusLabel,
.b_secondaryFocus,
.b_groupLabel {
  font-size: 18px;
  line-height: 22px;
  font-weight: normal;
}
.b_anno {
  font-size: 20px;
  line-height: 24px;
  font-weight: normal;
}
select,
.cbtn input,
.s_btn.b_highlighted a,
input[type="text"] {
  font-size: 14px;
}
#fti3,
.sb_count {
  font-size: 12px;
  line-height: 14px;
}
.ftr_ans,
#ftrLnks,
#id_rwds_b {
  font-size: 13px;
  line-height: 16px;
}
/* medium text */

.b_mText {
  font-size: 16px;
  line-height: 20px;
}
/*Focus text styles*/

.b_xlText {
  font-size: 18px;
}
.b_secondaryFocus,
.b_focusTextExtraSmall {
  font-size: 18px;
  line-height: 22px;
}
.b_focusTextSmall {
  font-size: 23px;
  line-height: 28px;
  font-family: "-apple-system", HelveticaNeue, Roboto, Arial, sans-serif;
}
.b_focusTextMedium {
  font-size: 32px;
  line-height: 38px;
  font-family: "-apple-system", HelveticaNeue, Roboto, Arial, sans-serif;
}
.b_focusTextLarge {
  font-size: 44px;
  line-height: 53px;
  font-family: "-apple-system", HelveticaNeue, Roboto, Arial, sans-serif;
}
.b_footnote {
  font-size: 12px;
  line-height: 15px;
}
.b_smText {
  font-size: 11px;
}
.nowrap {
  white-space: nowrap;
}
a,
#b_results .b_rs li a {
  text-decoration: none;
}
#sp_requery a {
  font-style: italic;
}
th {
  font-weight: normal;
}
.pushpin {
  font-weight: 700;
  font-size: 12px;
}
.b_ad {
  line-height: 18px;
}
/* begin basic page values */

html,
body,
h1,
h2,
h3,
h4,
h5,
h6,
p,
img,
ol,
ul,
li,
form,
table,
tr,
th,
td,
blockquote {
  border: 0;
  border-collapse: collapse;
  border-spacing: 0;
  list-style: none;
  margin: 0;
  padding/* bingcss-ignore TFS: 641967 - Fix existing whitelist files to be complaint with CSS Cop rules */: 0;
}
html {
  overflow-y: scroll;
}
/* This ensures that any words that we will not fit in the width are wrapped */

/* We first try to hyphenate it, and only if that fails we break the word */

body {
  word-wrap: break-word;
  overflow-x: hidden;
  /* no left and right movement */
  -webkit-text-size-adjust: none;
  /* no text adjustment on phone rotation */

}
/* end basic page values */

header#b_header:not(:empty):not(.b_hide) ~ #b_content {
  margin-top: 80px;
}
.b_footnote {
  padding-bottom: 15px;
}
.b_imagePair .cico + .b_footnote,
.b_floatR_img .b_footnote,
img + .b_footnote {
  padding/* bingcss-ignore: we need to add padding between the image and the footnote */: 0 0 0;
}
.b_hList {
  padding-bottom: 15px;
}
input[type="text"] {
  -webkit-appearance: none;
  margin: 0 0 15px 0;
  padding: 0 10px;
  height: 38px;
  border-width: 1px;
  border-style: solid;
  border-radius: 0;
  max-width: 100%;
  min-width: 50%;
}
h2,
h4,
label,
.b_attribution,
.b_sSpace,
.b_label,
.btns,
.b_poiPair,
.b_focusLabel,
.b_secondaryFocus {
  padding-bottom: 0;
}
h2 a,
h3 a,
h4 a,
h5 a,
.b_rs a,
label {
  display: block;
}
.inline label {
  display: inline;
}
#sp_requery a {
  display: inline-block;
}
.b_focusTextLarge,
.b_focusTextMedium,
.b_focusTextSmall,
.b_focusTextExtraSmall {
  padding-bottom: 5px;
}
.b_lBMargin,
h2.b_entityTitle {
  padding-bottom: 10px;
}
.b_focusLabel,
.b_secondaryFocus {
  padding-bottom: 5px;
}
.b_rich {
  padding: 12px 0 15px;
}
.b_rich > *:last-child,
.b_caption > *:last-child {
  padding-bottom: 0;
  margin-bottom: 0;
}
.b_caption {
  padding-bottom: 13px;
}
.b_factrow {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  margin-bottom: 0;
}
.b_attribution {
  width: 100%;
}
.cbtn input,
.b_attribution,
.b_factrow {
  overflow: hidden;
  text-overflow: ellipsis;
}
.b_mBottom {
  padding-bottom: 5px;
}
.b_lBottom {
  padding-bottom: 10px;
}
.b_xlBottom {
  padding-bottom: 15px;
}
.b_xxlBottom {
  padding-bottom: 20px;
}
.b_xxxlBottom {
  padding-bottom: 25px;
}
.b_dataList > li > *,
.b_imagePair .b_attribution > *,
.b_factrow > * {
  display: inline;
}
.b_groupLabel {
  padding-bottom: 3px;
}
.b_anno {
  padding-bottom: 20px;
}
.b_anno + .b_rich,
.b_anno + h2 + .b_rich {
  padding-top/* bingcss-ignore: Need to eat the top padding from b_rich */: 0;
}
.b_vPanel > div {
  padding-bottom: 15px;
}
.b_vList > li {
  padding-bottom: 13px;
}
#b_results > li.si_pp,
.sb_hbop,
.b_hide,
#fRmsDefer,
#b_error,
#b_loadingmsg {
  display: none;
}
/* begin vertical lists */

.b_rich > *:last-child,
.b_rich > .b_vList:not(.b_touchable) > li:last-child,
.b_rich > .b_vPanel > div:last-child,
.b_vPanel .b_vList:not(.b_touchable) > li:last-child,
.b_vList .b_vPanel > div:last-child,
.b_hList .b_vList > li:last-child,
.b_hList .b_vPanel > div:last-child,
.b_vList > li > *:last-child:not(a),
/* the last non-link child of vertical list items should have no bottom padding */ .b_vPanel > div > *:last-child:not(a),
/* the last non-link child of vertical stack panel items should have no bottom padding */ .b_subModule > *:last-child,
.b_subModule .b_vPanel > *:last-child,
.b_subModule > .b_vList:last-child > *:last-child,
.b_suppModule > *:last-child,
.b_suppModule .b_vPanel > *:last-child,
.b_infocardContent > .b_vList:last-child > *:last-child,
.b_infocardContent > *:last-child,
.sa_uc > .b_vList > li:last-child,
.sa_uc > .b_vList > li:last-child > .b_vList:last-child > li:last-child,
.b_ans > .b_vList > li:last-child {
  padding-bottom: 0;
}
.b_vlist2col > ul {
  min-width: 40%;
  display: inline-block;
  word-wrap: break-word;
  vertical-align: top;
}
.b_vlist2col > ul:first-child {
  padding-right: 30px;
}
.b_vlist2col li {
  padding-bottom: 15px;
}
/* vertical touchable list adds borders and extra space between items */

.b_touchable > li {
  border-bottom-width: 1px;
  border-bottom-style: solid;
  padding-bottom: 13px;
  margin-bottom: 13px;
}
.b_touchable > li:first-child {
  border-top-width: 1px;
  border-top-style: solid;
  padding-top/* bingcss-ignore:  Top padding is OK before first element in a container */: 15px;
}
.b_rich > .b_touchable:last-child > li:last-child,
.b_vPanel .b_touchable:last-child > li:last-child {
  margin-bottom: 0;
}
/* end vertical lists */

/* horizontal stack panel */

.b_hPanel > span:not(:last-child),
.b_hList > li:not(:last-child) {
  padding-right: 10px;
}
.b_hList > li {
  vertical-align: top;
}
.b_hPanel.wide > span:not(:last-child) {
  padding-right: 20px;
}
.b_suffix {
  padding-left: 10px;
  /* intentionally matches horizontal stack panel spacing */

}
/* begin image/content horizontal pair */

.b_imagePair {
  padding-bottom: 10px;
}
.b_imagePair img {
  vertical-align: bottom;
}
.b_float_img > *:last-child,
.b_imagePair > *:last-child {
  overflow: hidden;
}
.b_float_img > *:first-child,
.b_imagePair > *:first-child {
  margin-right: 10px;
  float: left;
}
.b_floatR_img {
  float: right;
  padding-left: 10px;
}
.b_float_img {
  float: left;
  padding-bottom: 10px;
}
.b_float_img img {
  vertical-align: bottom;
}
.b_imagePair.reverse {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flexbox;
  display: -webkit-box;
  display: flex;
}
.b_imagePair.reverse > *:first-child {
  -o-box-flex: 1;
  /* opera */
  -webkit-box-flex: 1;
  /* OLD - iOS 6-, Safari 3.1-6 */
  -moz-box-flex: 1;
  /* OLD - Firefox 19- */
  -webkit-flex: 1;
  /* Chrome */
  -ms-flex: 1;
  /* IE 10 */
  flex: 0 1 100%;
  float: none;
}
.b_imagePair.reverse > *:last-child {
  -ms-flex: 0 0 auto;
  flex: 0 0 auto;
}
.b_imagePair.reverse > *:only-child {
  -ms-flex: 1;
  flex: 0 1 100%;
  margin-right: 0;
}
/* vm=vertial middle. This can be used in control/component/views to vertically middle align the content of the element who uses this class. */

.b_vmparent {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flexbox;
  display: -webkit-box;
  display: flex;
  -webkit-align-items: center;
  align-items: center;
}
/* end image/content horizontal pair */

button,
.button {
  /* The width and style are intentionally set separate so the color is not overridden */
  border-width: 3px;
  border-style: solid;
  padding/* bingcss-ignore TFS: 641967 - Fix existing whitelist files to be complaint with CSS Cop rules */: 8px 18px 12px;
}
.b_hPanel > span,
.b_moreLink,
.b_footnote .cico,
.b_hList > li,
.b_title div,
.csrc/*csrc - Mobile Common Star Rating Control*/ {
  display: inline-block;
}
.b_hPanel > span {
  vertical-align: middle;
}
.b_title h2/* inline title prefix and suffix */ {
  display: inline;
}
.b_title .b_imagePair .rms_img {
  margin-top: 3px;
  /* align with the title */

}
.b_relative {
  position: relative;
}
.b_footnote .cico {
  padding-left: 10px;
}
#b_error div {
  padding-bottom: 20px;
}
/* floats */

.b_mhdr h2,
.b_float {
  float: left;
}
.b_floatR {
  float: right;
}
/* end floats */

.b_rTxt {
  text-align: right;
}
.b_cTxt {
  text-align: center;
}
.b_jTxt {
  text-align: justify;
}
select::-ms-expand {
  display: none;
}
select {
  padding-left: 10px;
  margin-bottom: 15px;
  height: 40px;
  border-radius: 0;
  vertical-align: middle;
  border: 1px solid #bbbbbb;
}
.b_moreLink {
  padding-bottom: 15px;
}
.b_mhdr .b_floatR {
  margin-top/* bingcss-ignore: vertically align floated text in module header */: 4px;
}
.b_mhdr .b_moreLink {
  padding-bottom: 0;
}
.b_algo p,
.b_ans p {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  -webkit-line-clamp: 3;
}
.b_factrow:after {
  content: "";
}
/* results stack */

#b_results > li,
#b_pole .b_ans {
  padding/* bingcss-ignore:  Top padding is OK before first element in a container */: 13px 10px;
  margin: 0 0 1px;
  border-bottom: 0 solid #e5e5e5;
}
#b_results > li .b_fullb,
#b_pole .b_ans .b_fullb {
  margin-left: -10px;
  margin-right: -10px;
}
#b_results > .b_ans {
  padding-bottom: 13px;
}
#b_results > .b_algo {
  padding-bottom: 13px;
}
#b_results > .b_ad {
  padding-bottom: 0;
}
/* Task 5408580 : Need remove when flight mobvertcard ship */

#b_results > .b_ad + .b_algo,
#b_results > .b_ad + .b_ans {
  padding-top/* bingcss-ignore: Top margin is OK between ads+algo and ads+ans */: 13px;
}
/* Task 5408580 : Need remove when flight mobvertcard ship */

#b_results .b_ans + .b_ad,
#b_results .b_ans + .b_algo,
#b_results .b_ans + .b_ans,
#b_results .b_algo + .b_ans,
#b_results .b_nav + .b_algo {
  margin-top/* bingcss-ignore:  Top margin is OK between ans+ans and ans+algo and algo+ans */: 9px;
  border-top: 0 solid #e5e5e5;
}
#b_results > li > *:last-child,
.b_caption > *:last-child,
.vlist > li:last-child,
.b_vPanel > li:last-child,
.lft > *:last-child {
  margin-bottom: 0;
  padding-bottom: 0;
}
/* Task 5408580 : Need remove when flight mobvertcard ship */

#b_results > .b_pag/* Task 1249184 : [Mobile 1st][wholepage] Paginiation - Remove legacy style after change ajax pagination */ {
  padding/* bingcss-ignore:  Top padding is OK before first element in a container */: 10px 10px;
}
#b_tween/* Task 1249184 : [Mobile 1st][wholepage] Paginiation - Remove legacy style after change ajax pagination */ {
  padding/* bingcss-ignore:  Top padding is OK before first element in a container */: 8px 10px;
  margin: 0 10px;
}
/* end of results stack */

/* related search and deeplink */

#b_results > li > .b_rs,
/*override the rule of #b_results > li > *:last-child which default is 0*/ #b_results > li .b_deep/*override the rule of #b_results > li > *:last-child which default is 0*/ {
  margin-bottom: -15px;
}
.b_deep li > a,
.b_deep li > span > a {
  width: 110px;
  text-overflow: ellipsis;
  display: block;
  white-space: nowrap;
  overflow: hidden;
}
.b_rs > .b_rich {
  padding-bottom: 0;
}
/* end of related search */

.clrfix:after,
/* Task 1249184 : [Mobile 1st][wholepage] Paginiation - Remove legacy style after change ajax pagination */ .crch:after,
.b_imagePair:after,
.b_clearfix:after,
.sb_vdl:after {
  clear: both;
  content: '.';
  display: block;
  visibility: hidden;
  height: 0;
}
/* footer styles */

#ftrLnks li {
  display: inline-block;
  padding: 0 20px 15px 0;
}
#ftrLnks > *:last-child {
  padding-right: 0;
}
footer {
  padding/* bingcss-ignore:  Top padding is OK before first element in a container */: 15px 0 10px 10px;
}
/* begin table */

table {
  width: 100%;
}
th,
td {
  vertical-align: top;
  padding: 0 0 15px 15px;
}
th:first-child,
td:first-child {
  padding-left: 0;
}
th {
  text-align: left;
}
.b_caption > table:last-child tr:last-child td,
.b_caption > .b_vPanel:last-child > div:last-child > table:last-child tr:last-child td {
  padding-bottom: 0;
}
/* end table */

#fti3 {
  margin-bottom: 10px;
}
#id_rwds_b {
  margin-bottom: 15px;
  display: inline-block;
}
/*Label item styles*/

.b_label {
  padding-right: 5px;
}
/*Input button styles*/

.cbtn input {
  -webkit-appearance: none;
  border-radius: 0;
  border: 1px solid #bbbbbb;
  min-width: 50px;
  max-width: 100%;
  height: 40px;
  padding: 0 15px;
  margin: 0 0 10px 0;
  white-space: nowrap;
  display: inline-block;
}
.cbtn input,
.cbtn input.b_highlighted:focus {
  outline: none;
}
/*SubModule and SupplementaryModule*/

.b_subModule,
.b_suppModule {
  padding/* bingcss-ignore:  Top padding is OK before first element in a container */: 13px 0;
  border-bottom-width: 1px;
  border-bottom-style: solid;
}
.b_subModule h2 {
  padding-bottom: 10px;
}
.b_subModule h2.b_headerTitle {
  padding-bottom: 5px;
}
/*End SubModule and SupplementaryModule*/

.nowrap {
  white-space: nowrap;
}
.pushpin {
  border-radius: 9px;
  text-align: center;
  width: 16px;
  height: 16px;
  margin-top: 2px;
  padding-bottom: 0;
  /* override label padding */
  line-height: 16px;
}
#b_results .b_no {
  margin-bottom: 80px;
}
.b_no h1,
.b_no h4,
.b_no li {
  padding-bottom: 10px;
}
.b_factrow .csrc {
  margin-right: 5px;
}
.sw_next,
.sw_prev {
  display: none;
}
.sb_pagIconN,
.sb_pagIconP {
  padding/* bingcss-ignore: to enlarge the click area, need top padding to center the icon */: 8px;
  margin-top/* bingcss-ignore: make sure next/prev icosn align with other pages */: 2px;
}
.b_entitySubTitle {
  margin-top/* bingcss-ignore: The subtitle needs to be right underneath the title */: -9px;
  padding-bottom: 10px;
}
#sb_dir {
  flex-grow: 1;
}
.b_clear {
  clear: both;
}
div#b_pole {
  margin-bottom: 10px;
}
#b_pole .b_ans + .b_ans {
  margin-top/* bingcss-ignore:  Top margin is OK between ans+ans and ans+algo and algo+ans */: 9px;
}
/*This file is intentionally left empty*/
z
{
    a:1;
}/*This file is intentionally left empty*/
z
{
    a:1;
}/* header colors for mobile threshold */

.b_scopebar {
  background-color: #e5e5e5;
}
.b_scopebar,
.b_scopebar a,
.b_scopebar a:visited,
.b_mystuff:before,
#b_header .b_symb {
  color: #666666;
}
.b_scopebar li.b_active a,
.b_scopebar li.b_active a:visited,
.b_scopebar span {
  border-color: transparent;
  color: black;
}
.b_scopebar a,
.b_scopebar span
{
    text-decoration: none;
    text-transform:uppercase;
}

.b_mystuff
{
    font-size:12px;
    line-height: 16px;
    height: 18px;
}

.b_mystuff:before
{
    font-size:16px;
    vertical-align: middle;
}

.b_scopebar a
{
    text-transform: capitalize;
}/* Scopebar styles */

#b_header:not(:empty) {
  border-bottom: 1px solid #e5e5e5;
  position: fixed;
  top: 0;
  width: 100%;
  z-index/* bingcss-ignore: to keep consistent with legacy mobile */: 1000;
}
#b_header .b_symb {
  float: left;
  margin: 10px 10px 0 10px;
}
.b_scopebar li {
  margin: 0 10px;
  /* Use margin for sides instead of padding so the active bottom border displays correctly. */
  display: inline-flex;
}
.b_scopebar li:last-child,
.b_mystuff {
  margin-right: 12px;
  flex: none;
}
.b_scopebar li:first-child {
  margin-left: 12px;
}
.b_scopebar ul {
  overflow-x: auto;
  white-space: nowrap;
  -ms-overflow-style: none;
}
.b_scopebar a,
.b_scopebar span,
.b_mystuff {
  padding/* bingcss-ignore: vertically align with padding */: 12px 0;
}
.b_scopebar li.b_active a,
.b_scopebar li.b_active span {
  padding-bottom: 10px;
  border-bottom-width: 2px;
  border-bottom-style: solid;
}
@media screen and (min-width: 641px) {
  #b_header nav li:first-child {
    margin-left: 0;
  }
  #b_header nav li:last-child {
    margin-right: 0;
  }
  #b_header nav,
  header nav {
    padding: 0 24px;
  }
}
.b_mystuff {
  display: block;
  text-align: right;
}
.b_mystuff:before {
  padding-right: 12px;
}
.linkAction {
  padding-bottom: 24px;
}
/*This file is intentionally left empty*/
z
{
    a:1;
}.b_accentColor,.b_accentColor strong,strong.b_accentColor,strong .b_accentColor,.qcard a,#sb_feedback,.b_anno,.appifyCaptionAccent,#b_results a.b_accentColor,#b_results a.b_accentColor:visited{color:#08517b;}.b_accentColorStroke{stroke:#08517b;}.b_accentColorFill{fill:#08517b;}input[type="text"]:focus{border-color:#08517b;}.b_accentColorBackground,select:active,.cbtn.b_highlighted input.b_accentColorBackground{background-color:#08517b;}.b_accentColorBorder{border-color:#08517b;}</style><script type="text/javascript">//<![CDATA[
// Declaring Feature Team ID for Win8App Error Handling
// <feature  id="8"  />
var amd;
(function (amd) {
    var defineMap = {};
    var cache = {};
    var initialized = false;
    function define(moduleName, dependencies, callback) {
        if (!defineMap[moduleName]) {
            defineMap[moduleName] = {
                dependencies: dependencies,
                callback: callback
            };
            // Invoke this module as it is registered
            require(moduleName);
        }
    }
    function require(requestedModuleName) {
        if (!requestedModuleName) {
            // Initialize all the modules and return the cache
            if (!initialized) {
                for (var moduleName in defineMap) {
                    requireModule(moduleName);
                }
                initialized = true;
            }
            return cache;
        }
        else if (requestedModuleName) {
            // Initialize just the module asked for
            return requireModule(requestedModuleName);
        }
    }
    function requireModule(moduleName) {
        // This should break the recursion in case of circular dependency
        if (cache[moduleName]) {
            return cache[moduleName];
        }
        // If the module has a define entry
        if (defineMap.hasOwnProperty(moduleName)) {
            // Create this module
            var moduleDetails = defineMap[moduleName];
            var deps = moduleDetails.dependencies;
            var callback = moduleDetails.callback;
            // add req and exports as first two dependencies
            var req = require;
            var exports = {};
            var dependencies = [req, exports];
            if (deps.length < 2) {
                throw "invalid usage";
            }
            else if (deps.length > 2) {
                // Recursively fetch dependencies
                var dependentModules = deps.slice(2, deps.length);
                for (var i = 0; i < dependentModules.length; i++) {
                    dependencies.push(requireModule(dependentModules[i]));
                }
            }
            // Call the callback -- this should add objects to exports
            // This means we do not support the callback itself returning an object.
            // It should be simple to support that. For now, STRADA generates
            // exports syntax.
            callback.apply(this, dependencies);
            // Cache the module
            cache[moduleName] = exports;
            return exports;
        }
    }
    amd.define = define;
    amd.require = require;
})(amd || (amd = {}));
var define = amd.define;
var require = amd.require;
;/// <reference path='../Declarations/Threshold.Utilities.d.ts' />
/// <reference path="../../../../../Threshold/src/Content/Script/Declarations/SearchAppWrapper.d.ts" />
// BUGBUG: TFS 780914: TypeScript throws build error when two ts file declare the same variable
var _w = window, _d = document, sb_ie = window["ActiveXObject"] !== undefined, sb_i6 = sb_ie && !_w["XMLHttpRequest"], _ge = function (id) { return _d.getElementById(id); }, sb_st = function (code, delay) { return setTimeout(code, delay); }, sb_rst = sb_st, sb_ct = function (id) {
    clearTimeout(id);
}, sb_gt = function () { return new Date().getTime(); }, sj_gx;
_w["sj_ce"] = function (tagName) { return _d.createElement(tagName); };
// Under certain circumstances the clientCookies script
// fails to get added from frontdoor. Declaring sk_merge
// if it isn't already defined.
if (!_w["sk_merge"]) {
    _w["sk_merge"] = function (cookieHeader) {
        _d.cookie = cookieHeader;
    };
}
var AjaxWrapperThreshold = (function () {
    function AjaxWrapperThreshold() {
    }
    AjaxWrapperThreshold.applyMethodThatRequiresOpened = function (xhrObject, method, originalArguments) {
        /* send and setRequestHeader can only be done on xhr requests that are currently opened: http://www.w3.org/TR/2009/WD-XMLHttpRequest-20090820/#opened-state */
        if (xhrObject.readyState == xhrObject.OPENED) {
            method.apply(xhrObject, originalArguments);
            return true;
        }
        return false;
    };
    AjaxWrapperThreshold.wrapSend = function (originalObject, originalMethod) {
        var wrappedMethod = function () {
            var originalArguments = arguments;
            if (!AjaxWrapperThreshold.isRequestBlocked(originalObject) && originalObject.readyState == originalObject.OPENED) {
                // If we're sending to bing, we need to append custom client headers.
                // Some old Threshold app webviews do not have a SearchAppWrapper.  Those can just make the XHR call directly and hope for the best.
                if (typeof ThresholdUtilities !== "undefined" && SearchAppWrapper && SearchAppWrapper.CortanaApp && AjaxWrapperThreshold.hostIsBing(originalObject.url)) {
                    ThresholdUtilities.getCortanaHeaders(function (headers) {
                        if (headers) {
                            var xhrHeaders = originalObject[AjaxWrapperThreshold.headersLocation];
                            for (var headerName in headers) {
                                if (headers.hasOwnProperty(headerName) && (headerName.substring(0, 2) === "X-" || AjaxWrapperThreshold.copyableHeaders.indexOf(headerName) >= 0)) {
                                    if (!xhrHeaders[headerName]) {
                                        originalObject.setRequestHeader(headerName, headers[headerName]);
                                    }
                                }
                            }
                        }
                        AjaxWrapperThreshold.setFlightHeaders(originalObject);
                        AjaxWrapperThreshold.applyMethodThatRequiresOpened(originalObject, originalMethod, originalArguments);
                    });
                }
                else {
                    if (AjaxWrapperThreshold.hostIsBing(originalObject.url)) {
                        AjaxWrapperThreshold.setFlightHeaders(originalObject);
                    }
                    AjaxWrapperThreshold.applyMethodThatRequiresOpened(originalObject, originalMethod, originalArguments);
                }
            }
            else {
                // If we need to block the send we simulate that we did it successfully so no retries are triggered.
                Object.defineProperties(originalObject, {
                    "readyState": { get: function () {
                        return 4;
                    } },
                    "status": { get: function () {
                        return 200;
                    } },
                    "responseText": { get: function () {
                        return "";
                    } },
                    "responseBody": { get: function () {
                        return "";
                    } }
                });
                if (originalObject.onreadystatechange) {
                    originalObject.onreadystatechange.apply(originalObject, null);
                }
            }
        };
        return wrappedMethod;
    };
    AjaxWrapperThreshold.wrapOpen = function (originalObject, originalMethod) {
        var wrappedMethod = function () {
            // We always pass through open calls, but we record the url on the object.
            originalObject.url = arguments[1];
            originalMethod.apply(originalObject, arguments);
        };
        return wrappedMethod;
    };
    AjaxWrapperThreshold.wrapSetRequestHeader = function (originalObject, originalMethod) {
        return function (headerKey, headerValue) {
            var successfulApply = AjaxWrapperThreshold.applyMethodThatRequiresOpened(originalObject, originalMethod, arguments);
            if (successfulApply) {
                var originalObjectHeaders = originalObject[AjaxWrapperThreshold.headersLocation];
                if (originalObjectHeaders[headerKey]) {
                    originalObjectHeaders[headerKey].push(headerValue);
                }
                else {
                    originalObjectHeaders[headerKey] = [headerValue];
                }
            }
            return successfulApply;
        };
    };
    AjaxWrapperThreshold.hostIsBing = function (url) {
        // Assume it's Bing if we can't prove otherwise
        var returnValue = true;
        AjaxWrapperThreshold.testAnchor.href = url;
        var hostName = AjaxWrapperThreshold.testAnchor.hostname;
        if (hostName && hostName.indexOf(".") > 0) {
            var matchedAnyHost = false;
            for (var i in this.bingHosts) {
                if (hostName.indexOf(this.bingHosts[i]) > 0) {
                    matchedAnyHost = true;
                    break;
                }
            }
            if (!matchedAnyHost) {
                returnValue = false;
            }
        }
        return returnValue;
    };
    AjaxWrapperThreshold.blockRequestWrapper = function (originalObject) {
        var _this = this;
        return function () {
            return _this.isRequestBlocked(originalObject);
        };
    };
    AjaxWrapperThreshold.isRequestBlocked = function (originalObject) {
        return typeof SearchAppWrapper !== "undefined" && SearchAppWrapper && SearchAppWrapper.CortanaApp && !SearchAppWrapper.CortanaApp.isBingEnabled && AjaxWrapperThreshold.hostIsBing(originalObject.url);
    };
    AjaxWrapperThreshold.createAjaxWrapper = function () {
        var wrappedObject = new XMLHttpRequest();
        wrappedObject[this.headersLocation] = {};
        wrappedObject.send = this.wrapSend(wrappedObject, wrappedObject.send);
        wrappedObject.open = this.wrapOpen(wrappedObject, wrappedObject.open);
        wrappedObject.setRequestHeader = this.wrapSetRequestHeader(wrappedObject, wrappedObject.setRequestHeader);
        wrappedObject.isRequestBlocked = this.blockRequestWrapper(wrappedObject);
        return wrappedObject;
    };
    AjaxWrapperThreshold.setFlightHeaders = function (request) {
        // set http headers for setting external flights
        if (typeof (_CachedFlights) !== "undefined" && _CachedFlights.sort) {
            var headersSet = request[AjaxWrapperThreshold.headersLocation];
            if (!headersSet[AjaxWrapperThreshold.externalExpType]) {
                request.setRequestHeader(AjaxWrapperThreshold.externalExpType, "JointCoord");
            }
            if (!headersSet[AjaxWrapperThreshold.externalExp]) {
                request.setRequestHeader(AjaxWrapperThreshold.externalExp, _CachedFlights.sort().join(","));
            }
        }
    };
    AjaxWrapperThreshold.bingHosts = [".bing.com", ".staging-bing-int.com", ".working-bing-int.com", ".bing-int.com", ".bing-exp.com"];
    AjaxWrapperThreshold.testAnchor = document.createElement("a");
    AjaxWrapperThreshold.externalExpType = "X-MSEdge-ExternalExpType";
    AjaxWrapperThreshold.externalExp = "X-MSEdge-ExternalExp";
    AjaxWrapperThreshold.headersLocation = "headers";
    AjaxWrapperThreshold.copyableHeaders = ["Authorization"];
    return AjaxWrapperThreshold;
})();
sj_gx = function () { return AjaxWrapperThreshold.createAjaxWrapper(); };
;///<reference path="..\Declarations\Shared.d.ts"/>
function lb() {
    _w["si_sendCReq"] && sb_st(_w["si_sendCReq"], 800);
    // look for any other scripts that needs to be called/initialized, and call them
    // we need a cleaner way to allow other scripts to register for a callback during onload
    // initialization (Bug 94997)
    _w["lbc"] && _w["lbc"]();
}
;///<reference path="..\Declarations\Shared.d.ts"/>
// This files modifies appendChild function to check if a SCRIPT tag is being appended.
// If yes and the script tag does not have a src attribute i.e. it is an inlined script
// then a "//@ sourceURL=BingDynamicScriptX.js" comment is added to the script so that
// modern browsers can parse it and add it to the javascript sources in debug window.
(function () {
    var scriptCount = 0;
    var scriptPrefix = "//@ sourceURL=BingDynamicScript";
    var scriptSuffix = ".js\n";
    if (window["Element"] && Element.prototype && window.location.pathname.indexOf("/mapspreview") !== 0) {
        var appendChild = Element.prototype.appendChild;
        Element.prototype.appendChild = function (elem) {
            if (elem && elem.tagName === "SCRIPT" && !elem.src && elem.textContent) {
                // Adding the sourceURL comment to the beginning of the file in case someone already
                // has this logic for their specific file then the latest one will take effect
                elem.textContent = scriptPrefix + scriptCount + scriptSuffix + elem.textContent;
                scriptCount++;
            }
            return appendChild.apply(this, arguments);
        };
    }
})();
;
//]]></script><script type="text/javascript" src="/rms/BingCore.Bundle/nj/76ac966b/89c90815.js?bu=rms+answers+Shared+BingCore%24ClientInstV2%24DuplicateXlsDefaultConfig%2cBingCore%24ClientInstV2%24SharedLocalStorageConfigDefault%2cBingCore%24shared%2cBingCore%24env.override%2cBingCore%24event.custom.fix%2cBingCore%24event.native%2cBingCore%24dom%2cBingCore%24cookies_parser%2cBingCore%24XHRPrefetch%24rmsajax_xhrprefetch%2cBingCore%24ClientInstV2%24InstrumentationConfigDefault%2cBingCore%24ClientInstV2%24LogUploadCapFeatureDisabled%2cBingCore%24ClientInstV2%24ClientInstConfigSeparateOfflineQueue%2cBingCore%24ClientInstV2%24clientinst_xls%2cEmpty%2cBingCore%24CoreUtilities%2cBingCore%24ClientInstV2%24LogHelper%2cBingCore%24ClientInstV2%24VisibilityChangeEventHelper%2cBingCore%24Animation%2cBingCore%24fadeAnimation%2cBingCore%24framework%2cBingCore%24ShowWebView%2cBingCore%24ClientInstV2%24LogOfflineFalseConfig%2cBingCore%24mobile2cortanahooks"></script><script type="text/javascript">//<![CDATA[
var SloppyClickHandler;
(function (SloppyClickHandler) {
    var listTag = ["LI", "TR"];
    var tableTag = ["TR"];
    var anchorTag = ["A"];
    var inputTag = ["INPUT", "SELECT"];
    var getElementsByTagName = "getElementsByTagName";
    var notTargetElementClass = "b_noTarget";
    var poleContainerClassName = "b_poleContent";
    var space = " ";
    function findCardFromElement(element) {
        var link = getParentContainer(element, anchorTag);
        var returnObject = { element: element, card: link, link: link, containsLink: true };
        var input = getParentContainer(element, inputTag);
        if (!input) {
            var card = getParentContainer(element, listTag, poleContainerClassName);
            if (card) {
                // If there's only one viable link in the entire LI then we'll use it by default
                var viableLink = findLinkInAnchorTags(card);
                // If the link is not found in the table, try again at levels above it
                // Won't work for nested tables or lists
                if (!viableLink && tableTag.indexOf(card.tagName) >= 0) {
                    card = getParentContainer(card.parentNode, listTag, poleContainerClassName);
                    viableLink = findLinkInAnchorTags(card);
                }
                // If there's more than one link we still need to see if there's a header common control.  If there's a single
                // header control we're willing to shift the click to that.
                if (!viableLink && card && _w['TCH']) {
                    var reservedTags = _w['TCH'].rTags;
                    for (var i = 0; i < reservedTags.length; i++) {
                        viableLink = getViableLinkFromList(card[getElementsByTagName](reservedTags[i]));
                        if (viableLink) {
                            break;
                        }
                    }
                }
                if (viableLink && (!link || viableLink === link)) {
                    returnObject = { element: element, card: card, link: viableLink, containsLink: true };
                }
            }
        }
        else {
            returnObject = null;
        }
        // Don't return anything if we don't have a link.
        if (returnObject && !returnObject.link) {
            returnObject = null;
        }
        // If we have a link, but it's the same as or a parent of our source element we mark the object as non-clickable.
        // Clicking is not required here as normal event bubbling will work.
        // But we do need to track the object still, as it is animatable.
        if (returnObject && (containsElement(returnObject.link, element) || returnObject.link === returnObject.element)) {
            returnObject.containsLink = false;
        }
        return returnObject;
    }
    SloppyClickHandler.findCardFromElement = findCardFromElement;
    var containsElement = function (parent, element) {
        if (element) {
            var candidates = parent[getElementsByTagName](element.tagName);
            for (var i = 0; i < candidates.length; i++) {
                if (candidates[i] === element) {
                    return true;
                }
            }
        }
        return false;
    };
    var getViableLinkFromList = function (elements) {
        var viableLink = null;
        for (var i = 0; i < elements.length; i++) {
            var possibleLink = findLinkInAnchorTags(elements[i]);
            if (possibleLink) {
                if (!viableLink) {
                    viableLink = possibleLink;
                }
                else if (possibleLink.href !== viableLink.href) {
                    // We found more than one heading with a viable link - the click is ambiguous so there is no click.
                    viableLink = null;
                    break;
                }
            }
            else if (elements[i][getElementsByTagName](anchorTag).length > 1) {
                // A single header has more than one link, and they're not viable - we're confused so we stop.
                viableLink = null;
                break;
            }
        }
        return viableLink;
    };
    var isViableLink = function (element) { return element && element.className.indexOf(notTargetElementClass) < 0; };
    var findLinkInAnchorTags = function (element) {
        var viableLink = null;
        if (element) {
            var anchorTags = element[getElementsByTagName](anchorTag);
            var anchorTagCount = anchorTags.length;
            var linksMatch = true;
            var matchingLink = null;
            var firstLinkUrl = null;
            for (var i = 0; i < anchorTagCount; i++) {
                /* Only compare the viable links */
                if (isViableLink(anchorTags[i])) {
                    if (!firstLinkUrl) {
                        matchingLink = anchorTags[i];
                        firstLinkUrl = anchorTags[i].href;
                    }
                    else if (firstLinkUrl !== anchorTags[i].href) {
                        linksMatch = false;
                        break;
                    }
                }
            }
            /* We need to have found at least one viable link */
            if (linksMatch && firstLinkUrl) {
                viableLink = matchingLink;
            }
        }
        return viableLink;
    };
    var getParentContainer = function (target, tags, className) {
        for (; target !== document && target; target = target.parentNode) {
            if (target) {
                for (var i = 0; i < tags.length; ++i) {
                    if (target.tagName === tags[i] || (className && target.className && (space + target.className + space).indexOf(space + className + space) >= 0)) {
                        return target;
                    }
                }
            }
        }
    };
})(SloppyClickHandler || (SloppyClickHandler = {}));
;///<reference path="..\Declarations\Shared.d.ts"/>
ClickTrackingConfig = {
    lc: true,
    rc: true
};
;///<reference path="..\Declarations\Shared.d.ts"/>
///<reference path="..\..\..\..\..\Web\Content\Content\Script\Declarations\SloppyClickHandler.d.ts"/>
// See Hyperlink and FdHyperlink at the FD for what this all means
// BUGBUG: TFS 780914: TypeScript throws build error when two ts file declare the same variable
_w["si_ct"] = function (el, noRecurse, evt) {
    var getAttribute = "getAttribute", ct, ctf, found;
    try {
        for (; el !== document.body; el = el.parentNode) {
            // The 'h' or '_ct' attribute contains the payload for the click tracking function
            // Stop on the first anchor with an 'h' attribute or the first element found with a '_ct' attribute present
            ct = (el.tagName == "A" && el[getAttribute]("h")) || el[getAttribute]("_ct") || el[getAttribute]("data-h");
            if (ct) {
                // The '_ctf' attribute contains the name of the overriden global click
                // tracking function which is optional, default is si_T
                ctf = el[getAttribute]("_ctf");
                var clickType = -1;
                if (evt != null && evt.button != null) {
                    clickType = evt.button;
                }
                if (!ctf || !_w[ctf]) {
                    ctf = "si_T";
                }
                // Try to fire the gping by calling the click-tracking function with the 'ct' payload and the clicked element
                _w[ctf] && _w[ctf]('&' + ct, el, evt, clickType);
                break;
            }
            if (noRecurse)
                break;
        }
    }
    catch (ignored) {
    }
    return true;
};
(function () {
    function leftClickHandler(evt) {
        _w["si_ct"](sb_ie ? _w.event.srcElement : evt.target, false, _w.event || evt);
    }
    function rightClickHandler(evt) {
        var clickedObject = _w["SloppyClickHandler"] ? SloppyClickHandler.findCardFromElement(sj_et(evt)) : null;
        var target = (clickedObject && clickedObject.link) ? clickedObject.link : (sb_ie ? _w.event.srcElement : evt.target);
        _w["si_ct"](target, false, _w.event || evt);
    }
    if (_w["_G"]) {
        _G["si_ct_e"] = "click";
    }
    // sj_be: Indicates bubble-phase handler (supported on all browsers as opposed to capture which IE doesn't support)
    sj_be(document, "click", leftClickHandler, false);
    sj_be(document, "contextmenu", rightClickHandler, false);
})();
;var wlc_d = 1500, wlc_t =63599328226;;var perf;
(function (perf) {
    var perfKeyArray = [
        "redirectStart",
        "redirectEnd",
        "fetchStart",
        "domainLookupStart",
        "domainLookupEnd",
        "connectStart",
        "secureConnectionStart",
        "connectEnd",
        "requestStart",
        "responseStart",
        "responseEnd",
        "domLoading",
        "domInteractive",
        "domContentLoadedEventStart",
        "domContentLoadedEventEnd",
        "domComplete",
        "loadEventStart",
        "loadEventEnd",
        "unloadEventStart",
        "unloadEventEnd",
        "firstChunkEnd",
        "secondChunkStart",
        "htmlEnd",
        "pageEnd",
        "msFirstPaint"
    ];
    var versionString = "v:1.1";
    // For now the key compression is based on array index. The assumption is 
    // that this is a fixed list that will not change often and tightly contolled.
    // This is not very flexible as any addition in between can essentially
    // break the reporting side. Two possible solutions to try would be to
    // have the keyMap logged in nif. Advantage of this would be it is easy to
    // maintain but the disadvantage is no real time reporting. The other way
    // to have a package that defines the keyMap. Advantage is the keyMap can 
    // be consumed by multiple sources but the disadvantage is it would need 
    // version control.
    var perfKeyMap = {};
    var i;
    for (i = 0; i < perfKeyArray.length; i++) {
        perfKeyMap[perfKeyArray[i]] = i;
    }
    function compressKey(key) {
        return perfKeyMap.hasOwnProperty(key) ? perfKeyMap[key] : key;
    }
    function typeToString(type) {
        var typeString = "S";
        if (type == 0 /* Mark */) {
            typeString = "P";
        }
        else if (type == 2 /* Measure */) {
            typeString = "M";
        }
        return typeString;
    }
    // Creates an array of strings that are essentially are of the form "${key}:${value}"
    function compress(q) {
        var data = [];
        var typeArrays = {}, typeArray;
        for (var i = 0; i < q.length; i++) {
            var obj = q[i];
            var value = obj.v, qType = obj.t, key = obj.k;
            if (qType === 0 /* Mark */) {
                key = compressKey(key);
                value = value.toString(36);
            }
            if (qType === 3 /* None */) {
                data.push("" + key + ":" + value);
            }
            else {
                typeArray = typeArrays[qType] = typeArrays[qType] || [];
                typeArray.push("" + key + ":" + value);
            }
        }
        for (var t in typeArrays) {
            if (typeArrays.hasOwnProperty(t)) {
                typeArray = typeArrays[t];
                data.push("" + typeToString(t) + ":\"" + typeArray.join(",") + "\"");
            }
        }
        data.push(versionString);
        return data;
    }
    perf.compress = compress;
})(perf || (perf = {}));
;///<reference path="..\..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
window["perf"] = window["perf"] || {};
(function (perf) {
    perf.log = function (perfData, time) {
        var data = perf.compress(perfData);
        data.push("T:\"CI.Perf\",FID:\"CI\",Name:\"PerfV2\"");
        var url = "/fd/ls/lsp.aspx?";
        var sendBeacon = "sendBeacon";
        // if eventData contains the raw string "]]>", it'll end the CDATA section prematurely
        var eventXML = "<E><T>Event.ClientInst</T><IG>" + _G.IG + "</IG><TS>" + time + "</TS><D><![CDATA[{" + data.join(",") + "}]]></D></E>";
        var xml = "<ClientInstRequest><Events>" + eventXML + "</Events><STS>" + time + "</STS></ClientInstRequest>";
        if (!_w.navigator || !navigator[sendBeacon] || !navigator[sendBeacon](url, xml)) {
            var request = sj_gx();
            request.open("POST", url, true);
            request.setRequestHeader("Content-Type", "text/xml");
            request.send(xml);
        }
    };
})(window["perf"]);
;///<reference path="..\..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
var perf;
(function (perf) {
    var perfName = "performance";
    var hasPerformanceObject = !!_w[perfName];
    var perfObj = _w[perfName];
    var highResTimeAvailable = hasPerformanceObject && !!perfObj.now;
    var roundOf = Math.round;
    var q = [];
    // The data is only flushed after the first time flush is called.
    // We bind flush to onload so that pings are restricted to before onload.
    var firstFlushCalled = false;
    var navigationStart;
    var startTimestamp;
    if (hasPerformanceObject) {
        navigationStart = startTimestamp = perfObj.timing.navigationStart;
    }
    else {
        startTimestamp = _w["si_ST"] ? _w["si_ST"] : +new Date();
    }
    function createUniqueId() {
        return roundOf(Math.random() * 10000);
    }
    var uniqueId = createUniqueId();
    function getTime() {
        if (highResTimeAvailable) {
            return roundOf(perfObj.now()) + navigationStart;
        }
        else {
            return +new Date;
        }
    }
    function queue(key, value, qType) {
        if (q.length === 0 && firstFlushCalled) {
            sb_st(flush, 1000);
        }
        q.push({ k: key, v: value, t: qType });
    }
    function setStartTime(time) {
        if (!firstFlushCalled) {
            startTimestamp = time;
        }
        return !firstFlushCalled;
    }
    perf.setStartTime = setStartTime;
    function mark(key, value) {
        if (!value) {
            value = getTime();
        }
        queue(key, value, 0 /* Mark */);
    }
    perf.mark = mark;
    function record(key, value) {
        queue(key, value, 1 /* Record */);
    }
    perf.record = record;
    function flush() {
        if (q.length) {
            for (var i = 0; i < q.length; i++) {
                var obj = q[i];
                if (obj.t === 0 /* Mark */) {
                    obj.v -= startTimestamp;
                }
            }
            q.push({ k: "id", v: uniqueId, t: 3 /* None */ });
            perf.log(q, getTime());
            q = [];
            firstFlushCalled = true;
        }
    }
    perf.flush = flush;
    function reset() {
        startTimestamp = getTime();
        uniqueId = createUniqueId();
        firstFlushCalled = false;
        sj_evt.bind("onP1", flush);
    }
    perf.reset = reset;
    sj_be(window, "load", flush, false);
    sj_be(window, "beforeunload", flush, false);
})(perf || (perf = {}));
;///<reference path="..\..\..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
// Performance ping instrumentation for browsers supporting the W3C Web Timing API.
// si_PP() is the PerformancePing function used to report back performance data.
// currentTime - a javascript Date object
// state - "A" for abandoned, "L" for load.
// This function is called after pageload. However, some verticals may
// choose to call it at a different time, after setting the sb_ppCPL (custom page load) flag
_w.si_PP = function (currentTime, state, ajaxRequest) {
    // Only fire one perf ping
    if (_G.PPS) {
        return;
    }
    // Include the impression GUID (IG)
    // The DATA field contains a JSON blob of the event.
    // pp is the name of the event.
    // S is the status to report, from parameter b.
    // PC is the elapsed time between when the <BODY> tag is opened (_G.PCT) and the start time
    // FC is the elapsed time between when the first chunk is complete (_G.FCT) and the start time.
    //    For non-CTE rendering, the value is -1
    // BC is the elapsed time between when the second chunk arrives (_G.BCT) and the start time.
    //    If there is no second chunk, the timer is inserted right after _G.PPCT
    // BS is the elapsed time between right before the BOP scripts are inserted (_G.BST) and the start time
    // H is the elapsed time between when the HTML finished being downloaded and the last inline script got executed (_G.HT), and the start time
    // FE is the elapsed time between the beginning of the first embeded image chunk and the start time, if there are embedded image chunks
    //    Otherwise, the value is -1
    // LE is the elapsed time between the end of last embedded image chunk and the start time, if there are embedded image chunks
    //    Otherwise, the value is -1
    // C1 and C2 are custom ppMetrics, available in each vertical to be overridden with vertical specific elapsed times from the start time.
    //    To use, a page can simply set
    //           _G.C1T=new Date()
    // BP is the elapsed time between when the pageLoad event begins (_G.BPT) and the start time.
    // KP is the page's KeyPoint - the point the page's owner has decided is key to users.
    //    For example, on the SERP, this could be when web results and top answers are loaded, but not BOP answers.
    //    To use, insert the following in-lined JS to the place of interest
    //           _G.KPT=new Date()
    // CT is the total client elapsed time to "Page Load", calculated from the difference between the currentTime parameter and _G.ST
    // IL is the numbers of images
    // If CID is explicitly specified in the response
    //    it should be included in our instrumention as well
    // Collect a small number of PerfPing Metrics
    // --------------------------------------------------
    var key;
    var ppMetrics = ['FC', 'BC', 'H', 'BP', null];
    while (key = ppMetrics.shift()) {
        ppMetrics.push('"' + key + '":' + (_G[key + 'T'] ? _G[key + 'T'] - _G.ST : -1));
    }
    // --------------------------------------------------
    var w3cTimings = ajaxRequest || (_w.performance && _w.performance.timing);
    var w3cPayload = null;
    if (w3cTimings) {
        var w3cFields = [
            "unloadEventStart",
            "unloadEventEnd",
            "redirectStart",
            "redirectEnd",
            "fetchStart",
            "domainLookupStart",
            "domainLookupEnd",
            "connectStart",
            "connectEnd",
            "secureConnectionStart",
            "requestStart",
            "responseStart",
            "domLoading",
            "domInteractive",
            "domContentLoadedEventStart",
            "domContentLoadedEventEnd",
            "domComplete",
            "loadEventStart",
            "loadEventEnd",
            "msFirstPaint",
            "responseEnd",
            ""
        ];
        // Check that navigationStart is a number >= 0
        var navigationStart = w3cTimings.navigationStart;
        if (navigationStart >= 0) {
            var i, t, mask, prev;
            for (mask = prev = i = 0; key = w3cFields.shift(); i++) {
                t = w3cTimings[key];
                if (t > 0) {
                    mask |= 1 << i;
                    t -= navigationStart;
                    w3cFields.push(t === prev ? '' : (t - prev).toString(16));
                    prev = t;
                }
            }
            var navigation = "navigation";
            w3cPayload = ',"w3c":"' + mask.toString(16) + "," + w3cFields.join() + '","nav":' + (navigation in w3cTimings ? w3cTimings[navigation] : performance[navigation].type);
        }
    }
    // NOTE: Any changes to the following part of the string 'DATA={"pp":{' should be communicated to lsdmft because
    //       they could break some features dependent on PP.
    var payLoad = '{"pp":{"S":"' + (state || 'L') + '",' + ppMetrics.join(',') + ',"CT":' + (currentTime - _G.ST) + ',"IL":' + _d.images.length + '}' + (_G.C1 ? ',' + _G.C1 : '') + (w3cPayload !== null ? w3cPayload : '') + '}';
    if (_w['Log2']) {
        Log2.LogEvent("CPT", JSON.parse(payLoad), null, null, null, null, null, null);
    }
    else {
        _G.PPImg = new Image();
        _G.PPImg.src = _G.lsUrl + '&Type=Event.CPT&DATA=' + payLoad + (_G.P ? '&P=' + _G.P : '');
    }
    _G.PPS = 1; // flag set if perfping has fired
    sb_st(function () {
        sj_evt.fire('onPP');
        sj_evt.fire(_w.p1);
    }, 1);
};
// Bind onbefore unload so we can capture the cases of people leaving the page before
// it has loaded (called the abandon state, denoted as 'A').
// Note that onbeforeunload is bound to directly because this should be just about the very first script executing on the page,
// so we don't have to worry about tromping on an existing event handler.
_w.onbeforeunload = function () {
    si_PP(new Date, 'A');
};
;///<reference path="..\..\..\answers\services\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
(function (perfping) {
    if (document.querySelector) {
        var logText = [];
        var customField = "ad";
        function run() {
            var start = sb_gt();
            var de = document.documentElement;
            var body = document.body;
            var adsHeight = -1;
            var adsTop = -1;
            var fold = de.clientHeight;
            var selectors = ["#b_results .b_ad", ".sb_adsWv2", ".ads"];
            // Do not attempt to log anything if body itself is missing
            if (!body)
                return;
            for (var i = 0; i < selectors.length; i++) {
                var selector = selectors[i];
                var ads = document.querySelector(selector);
                if (ads && ads.offsetTop < fold) {
                    adsHeight = ads.offsetHeight;
                    adsTop = ads.offsetTop;
                    break;
                }
            }
            // Data in following order: Ads Top, Ads Height, Viewport Width, Viewport Height, Page Width, Page Height, Cost
            logText = [adsTop, adsHeight, de.clientWidth, fold, body.offsetWidth, body.offsetHeight, sb_gt() - start];
        }
        // Adding payload to perf-ping
        if (perfping) {
            var fn = perfping.onbeforefire;
            perfping.onbeforefire = function () {
                if (fn)
                    fn();
                run();
                perfping.mark(customField, logText);
            };
        }
        else {
            var fn = si_PP;
            si_PP = function () {
                run();
                var customLog = '"' + customField + '":[' + logText.join() + ']';
                _G.C1 = _G.C1 ? _G.C1 + ',' + customLog : customLog;
                fn.apply(null, [].slice.apply(arguments));
            };
        }
    }
})(_w["pp"]);
;///<reference path="..\..\..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
(function (fn) {
    function extractTimestampParam(qs, key) {
        var param = '&' + key + '=';
        var pos = qs.indexOf(param);
        if (pos < 0) {
            return -1;
        }
        var offset = pos + param.length;
        var ts = qs.substr(offset);
        return parseInt(ts, 10);
    }
    _w.si_PP = function (currentTime, state) {
        var t = _w.performance && _w.performance.timing;
        if (t) {
            var data = '"NS":"' + t.navigationStart + '"';
            var location = window.location;
            var qs = window.location && location.search;
            if (qs) {
                var st = extractTimestampParam(qs, "sbts");
                if (!st || st < 0) {
                    var nclidts = extractTimestampParam(qs, "nclidts");
                    var tsms = extractTimestampParam(qs, "tsms");
                    if (nclidts > 0 && tsms >= 0) {
                        st = (nclidts * 1000) + tsms;
                    }
                }
                if (st > 0) {
                    data += ',"E2E_PLT":"' + (t.loadEventEnd - st) + '"';
                    // 
                    // Attempt to remove the timestamp parameters from the URL for the following reasons:
                    // (1) User refreshes the page 
                    // (2) Navigates forward and then uses the back button
                    // (3) User adds the page as a bookmark
                    // 
                    // In these cases the timestamps from the first impression are used in the E2E PLT calculation as well as the
                    // browser launch time calculation which yields unusable times. There is currently no way to properly sanitize
                    // all instances of these values. It also decreases perf coverage for those affected impressions.
                    if (window.history && history.replaceState) {
                        var historyUrl = location.href.replace(/(&(sbts|nclidts|tsms)=\d+)/g, "");
                        if (historyUrl !== location.href) {
                            history.replaceState(null, null, historyUrl);
                        }
                    }
                }
            }
            _G.C1 = _G.C1 ? _G.C1 + ',' + data : data;
        }
        if (fn) {
            fn(currentTime, state);
        }
    };
})(_w.si_PP);
;// BoxModel Rules
// Format: [x, y, includeChildren]
// E.g. "#b_tween": [100, 140, 1] ==>
//          Look for #b_tween and validate that it's (x,y) matches (100,140)
//          And, since third parameter is 1, also grab coordinates for all children elements
// Value of -1 for x or y coordinate indicates wildcard, i.e., no validation on that particular coordinate
var BM = BM || {};
BM.rules = {
    ".b_scopebar": [-1, -1, 0],
    ".b_scopebar ul": [-1, -1, 1],
    "#b_results": [-1, -1, 1],
    ".b_hList": [-1, -1, 1],
    ".b_flex": [-1, -1, 1],
    ".b_flex span": [-1, -1, 0],
    "img,div[data-src]": [-1, -1, 0],
    "#root": [-1, -1, 1],
    ".suggestion": [-1, -1, 0],
    "#topResult": [-1, -1, 0],
    ".groupHeader": [-1, -1, 0]
};
;var BM = BM || {};
(function (BM) {
    var items = {};
    var unloads = {};
    var computes = {};
    function wireup(moduleID, q) {
        if (!(moduleID in items))
            items[moduleID] = [];
        if (q.compute && !(moduleID in computes))
            computes[moduleID] = q.compute;
        if (q.unload && !(moduleID in unloads))
            unloads[moduleID] = q.unload;
        if (q.load)
            q.load();
    }
    function enqueue(moduleID, item) {
        items[moduleID].push({ t: getElapsedTime(), i: item });
    }
    function dequeue(moduleID) {
        if (moduleID in unloads)
            unloads[moduleID]();
        if (moduleID in items)
            return items[moduleID];
    }
    function trigger() {
        for (var moduleID in computes) {
            computes[moduleID]();
        }
    }
    function getElapsedTime() {
        return window.performance && performance.now ? Math.round(performance.now()) : (new Date()) - window["si_ST"];
    }
    BM.wireup = wireup;
    BM.enqueue = enqueue;
    BM.dequeue = dequeue;
    BM.trigger = trigger;
})(BM);
;///<reference path="..\queue.ts"/>
(function (BM) {
    var moduleID = "V";
    // Viewport computation
    function compute() {
        var de = document.documentElement;
        var body = document.body;
        var screenWidth = "innerWidth" in window ? window.innerWidth : de.clientWidth;
        var screenHeight = "innerHeight" in window ? window.innerHeight : de.clientHeight;
        var screenLeft = window["pageXOffset"] || de.scrollLeft;
        var screenTop = window["pageYOffset"] || de.scrollTop;
        var state = document["visibilityState"] || "default";
        BM.enqueue(moduleID, { x: screenLeft, y: screenTop, w: screenWidth, h: screenHeight, dw: body.clientWidth, dh: body.clientHeight, v: state });
    }
    // Initialize queue
    BM.wireup(moduleID, { load: null, compute: compute, unload: null });
})(BM);
;///<reference path="..\queue.ts"/>
(function (BM) {
    var moduleID = "L";
    // Viewport computation
    function compute() {
        // Bail out if querySelector API doesn't exist
        // Eventually, post page load, we will log the error via core framework
        if (!document.querySelector || !document.querySelectorAll) {
            return;
        }
        var nodes = [];
        var rules = BM.rules;
        for (var selector in rules) {
            var rule = rules[selector];
            selector += !!rule[2] ? " >*" : "";
            var elements = document.querySelectorAll(selector);
            for (var e = 0; e < elements.length; e++) {
                var el = elements[e];
                var x = 0, y = 0, w = el.offsetWidth, h = el.offsetHeight;
                do {
                    x += el.offsetLeft;
                    y += el.offsetTop;
                } while (el = el.offsetParent);
                nodes.push({ _e: elements[e], x: x, y: y, w: w, h: h });
            }
        }
        BM.enqueue(moduleID, nodes);
    }
    // Initialize queue
    BM.wireup(moduleID, { load: null, compute: compute, unload: null });
})(BM);
;///<reference path="..\queue.ts"/>
(function (BM) {
    var moduleID = "EVT";
    // Storing events for later reference
    var events = ["click", "mousedown", "mouseup", "touchstart", "touchend", "mousemove", "touchmove", "scroll", "keydown", "resize"];
    function load() {
        eventManager(sj_be, enqueue);
    }
    function enqueue(evt) {
        // Do not attempt to queue if evt is not natively supported by the browser
        // In older versions of IE, it's possible to lookup _w.event synchronously 
        // but it doesn't work when you try to queue the reference and use it later
        // As per stackoverflow: http://stackoverflow.com/questions/3531751/member-not-found-ie-error-ie-6-7-8-9
        // As a possible future work item, it's possible to get around this by making a copy in another variable for IE8 & IE9
        if (evt) {
            BM.enqueue(moduleID, evt);
        }
        return true;
    }
    function unload() {
        eventManager(sj_ue, enqueue);
    }
    function eventManager(api, handler) {
        for (var i = 0; i < events.length; i++) {
            var evt = events[i];
            api(evt === "resize" ? window : document, window.navigator.pointerEnabled ? evt.replace("mouse", "pointer") : evt, handler, false);
        }
    }
    // Initialize queue with a callback to teardown event bindings later
    BM.wireup(moduleID, { load: load, compute: null, unload: unload });
})(BM);
;_TC={SP:"search,images,images\/search,videos\/search,local,local\/fetchlocalpivot,local\/fetchlocalelv,news,news\/search,devicecontent,people411,meetingprep,tasklineth\/search,stores,profile\/interests\/v2,account\/permissions,cabs\/search,cabs\/searchasync,cabs\/book,cabs\/driver,cabs\/driverupdate,events\/search,showtimesth,showmoremoviesth,themebasedlocalrecommendation\/search,transitline,transitstop,morescholarinfo\/search,financemywatchlist\/search,trainschedule,billpay,nearbyshowmore\/search,skywalk\/seemore,UserDataDictionary\/search,cortanalocal\/placesearch,\/interesttracking,\/interesttracking\/packagetracking,\/entityexplore", BP:"videos\/search?view=detail", NW:false};;
//]]></script></head><body onload="if(_w.lb)lb();"><header id="b_header"><nav aria-label="navigation" class="b_scopebar" role="navigation"><ul><li class="b_active"><a href="/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;FORM=HDRSC1" h="ID=SERP,5019.1">Web</a></li><li><a href="/images/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;FORM=HDRSC2" h="ID=SERP,5020.1">Images</a></li><li><a href="/videos/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;FORM=HDRSC3" h="ID=SERP,5021.1">Videos</a></li><li><a href="/news/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;FORM=HDRSC4" h="ID=SERP,5022.1">News</a></li></ul></nav></header><script type="text/javascript">//<![CDATA[
/***********************************************************
 * winjs-promise.js start
 **********************************************************/
var globalHolder = { WinJS: { Namespace: {}}};

/***********************************************************
 * base.js
 **********************************************************/
(function baseInit(global, undefined) {
    "use strict";

    function initializeProperties(target, members, prefix) {
        var keys = Object.keys(members);
        var properties;
        var i, len;
        for (i = 0, len = keys.length; i < len; i++) {
            var key = keys[i];
            var enumerable = key.charCodeAt(0) !== /*_*/95;
            var member = members[key];
            if (member && typeof member === 'object') {
                if (member.value !== undefined || typeof member.get === 'function' || typeof member.set === 'function') {
                    if (member.enumerable === undefined) {
                        member.enumerable = enumerable;
                    }
                    if (prefix && member.setName && typeof member.setName === 'function') {
                        member.setName(prefix + "." + key)
                    }
                    properties = properties || {};
                    properties[key] = member;
                    continue;
                }
            }
            if (!enumerable) {
                properties = properties || {};
                properties[key] = { value: member, enumerable: enumerable, configurable: true, writable: true }
                continue;
            }
            target[key] = member;
        }
        if (properties) {
            Object.defineProperties(target, properties);
        }
    }

    (function (rootNamespace) {

        // Create the rootNamespace in the global namespace
        if (!global[rootNamespace]) {
            global[rootNamespace] = Object.create(Object.prototype);
        }

        // Cache the rootNamespace we just created in a local variable
        var _rootNamespace = global[rootNamespace];
        if (!_rootNamespace.Namespace) {
            _rootNamespace.Namespace = Object.create(Object.prototype);
        }

        function defineWithParent(parentNamespace, name, members) {
            /// <signature helpKeyword="WinJS.Namespace.defineWithParent">
            /// <summary locid="WinJS.Namespace.defineWithParent">
            /// Defines a new namespace with the specified name under the specified parent namespace.
            /// </summary>
            /// <param name="parentNamespace" type="Object" locid="WinJS.Namespace.defineWithParent_p:parentNamespace">
            /// The parent namespace.
            /// </param>
            /// <param name="name" type="String" locid="WinJS.Namespace.defineWithParent_p:name">
            /// The name of the new namespace.
            /// </param>
            /// <param name="members" type="Object" locid="WinJS.Namespace.defineWithParent_p:members">
            /// The members of the new namespace.
            /// </param>
            /// <returns type="Object" locid="WinJS.Namespace.defineWithParent_returnValue">
            /// The newly-defined namespace.
            /// </returns>
            /// </signature>
            var currentNamespace = parentNamespace || {};

            if (name) {
                var namespaceFragments = name.split(".");
                for (var i = 0, len = namespaceFragments.length; i < len; i++) {
                    var namespaceName = namespaceFragments[i];
                    if (!currentNamespace[namespaceName]) {
                        Object.defineProperty(currentNamespace, namespaceName,
                            { value: {}, writable: false, enumerable: true, configurable: true }
                        );
                    }
                    currentNamespace = currentNamespace[namespaceName];
                }
            }

            if (members) {
                initializeProperties(currentNamespace, members, name || "<ANONYMOUS>");
            }

            return currentNamespace;
        }

        function define(name, members) {
            /// <signature helpKeyword="WinJS.Namespace.define">
            /// <summary locid="WinJS.Namespace.define">
            /// Defines a new namespace with the specified name.
            /// </summary>
            /// <param name="name" type="String" locid="WinJS.Namespace.define_p:name">
            /// The name of the namespace. This could be a dot-separated name for nested namespaces.
            /// </param>
            /// <param name="members" type="Object" locid="WinJS.Namespace.define_p:members">
            /// The members of the new namespace.
            /// </param>
            /// <returns type="Object" locid="WinJS.Namespace.define_returnValue">
            /// The newly-defined namespace.
            /// </returns>
            /// </signature>
            return defineWithParent(global, name, members);
        }

        var LazyStates = {
            uninitialized: 1,
            working: 2,
            initialized: 3,
        };

        function lazy(f) {
            if (typeof f === "string") {
                var target = f;
                f = function () {
                    return WinJS.Utilities.getMember(target);
                };
            }
            var name;
            var state = LazyStates.uninitialized;
            var result;
            return {
                setName: function (value) {
                    name = value;
                },
                get: function () {
                    switch (state) {
                        case LazyStates.initialized:
                            return result;

                        case LazyStates.uninitialized:
                            state = LazyStates.working;
                            try {
                                msWriteProfilerMark("WinJS.Namespace._lazy:" + name + ",StartTM");
                                result = f();
                            } finally {
                                msWriteProfilerMark("WinJS.Namespace._lazy:" + name + ",StopTM");
                                state = LazyStates.uninitialized;
                            }
                            f = null;
                            state = LazyStates.initialized;
                            return result;

                        case LazyStates.working:
                            throw "Illegal: reentrancy on initialization";

                        default:
                            throw "Illegal";
                    }
                },
                set: function (value) {
                    switch (state) {
                        case LazyStates.working:
                            throw "Illegal: reentrancy on initialization";
                        
                        default:
                            state = LazyStates.initialized;
                            result = value;
                            break;
                    }
                },
                enumerable: true,
                configurable: true,
            }
        }

        // Establish members of the "WinJS.Namespace" namespace
        Object.defineProperties(_rootNamespace.Namespace, {

            defineWithParent: { value: defineWithParent, writable: true, enumerable: true, configurable: true },

            define: { value: define, writable: true, enumerable: true, configurable: true },

            _lazy: { value: lazy, writable: true, enumerable: true, configurable: true },

        });

    })("WinJS");

    (function (WinJS) {

        function define(constructor, instanceMembers, staticMembers) {
            /// <signature helpKeyword="WinJS.Class.define">
            /// <summary locid="WinJS.Class.define">
            /// Defines a class using the given constructor and the specified instance members.
            /// </summary>
            /// <param name="constructor" type="Function" locid="WinJS.Class.define_p:constructor">
            /// A constructor function that is used to instantiate this class.
            /// </param>
            /// <param name="instanceMembers" type="Object" locid="WinJS.Class.define_p:instanceMembers">
            /// The set of instance fields, properties, and methods made available on the class.
            /// </param>
            /// <param name="staticMembers" type="Object" locid="WinJS.Class.define_p:staticMembers">
            /// The set of static fields, properties, and methods made available on the class.
            /// </param>
            /// <returns type="Function" locid="WinJS.Class.define_returnValue">
            /// The newly-defined class.
            /// </returns>
            /// </signature>
            constructor = constructor || function () { };
            WinJS.Utilities.markSupportedForProcessing(constructor);
            if (instanceMembers) {
                initializeProperties(constructor.prototype, instanceMembers);
            }
            if (staticMembers) {
                initializeProperties(constructor, staticMembers);
            }
            return constructor;
        }

        function derive(baseClass, constructor, instanceMembers, staticMembers) {
            /// <signature helpKeyword="WinJS.Class.derive">
            /// <summary locid="WinJS.Class.derive">
            /// Creates a sub-class based on the supplied baseClass parameter, using prototypal inheritance.
            /// </summary>
            /// <param name="baseClass" type="Function" locid="WinJS.Class.derive_p:baseClass">
            /// The class to inherit from.
            /// </param>
            /// <param name="constructor" type="Function" locid="WinJS.Class.derive_p:constructor">
            /// A constructor function that is used to instantiate this class.
            /// </param>
            /// <param name="instanceMembers" type="Object" locid="WinJS.Class.derive_p:instanceMembers">
            /// The set of instance fields, properties, and methods to be made available on the class.
            /// </param>
            /// <param name="staticMembers" type="Object" locid="WinJS.Class.derive_p:staticMembers">
            /// The set of static fields, properties, and methods to be made available on the class.
            /// </param>
            /// <returns type="Function" locid="WinJS.Class.derive_returnValue">
            /// The newly-defined class.
            /// </returns>
            /// </signature>
            if (baseClass) {
                constructor = constructor || function () { };
                var basePrototype = baseClass.prototype;
                constructor.prototype = Object.create(basePrototype);
                WinJS.Utilities.markSupportedForProcessing(constructor);
                Object.defineProperty(constructor.prototype, "constructor", { value: constructor, writable: true, configurable: true, enumerable: true });
                if (instanceMembers) {
                    initializeProperties(constructor.prototype, instanceMembers);
                }
                if (staticMembers) {
                    initializeProperties(constructor, staticMembers);
                }
                return constructor;
            } else {
                return define(constructor, instanceMembers, staticMembers);
            }
        }

        function mix(constructor) {
            /// <signature helpKeyword="WinJS.Class.mix">
            /// <summary locid="WinJS.Class.mix">
            /// Defines a class using the given constructor and the union of the set of instance members
            /// specified by all the mixin objects. The mixin parameter list is of variable length.
            /// </summary>
            /// <param name="constructor" locid="WinJS.Class.mix_p:constructor">
            /// A constructor function that is used to instantiate this class.
            /// </param>
            /// <returns type="Function" locid="WinJS.Class.mix_returnValue">
            /// The newly-defined class.
            /// </returns>
            /// </signature>
            constructor = constructor || function () { };
            var i, len;
            for (i = 1, len = arguments.length; i < len; i++) {
                initializeProperties(constructor.prototype, arguments[i]);
            }
            return constructor;
        }

        // Establish members of "WinJS.Class" namespace
        WinJS.Namespace.define("WinJS.Class", {
            define: define,
            derive: derive,
            mix: mix
        });

    })(WinJS);

})(this);

 /***********************************************************
 * baseUtils.js
 **********************************************************/
 (function baseUtilsInit(global, WinJS) {
    "use strict";

    var hasWinRT = !!global.Windows;

    var strings = {
        get notSupportedForProcessing() { return WinJS.Resources._getWinJSString("base/notSupportedForProcessing").value; }
    };

    function nop(v) {
        return v;
    }

    function getMemberFiltered(name, root, filter) {
        return name.split(".").reduce(function (currentNamespace, name) {
            if (currentNamespace) {
                return filter(currentNamespace[name]);
            }
            return null;
        }, root);
    }

    // Establish members of "WinJS.Utilities" namespace
    WinJS.Namespace.define("WinJS.Utilities", {
        // Used for mocking in tests
        _setHasWinRT: {
            value: function (value) {
                hasWinRT = value;
            },
            configurable: false,
            writable: false,
            enumerable: false
        },

        /// <field type="Boolean" locid="WinJS.Utilities.hasWinRT" helpKeyword="WinJS.Utilities.hasWinRT">Determine if WinRT is accessible in this script context.</field>
        hasWinRT: {
            get: function () { return hasWinRT; },
            configurable: false,
            enumerable: true
        },

        _getMemberFiltered: getMemberFiltered,

        getMember: function (name, root) {
            /// <signature helpKeyword="WinJS.Utilities.getMember">
            /// <summary locid="WinJS.Utilities.getMember">
            /// Gets the leaf-level type or namespace specified by the name parameter.
            /// </summary>
            /// <param name="name" locid="WinJS.Utilities.getMember_p:name">
            /// The name of the member.
            /// </param>
            /// <param name="root" locid="WinJS.Utilities.getMember_p:root">
            /// The root to start in. Defaults to the global object.
            /// </param>
            /// <returns type="Object" locid="WinJS.Utilities.getMember_returnValue">
            /// The leaf-level type or namespace in the specified parent namespace.
            /// </returns>
            /// </signature>
            if (!name) {
                return null;
            }
            return getMemberFiltered(name, root || global, nop);
        },

        ready: function (callback, async) {
            /// <signature helpKeyword="WinJS.Utilities.ready">
            /// <summary locid="WinJS.Utilities.ready">
            /// Ensures that the specified function executes only after the DOMContentLoaded event has fired
            /// for the current page.
            /// </summary>
            /// <returns type="WinJS.Promise" locid="WinJS.Utilities.ready_returnValue">A promise that completes after DOMContentLoaded has occurred.</returns>
            /// <param name="callback" optional="true" locid="WinJS.Utilities.ready_p:callback">
            /// A function that executes after DOMContentLoaded has occurred.
            /// </param>
            /// <param name="async" optional="true" locid="WinJS.Utilities.ready_p:async">
            /// If true, the callback is executed asynchronously.
            /// </param>
            /// </signature>
            return new WinJS.Promise(function (c, e) {
                function complete() {
                    if (callback) {
                        try {
                            callback();
                            c();
                        }
                        catch (err) {
                            e(err);
                        }
                    }
                    else {
                        c();
                    }
                }

                var readyState = WinJS.Utilities.testReadyState;
                if (!readyState) {
                    if (global.document) {
                        readyState = document.readyState;
                    }
                    else {
                        readyState = "complete";
                    }
                }
                if (readyState === "complete" || (global.document && document.body !== null)) {
                    if (async) {
                        WinJS.Utilities.Scheduler.schedule(function () {
                            complete();
                        }, WinJS.Utilities.Scheduler.Priority.normal, null, "WinJS.Utilities.ready");
                    }
                    else {
                        complete();
                    }
                }
                else {
                    global.addEventListener("DOMContentLoaded", complete, false);
                }
            });
        },

        /// <field type="Boolean" locid="WinJS.Utilities.strictProcessing" helpKeyword="WinJS.Utilities.strictProcessing">Determines if strict declarative processing is enabled in this script context.</field>
        strictProcessing: {
            get: function () { return true; },
            configurable: false,
            enumerable: true,
        },

        markSupportedForProcessing: {
            value: function (func) {
                /// <signature helpKeyword="WinJS.Utilities.markSupportedForProcessing">
                /// <summary locid="WinJS.Utilities.markSupportedForProcessing">
                /// Marks a function as being compatible with declarative processing, such as WinJS.UI.processAll
                /// or WinJS.Binding.processAll.
                /// </summary>
                /// <param name="func" type="Function" locid="WinJS.Utilities.markSupportedForProcessing_p:func">
                /// The function to be marked as compatible with declarative processing.
                /// </param>
                /// <returns type="Function" locid="WinJS.Utilities.markSupportedForProcessing_returnValue">
                /// The input function.
                /// </returns>
                /// </signature>
                func.supportedForProcessing = true;
                return func;
            },
            configurable: false,
            writable: false,
            enumerable: true
        },

        requireSupportedForProcessing: {
            value: function (value) {
                /// <signature helpKeyword="WinJS.Utilities.requireSupportedForProcessing">
                /// <summary locid="WinJS.Utilities.requireSupportedForProcessing">
                /// Asserts that the value is compatible with declarative processing, such as WinJS.UI.processAll
                /// or WinJS.Binding.processAll. If it is not compatible an exception will be thrown.
                /// </summary>
                /// <param name="value" type="Object" locid="WinJS.Utilities.requireSupportedForProcessing_p:value">
                /// The value to be tested for compatibility with declarative processing. If the
                /// value is a function it must be marked with a property 'supportedForProcessing'
                /// with a value of true.
                /// </param>
                /// <returns type="Object" locid="WinJS.Utilities.requireSupportedForProcessing_returnValue">
                /// The input value.
                /// </returns>
                /// </signature>
                var supportedForProcessing = true;

                supportedForProcessing = supportedForProcessing && !(value === global);
                supportedForProcessing = supportedForProcessing && !(value === global.location);
                supportedForProcessing = supportedForProcessing && !(value instanceof HTMLIFrameElement);
                supportedForProcessing = supportedForProcessing && !(typeof value === "function" && !value.supportedForProcessing);

                switch (global.frames.length) {
                    case 0:
                        break;

                    case 1:
                        supportedForProcessing = supportedForProcessing && !(value === global.frames[0]);
                        break;

                    default:
                        for (var i = 0, len = global.frames.length; supportedForProcessing && i < len; i++) {
                            supportedForProcessing = supportedForProcessing && !(value === global.frames[i]);
                        }
                        break;
                }

                if (supportedForProcessing) {
                    return value;
                }

                throw new WinJS.ErrorFromName("WinJS.Utilities.requireSupportedForProcessing", WinJS.Resources._formatString(strings.notSupportedForProcessing, value));
            },
            configurable: false,
            writable: false,
            enumerable: true
        },

        _shallowCopy: function _shallowCopy(a) {
            // Shallow copy a single object.
            return this._mergeAll([a]);
        },

        _merge: function _merge(a, b) {
            // Merge 2 objects together into a new object
            return this._mergeAll([a, b]);
        },

        _mergeAll: function _mergeAll(list) {
            // Merge a list of objects together
            var o = {};
            list.forEach(function (part) {
                Object.keys(part).forEach(function (k) {
                    o[k] = part[k];
                });
            });
            return o;
        },
        
        _getProfilerMarkIdentifier: function (element) {
            var profilerMarkIdentifier = "";
            if (element.id) {
                profilerMarkIdentifier += " id='" + element.id + "'";
            }
            if (element.className) {
                profilerMarkIdentifier += " class='" + element.className + "'";
            }
            return profilerMarkIdentifier;
        }
    });

    WinJS.Namespace.define("WinJS", {
        validation: false,

        strictProcessing: {
            value: function () {
                /// <signature helpKeyword="WinJS.strictProcessing">
                /// <summary locid="WinJS.strictProcessing">
                /// Strict processing is always enforced, this method has no effect.
                /// </summary>
                /// </signature>
            },
            configurable: false,
            writable: false,
            enumerable: false
        },
    });
})(this, WinJS);

 /***********************************************************
 * errors.js
 **********************************************************/
(function errorsInit(global, WinJS) {
    "use strict";


    WinJS.Namespace.define("WinJS", {
        // ErrorFromName establishes a simple pattern for returning error codes.
        //
        ErrorFromName: WinJS.Class.derive(Error, function (name, message) {
            /// <signature helpKeyword="WinJS.ErrorFromName">
            /// <summary locid="WinJS.ErrorFromName">
            /// Creates an Error object with the specified name and message properties.
            /// </summary>
            /// <param name="name" type="String" locid="WinJS.ErrorFromName_p:name">The name of this error. The name is meant to be consumed programmatically and should not be localized.</param>
            /// <param name="message" type="String" optional="true" locid="WinJS.ErrorFromName_p:message">The message for this error. The message is meant to be consumed by humans and should be localized.</param>
            /// <returns type="Error" locid="WinJS.ErrorFromName_returnValue">Error instance with .name and .message properties populated</returns>
            /// </signature>
            this.name = name;
            this.message = message || name;
        }, {
            /* empty */
        }, {
            supportedForProcessing: false,
        })
    });

})(this, WinJS);



 /***********************************************************
 * events.js
 **********************************************************/
 (function eventsInit(WinJS, undefined) {
    "use strict";


    function createEventProperty(name) {
        var eventPropStateName = "_on" + name + "state";

        return {
            get: function () {
                var state = this[eventPropStateName];
                return state && state.userHandler;
            },
            set: function (handler) {
                var state = this[eventPropStateName];
                if (handler) {
                    if (!state) {
                        state = { wrapper: function (evt) { return state.userHandler(evt); }, userHandler: handler };
                        Object.defineProperty(this, eventPropStateName, { value: state, enumerable: false, writable:true, configurable: true });
                        this.addEventListener(name, state.wrapper, false);
                    }
                    state.userHandler = handler;
                } else if (state) {
                    this.removeEventListener(name, state.wrapper, false);
                    this[eventPropStateName] = null;
                }
            },
            enumerable: true
        }
    }

    function createEventProperties(events) {
        /// <signature helpKeyword="WinJS.Utilities.createEventProperties">
        /// <summary locid="WinJS.Utilities.createEventProperties">
        /// Creates an object that has one property for each name passed to the function.
        /// </summary>
        /// <param name="events" locid="WinJS.Utilities.createEventProperties_p:events">
        /// A variable list of property names.
        /// </param>
        /// <returns type="Object" locid="WinJS.Utilities.createEventProperties_returnValue">
        /// The object with the specified properties. The names of the properties are prefixed with 'on'.
        /// </returns>
        /// </signature>
        var props = {};
        for (var i = 0, len = arguments.length; i < len; i++) {
            var name = arguments[i];
            props["on" + name] = createEventProperty(name);
        }
        return props;
    }

    var EventMixinEvent = WinJS.Class.define(
        function EventMixinEvent_ctor(type, detail, target) {
            this.detail = detail;
            this.target = target;
            this.timeStamp = Date.now();
            this.type = type;
        },
        {
            bubbles: { value: false, writable: false },
            cancelable: { value: false, writable: false },
            currentTarget: {
                get: function () { return this.target; }
            },
            defaultPrevented: {
                get: function () { return this._preventDefaultCalled; }
            },
            trusted: { value: false, writable: false },
            eventPhase: { value: 0, writable: false },
            target: null,
            timeStamp: null,
            type: null,

            preventDefault: function () {
                this._preventDefaultCalled = true;
            },
            stopImmediatePropagation: function () {
                this._stopImmediatePropagationCalled = true;
            },
            stopPropagation: function () {
            }
        }, {
            supportedForProcessing: false,
        }
    );

    var eventMixin = {
        _listeners: null,

        addEventListener: function (type, listener, useCapture) {
            /// <signature helpKeyword="WinJS.Utilities.eventMixin.addEventListener">
            /// <summary locid="WinJS.Utilities.eventMixin.addEventListener">
            /// Adds an event listener to the control.
            /// </summary>
            /// <param name="type" locid="WinJS.Utilities.eventMixin.addEventListener_p:type">
            /// The type (name) of the event.
            /// </param>
            /// <param name="listener" locid="WinJS.Utilities.eventMixin.addEventListener_p:listener">
            /// The listener to invoke when the event is raised.
            /// </param>
            /// <param name="useCapture" locid="WinJS.Utilities.eventMixin.addEventListener_p:useCapture">
            /// if true initiates capture, otherwise false.
            /// </param>
            /// </signature>
            useCapture = useCapture || false;
            this._listeners = this._listeners || {};
            var eventListeners = (this._listeners[type] = this._listeners[type] || []);
            for (var i = 0, len = eventListeners.length; i < len; i++) {
                var l = eventListeners[i];
                if (l.useCapture === useCapture && l.listener === listener) {
                    return;
                }
            }
            eventListeners.push({ listener: listener, useCapture: useCapture });
        },
        dispatchEvent: function (type, details) {
            /// <signature helpKeyword="WinJS.Utilities.eventMixin.dispatchEvent">
            /// <summary locid="WinJS.Utilities.eventMixin.dispatchEvent">
            /// Raises an event of the specified type and with the specified additional properties.
            /// </summary>
            /// <param name="type" locid="WinJS.Utilities.eventMixin.dispatchEvent_p:type">
            /// The type (name) of the event.
            /// </param>
            /// <param name="details" locid="WinJS.Utilities.eventMixin.dispatchEvent_p:details">
            /// The set of additional properties to be attached to the event object when the event is raised.
            /// </param>
            /// <returns type="Boolean" locid="WinJS.Utilities.eventMixin.dispatchEvent_returnValue">
            /// true if preventDefault was called on the event.
            /// </returns>
            /// </signature>
            var listeners = this._listeners && this._listeners[type];
            if (listeners) {
                var eventValue = new EventMixinEvent(type, details, this);
                // Need to copy the array to protect against people unregistering while we are dispatching
                listeners = listeners.slice(0, listeners.length);
                for (var i = 0, len = listeners.length; i < len && !eventValue._stopImmediatePropagationCalled; i++) {
                    listeners[i].listener(eventValue);
                }
                return eventValue.defaultPrevented || false;
            }
            return false;
        },
        removeEventListener: function (type, listener, useCapture) {
            /// <signature helpKeyword="WinJS.Utilities.eventMixin.removeEventListener">
            /// <summary locid="WinJS.Utilities.eventMixin.removeEventListener">
            /// Removes an event listener from the control.
            /// </summary>
            /// <param name="type" locid="WinJS.Utilities.eventMixin.removeEventListener_p:type">
            /// The type (name) of the event.
            /// </param>
            /// <param name="listener" locid="WinJS.Utilities.eventMixin.removeEventListener_p:listener">
            /// The listener to remove.
            /// </param>
            /// <param name="useCapture" locid="WinJS.Utilities.eventMixin.removeEventListener_p:useCapture">
            /// Specifies whether to initiate capture.
            /// </param>
            /// </signature>
            useCapture = useCapture || false;
            var listeners = this._listeners && this._listeners[type];
            if (listeners) {
                for (var i = 0, len = listeners.length; i < len; i++) {
                    var l = listeners[i];
                    if (l.listener === listener && l.useCapture === useCapture) {
                        listeners.splice(i, 1);
                        if (listeners.length === 0) {
                            delete this._listeners[type];
                        }
                        // Only want to remove one element for each call to removeEventListener
                        break;
                    }
                }
            }
        }
    };

    WinJS.Namespace.define("WinJS.Utilities", {
        _createEventProperty: createEventProperty,
        createEventProperties: createEventProperties,
        eventMixin: eventMixin
    });

})(WinJS);
 
  /***********************************************************
 * promise.js
 **********************************************************/
 (function promiseInit(global, undefined) {
    "use strict";

    var ListenerType = WinJS.Class.mix(WinJS.Class.define(null, { /*empty*/ }, { supportedForProcessing: false }), WinJS.Utilities.eventMixin);
    var promiseEventListeners = new ListenerType();
    // make sure there is a listeners collection so that we can do a more trivial check below
    promiseEventListeners._listeners = {};
    var errorET = "error";
    var canceledName = "Canceled";
    var tagWithStack = false;
    var tag = {
        promise: 0x01,
        thenPromise: 0x02,
        errorPromise: 0x04,
        exceptionPromise: 0x08,
        completePromise: 0x10,
    };
    tag.all = tag.promise | tag.thenPromise | tag.errorPromise | tag.exceptionPromise | tag.completePromise;

    //
    // Global error counter, for each error which enters the system we increment this once and then
    // the error number travels with the error as it traverses the tree of potential handlers.
    //
    // When someone has registered to be told about errors (WinJS.Promise.callonerror) promises
    // which are in error will get tagged with a ._errorId field. This tagged field is the
    // contract by which nested promises with errors will be identified as chaining for the
    // purposes of the callonerror semantics. If a nested promise in error is encountered without
    // a ._errorId it will be assumed to be foreign and treated as an interop boundary and
    // a new error id will be minted.
    //
    var error_number = 1;

    //
    // The state machine has a interesting hiccup in it with regards to notification, in order
    // to flatten out notification and avoid recursion for synchronous completion we have an
    // explicit set of *_notify states which are responsible for notifying their entire tree
    // of children. They can do this because they know that immediate children are always
    // ThenPromise instances and we can therefore reach into their state to access the
    // _listeners collection.
    //
    // So, what happens is that a Promise will be fulfilled through the _completed or _error
    // messages at which point it will enter a *_notify state and be responsible for to move
    // its children into an (as appropriate) success or error state and also notify that child's
    // listeners of the state transition, until leaf notes are reached.
    //

    var state_created,              // -> working
        state_working,              // -> error | error_notify | success | success_notify | canceled | waiting
        state_waiting,              // -> error | error_notify | success | success_notify | waiting_canceled
        state_waiting_canceled,     // -> error | error_notify | success | success_notify | canceling
        state_canceled,             // -> error | error_notify | success | success_notify | canceling
        state_canceling,            // -> error_notify
        state_success_notify,       // -> success
        state_success,              // -> .
        state_error_notify,         // -> error
        state_error;                // -> .

    // Noop function, used in the various states to indicate that they don't support a given
    // message. Named with the somewhat cute name '_' because it reads really well in the states.

    function _() { }

    // Initial state
    //
    state_created = {
        name: "created",
        enter: function (promise) {
            promise._setState(state_working);
        },
        cancel: _,
        done: _,
        then: _,
        _completed: _,
        _error: _,
        _notify: _,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    // Ready state, waiting for a message (completed/error/progress), able to be canceled
    //
    state_working = {
        name: "working",
        enter: _,
        cancel: function (promise) {
            promise._setState(state_canceled);
        },
        done: done,
        then: then,
        _completed: completed,
        _error: error,
        _notify: _,
        _progress: progress,
        _setCompleteValue: setCompleteValue,
        _setErrorValue: setErrorValue
    };

    // Waiting state, if a promise is completed with a value which is itself a promise
    // (has a then() method) it signs up to be informed when that child promise is
    // fulfilled at which point it will be fulfilled with that value.
    //
    state_waiting = {
        name: "waiting",
        enter: function (promise) {
            var waitedUpon = promise._value;
            // We can special case our own intermediate promises which are not in a 
            //  terminal state by just pushing this promise as a listener without 
            //  having to create new indirection functions
            if (waitedUpon instanceof ThenPromise &&
                waitedUpon._state !== state_error &&
                waitedUpon._state !== state_success) {
                pushListener(waitedUpon, { promise: promise });
            } else {
                var error = function (value) {
                    if (waitedUpon._errorId) {
                        promise._chainedError(value, waitedUpon);
                    } else {
                        // Because this is an interop boundary we want to indicate that this 
                        //  error has been handled by the promise infrastructure before we
                        //  begin a new handling chain.
                        //
                        callonerror(promise, value, detailsForHandledError, waitedUpon, error);
                        promise._error(value);
                    }
                };
                error.handlesOnError = true;
                waitedUpon.then(
                    promise._completed.bind(promise),
                    error,
                    promise._progress.bind(promise)
                );
            }
        },
        cancel: function (promise) {
            promise._setState(state_waiting_canceled);
        },
        done: done,
        then: then,
        _completed: completed,
        _error: error,
        _notify: _,
        _progress: progress,
        _setCompleteValue: setCompleteValue,
        _setErrorValue: setErrorValue
    };

    // Waiting canceled state, when a promise has been in a waiting state and receives a
    // request to cancel its pending work it will forward that request to the child promise
    // and then waits to be informed of the result. This promise moves itself into the
    // canceling state but understands that the child promise may instead push it to a
    // different state.
    //
    state_waiting_canceled = {
        name: "waiting_canceled",
        enter: function (promise) {
            // Initiate a transition to canceling. Triggering a cancel on the promise
            // that we are waiting upon may result in a different state transition
            // before the state machine pump runs again.
            promise._setState(state_canceling);
            var waitedUpon = promise._value;
            if (waitedUpon.cancel) {
                waitedUpon.cancel();
            }
        },
        cancel: _,
        done: done,
        then: then,
        _completed: completed,
        _error: error,
        _notify: _,
        _progress: progress,
        _setCompleteValue: setCompleteValue,
        _setErrorValue: setErrorValue
    };

    // Canceled state, moves to the canceling state and then tells the promise to do
    // whatever it might need to do on cancelation.
    //
    state_canceled = {
        name: "canceled",
        enter: function (promise) {
            // Initiate a transition to canceling. The _cancelAction may change the state
            // before the state machine pump runs again.
            promise._setState(state_canceling);
            promise._cancelAction();
        },
        cancel: _,
        done: done,
        then: then,
        _completed: completed,
        _error: error,
        _notify: _,
        _progress: progress,
        _setCompleteValue: setCompleteValue,
        _setErrorValue: setErrorValue
    };

    // Canceling state, commits to the promise moving to an error state with an error
    // object whose 'name' and 'message' properties contain the string "Canceled"
    //
    state_canceling = {
        name: "canceling",
        enter: function (promise) {
            var error = new Error(canceledName);
            error.name = error.message;
            promise._value = error;
            promise._setState(state_error_notify);
        },
        cancel: _,
        done: _,
        then: _,
        _completed: _,
        _error: _,
        _notify: _,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    // Success notify state, moves a promise to the success state and notifies all children
    //
    state_success_notify = {
        name: "complete_notify",
        enter: function (promise) {
            promise.done = CompletePromise.prototype.done;
            promise.then = CompletePromise.prototype.then;
            if (promise._listeners) {
                var queue = [promise];
                var p;
                while (queue.length) {
                    p = queue.shift();
                    p._state._notify(p, queue);
                }
            }
            promise._setState(state_success);
        },
        cancel: _,
        done: null, /*error to get here */
        then: null, /*error to get here */
        _completed: _,
        _error: _,
        _notify: notifySuccess,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    // Success state, moves a promise to the success state and does NOT notify any children.
    // Some upstream promise is owning the notification pass.
    //
    state_success = {
        name: "success",
        enter: function (promise) {
            promise.done = CompletePromise.prototype.done;
            promise.then = CompletePromise.prototype.then;
            promise._cleanupAction();
        },
        cancel: _,
        done: null, /*error to get here */
        then: null, /*error to get here */
        _completed: _,
        _error: _,
        _notify: notifySuccess,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    // Error notify state, moves a promise to the error state and notifies all children
    //
    state_error_notify = {
        name: "error_notify",
        enter: function (promise) {
            promise.done = ErrorPromise.prototype.done;
            promise.then = ErrorPromise.prototype.then;
            if (promise._listeners) {
                var queue = [promise];
                var p;
                while (queue.length) {
                    p = queue.shift();
                    p._state._notify(p, queue);
                }
            }
            promise._setState(state_error);
        },
        cancel: _,
        done: null, /*error to get here*/
        then: null, /*error to get here*/
        _completed: _,
        _error: _,
        _notify: notifyError,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    // Error state, moves a promise to the error state and does NOT notify any children.
    // Some upstream promise is owning the notification pass.
    //
    state_error = {
        name: "error",
        enter: function (promise) {
            promise.done = ErrorPromise.prototype.done;
            promise.then = ErrorPromise.prototype.then;
            promise._cleanupAction();
        },
        cancel: _,
        done: null, /*error to get here*/
        then: null, /*error to get here*/
        _completed: _,
        _error: _,
        _notify: notifyError,
        _progress: _,
        _setCompleteValue: _,
        _setErrorValue: _
    };

    //
    // The statemachine implementation follows a very particular pattern, the states are specified
    // as static stateless bags of functions which are then indirected through the state machine
    // instance (a Promise). As such all of the functions on each state have the promise instance
    // passed to them explicitly as a parameter and the Promise instance members do a little
    // dance where they indirect through the state and insert themselves in the argument list.
    //
    // We could instead call directly through the promise states however then every caller
    // would have to remember to do things like pumping the state machine to catch state transitions.
    //

    var PromiseStateMachine = WinJS.Class.define(null, {
        _listeners: null,
        _nextState: null,
        _state: null,
        _value: null,

        cancel: function () {
            /// <signature helpKeyword="WinJS.PromiseStateMachine.cancel">
            /// <summary locid="WinJS.PromiseStateMachine.cancel">
            /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't
            /// already been fulfilled and cancellation is supported, the promise enters
            /// the error state with a value of Error("Canceled").
            /// </summary>
            /// </signature>
            this._state.cancel(this);
            this._run();
        },
        done: function Promise_done(onComplete, onError, onProgress) {
            /// <signature helpKeyword="WinJS.PromiseStateMachine.done">
            /// <summary locid="WinJS.PromiseStateMachine.done">
            /// Allows you to specify the work to be done on the fulfillment of the promised value,
            /// the error handling to be performed if the promise fails to fulfill
            /// a value, and the handling of progress notifications along the way.
            ///
            /// After the handlers have finished executing, this function throws any error that would have been returned
            /// from then() as a promise in the error state.
            /// </summary>
            /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.done_p:onComplete">
            /// The function to be called if the promise is fulfilled successfully with a value.
            /// The fulfilled value is passed as the single argument. If the value is null,
            /// the fulfilled value is returned. The value returned
            /// from the function becomes the fulfilled value of the promise returned by
            /// then(). If an exception is thrown while executing the function, the promise returned
            /// by then() moves into the error state.
            /// </param>
            /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onError">
            /// The function to be called if the promise is fulfilled with an error. The error
            /// is passed as the single argument. If it is null, the error is forwarded.
            /// The value returned from the function is the fulfilled value of the promise returned by then().
            /// </param>
            /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onProgress">
            /// the function to be called if the promise reports progress. Data about the progress
            /// is passed as the single argument. Promises are not required to support
            /// progress.
            /// </param>
            /// </signature>
            this._state.done(this, onComplete, onError, onProgress);
        },
        then: function Promise_then(onComplete, onError, onProgress) {
            /// <signature helpKeyword="WinJS.PromiseStateMachine.then">
            /// <summary locid="WinJS.PromiseStateMachine.then">
            /// Allows you to specify the work to be done on the fulfillment of the promised value,
            /// the error handling to be performed if the promise fails to fulfill
            /// a value, and the handling of progress notifications along the way.
            /// </summary>
            /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.then_p:onComplete">
            /// The function to be called if the promise is fulfilled successfully with a value.
            /// The value is passed as the single argument. If the value is null, the value is returned.
            /// The value returned from the function becomes the fulfilled value of the promise returned by
            /// then(). If an exception is thrown while this function is being executed, the promise returned
            /// by then() moves into the error state.
            /// </param>
            /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onError">
            /// The function to be called if the promise is fulfilled with an error. The error
            /// is passed as the single argument. If it is null, the error is forwarded.
            /// The value returned from the function becomes the fulfilled value of the promise returned by then().
            /// </param>
            /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onProgress">
            /// The function to be called if the promise reports progress. Data about the progress
            /// is passed as the single argument. Promises are not required to support
            /// progress.
            /// </param>
            /// <returns type="WinJS.Promise" locid="WinJS.PromiseStateMachine.then_returnValue">
            /// The promise whose value is the result of executing the complete or
            /// error function.
            /// </returns>
            /// </signature>
            return this._state.then(this, onComplete, onError, onProgress);
        },

        _chainedError: function (value, context) {
            var result = this._state._error(this, value, detailsForChainedError, context);
            this._run();
            return result;
        },
        _completed: function (value) {
            var result = this._state._completed(this, value);
            this._run();
            return result;
        },
        _error: function (value) {
            var result = this._state._error(this, value, detailsForError);
            this._run();
            return result;
        },
        _progress: function (value) {
            this._state._progress(this, value);
        },
        _setState: function (state) {
            this._nextState = state;
        },
        _setCompleteValue: function (value) {
            this._state._setCompleteValue(this, value);
            this._run();
        },
        _setChainedErrorValue: function (value, context) {
            var result = this._state._setErrorValue(this, value, detailsForChainedError, context);
            this._run();
            return result;
        },
        _setExceptionValue: function (value) {
            var result = this._state._setErrorValue(this, value, detailsForException);
            this._run();
            return result;
        },
        _run: function () {
            while (this._nextState) {
                this._state = this._nextState;
                this._nextState = null;
                this._state.enter(this);
            }
        }
    }, {
        supportedForProcessing: false
    });

    //
    // Implementations of shared state machine code.
    //

    function completed(promise, value) {
        var targetState;
        if (value && typeof value === "object" && typeof value.then === "function") {
            targetState = state_waiting;
        } else {
            targetState = state_success_notify;
        }
        promise._value = value;
        promise._setState(targetState);
    }
    function createErrorDetails(exception, error, promise, id, parent, handler) {
        return {
            exception: exception,
            error: error,
            promise: promise,
            handler: handler,
            id: id,
            parent: parent
        };
    }
    function detailsForHandledError(promise, errorValue, context, handler) {
        var exception = context._isException;
        var errorId = context._errorId;
        return createErrorDetails(
            exception ? errorValue : null,
            exception ? null : errorValue,
            promise,
            errorId,
            context,
            handler
        );
    }
    function detailsForChainedError(promise, errorValue, context) {
        var exception = context._isException;
        var errorId = context._errorId;
        setErrorInfo(promise, errorId, exception);
        return createErrorDetails(
            exception ? errorValue : null,
            exception ? null : errorValue,
            promise,
            errorId,
            context
        );
    }
    function detailsForError(promise, errorValue) {
        var errorId = ++error_number;
        setErrorInfo(promise, errorId);
        return createErrorDetails(
            null,
            errorValue,
            promise,
            errorId
        );
    }
    function detailsForException(promise, exceptionValue) {
        var errorId = ++error_number;
        setErrorInfo(promise, errorId, true);
        return createErrorDetails(
            exceptionValue,
            null,
            promise,
            errorId
        );
    }
    function done(promise, onComplete, onError, onProgress) {
        var asyncOpID = "WinJS.Promise.done";
        pushListener(promise, { c: onComplete, e: onError, p: onProgress, asyncOpID: asyncOpID });
    }
    function error(promise, value, onerrorDetails, context) {
        promise._value = value;
        callonerror(promise, value, onerrorDetails, context);
        promise._setState(state_error_notify);
    }
    function notifySuccess(promise, queue) {
        var value = promise._value;
        var listeners = promise._listeners;
        if (!listeners) {
            return;
        }
        promise._listeners = null;
        var i, len;
        for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {
            var listener = len === 1 ? listeners : listeners[i];
            var onComplete = listener.c;
            var target = listener.promise;

            if (target) {
                try {
                    target._setCompleteValue(onComplete ? onComplete(value) : value);
                } catch (ex) {
                    target._setExceptionValue(ex);
                } finally {
                }
                if (target._state !== state_waiting && target._listeners) {
                    queue.push(target);
                }
            } else {
                CompletePromise.prototype.done.call(promise, onComplete);
            }
        }
    }
    function notifyError(promise, queue) {
        var value = promise._value;
        var listeners = promise._listeners;
        if (!listeners) {
            return;
        }
        promise._listeners = null;
        var i, len;
        for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {
            var listener = len === 1 ? listeners : listeners[i];
            var onError = listener.e;
            var target = listener.promise;

            if (target) {
                var asyncCallbackStarted = false;
                try {
                    if (onError) {
                        asyncCallbackStarted = true;
                        if (!onError.handlesOnError) {
                            callonerror(target, value, detailsForHandledError, promise, onError);
                        }
                        target._setCompleteValue(onError(value))
                    } else {
                        target._setChainedErrorValue(value, promise);
                    }
                } catch (ex) {
                    target._setExceptionValue(ex);
                } finally {
                }
                if (target._state !== state_waiting && target._listeners) {
                    queue.push(target);
                }
            } else {
                ErrorPromise.prototype.done.call(promise, null, onError);
            }
        }
    }
    function callonerror(promise, value, onerrorDetailsGenerator, context, handler) {
        if (promiseEventListeners._listeners[errorET]) {
            if (value instanceof Error && value.message === canceledName) {
                return;
            }
            promiseEventListeners.dispatchEvent(errorET, onerrorDetailsGenerator(promise, value, context, handler));
        }
    }
    function progress(promise, value) {
        var listeners = promise._listeners;
        if (listeners) {
            var i, len;
            for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {
                var listener = len === 1 ? listeners : listeners[i];
                var onProgress = listener.p;
                if (onProgress) {
                    try { onProgress(value); } catch (ex) { }
                }
                if (!(listener.c || listener.e) && listener.promise) {
                    listener.promise._progress(value);
                }
            }
        }
    }
    function pushListener(promise, listener) {
        var listeners = promise._listeners;
        if (listeners) {
            // We may have either a single listener (which will never be wrapped in an array)
            // or 2+ listeners (which will be wrapped). Since we are now adding one more listener
            // we may have to wrap the single listener before adding the second.
            listeners = Array.isArray(listeners) ? listeners : [listeners];
            listeners.push(listener);
        } else {
            listeners = listener;
        }
        promise._listeners = listeners;
    }
    // The difference beween setCompleteValue()/setErrorValue() and complete()/error() is that setXXXValue() moves
    // a promise directly to the success/error state without starting another notification pass (because one
    // is already ongoing).
    function setErrorInfo(promise, errorId, isException) {
        promise._isException = isException || false;
        promise._errorId = errorId;
    }
    function setErrorValue(promise, value, onerrorDetails, context) {
        promise._value = value;
        callonerror(promise, value, onerrorDetails, context);
        promise._setState(state_error);
    }
    function setCompleteValue(promise, value) {
        var targetState;
        if (value && typeof value === "object" && typeof value.then === "function") {
            targetState = state_waiting;
        } else {
            targetState = state_success;
        }
        promise._value = value;
        promise._setState(targetState);
    }
    function then(promise, onComplete, onError, onProgress) {
        var result = new ThenPromise(promise);
        var asyncOpID = "WinJS.Promise.then";
        pushListener(promise, { promise: result, c: onComplete, e: onError, p: onProgress, asyncOpID: asyncOpID });
        return result;
    }

    //
    // Internal implementation detail promise, ThenPromise is created when a promise needs
    // to be returned from a then() method.
    //
    var ThenPromise = WinJS.Class.derive(PromiseStateMachine,
        function (creator) {

            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.thenPromise))) {
                this._stack = WinJS.Promise._getStack();
            }

            this._creator = creator;
            this._setState(state_created);
            this._run();
        }, {
            _creator: null,

            _cancelAction: function () { if (this._creator) { this._creator.cancel(); } },
            _cleanupAction: function () { this._creator = null; }
        }, {
            supportedForProcessing: false
        }
    );

    //
    // Slim promise implementations for already completed promises, these are created
    // under the hood on synchronous completion paths as well as by WinJS.Promise.wrap
    // and WinJS.Promise.wrapError.
    //

    var ErrorPromise = WinJS.Class.define(
        function ErrorPromise_ctor(value) {

            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.errorPromise))) {
                this._stack = WinJS.Promise._getStack();
            }

            this._value = value;
            callonerror(this, value, detailsForError);
        }, {
            cancel: function () {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.cancel">
                /// <summary locid="WinJS.PromiseStateMachine.cancel">
                /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't
                /// already been fulfilled and cancellation is supported, the promise enters
                /// the error state with a value of Error("Canceled").
                /// </summary>
                /// </signature>
            },
            done: function ErrorPromise_done(unused, onError) {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.done">
                /// <summary locid="WinJS.PromiseStateMachine.done">
                /// Allows you to specify the work to be done on the fulfillment of the promised value,
                /// the error handling to be performed if the promise fails to fulfill
                /// a value, and the handling of progress notifications along the way.
                ///
                /// After the handlers have finished executing, this function throws any error that would have been returned
                /// from then() as a promise in the error state.
                /// </summary>
                /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.done_p:onComplete">
                /// The function to be called if the promise is fulfilled successfully with a value.
                /// The fulfilled value is passed as the single argument. If the value is null,
                /// the fulfilled value is returned. The value returned
                /// from the function becomes the fulfilled value of the promise returned by
                /// then(). If an exception is thrown while executing the function, the promise returned
                /// by then() moves into the error state.
                /// </param>
                /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onError">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument. If it is null, the error is forwarded.
                /// The value returned from the function is the fulfilled value of the promise returned by then().
                /// </param>
                /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onProgress">
                /// the function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// </signature>
                var value = this._value;
                if (onError) {
                    try {
                        if (!onError.handlesOnError) {
                            callonerror(null, value, detailsForHandledError, this, onError);
                        }
                        var result = onError(value);
                        if (result && typeof result === "object" && typeof result.done === "function") {
                            // If a promise is returned we need to wait on it.
                            result.done();
                        }
                        return;
                    } catch (ex) {
                        value = ex;
                    }
                }
                if (value instanceof Error && value.message === canceledName) {
                    // suppress cancel
                    return;
                }
                // force the exception to be thrown asyncronously to avoid any try/catch blocks
                //
                WinJS.Utilities.Scheduler.schedule(function () {
                    throw value;
                }, WinJS.Utilities.Scheduler.Priority.normal, null, "WinJS.Promise._throwException");
            },
            then: function ErrorPromise_then(unused, onError) {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.then">
                /// <summary locid="WinJS.PromiseStateMachine.then">
                /// Allows you to specify the work to be done on the fulfillment of the promised value,
                /// the error handling to be performed if the promise fails to fulfill
                /// a value, and the handling of progress notifications along the way.
                /// </summary>
                /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.then_p:onComplete">
                /// The function to be called if the promise is fulfilled successfully with a value.
                /// The value is passed as the single argument. If the value is null, the value is returned.
                /// The value returned from the function becomes the fulfilled value of the promise returned by
                /// then(). If an exception is thrown while this function is being executed, the promise returned
                /// by then() moves into the error state.
                /// </param>
                /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onError">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument. If it is null, the error is forwarded.
                /// The value returned from the function becomes the fulfilled value of the promise returned by then().
                /// </param>
                /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onProgress">
                /// The function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.PromiseStateMachine.then_returnValue">
                /// The promise whose value is the result of executing the complete or
                /// error function.
                /// </returns>
                /// </signature>

                // If the promise is already in a error state and no error handler is provided
                // we optimize by simply returning the promise instead of creating a new one.
                //
                if (!onError) { return this; }
                var result;
                var value = this._value;
                try {
                    if (!onError.handlesOnError) {
                        callonerror(null, value, detailsForHandledError, this, onError);
                    }
                    result = new CompletePromise(onError(value));
                } catch (ex) {
                    // If the value throw from the error handler is the same as the value
                    // provided to the error handler then there is no need for a new promise.
                    //
                    if (ex === value) {
                        result = this;
                    } else {
                        result = new ExceptionPromise(ex);
                    }
                }
                return result;
            }
        }, {
            supportedForProcessing: false
        }
    );

    var ExceptionPromise = WinJS.Class.derive(ErrorPromise,
        function ExceptionPromise_ctor(value) {

            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.exceptionPromise))) {
                this._stack = WinJS.Promise._getStack();
            }

            this._value = value;
            callonerror(this, value, detailsForException);
        }, {
            /* empty */
        }, {
            supportedForProcessing: false
        }
    );

    var CompletePromise = WinJS.Class.define(
        function CompletePromise_ctor(value) {

            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.completePromise))) {
                this._stack = WinJS.Promise._getStack();
            }

            if (value && typeof value === "object" && typeof value.then === "function") {
                var result = new ThenPromise(null);
                result._setCompleteValue(value);
                return result;
            }
            this._value = value;
        }, {
            cancel: function () {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.cancel">
                /// <summary locid="WinJS.PromiseStateMachine.cancel">
                /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't
                /// already been fulfilled and cancellation is supported, the promise enters
                /// the error state with a value of Error("Canceled").
                /// </summary>
                /// </signature>
            },
            done: function CompletePromise_done(onComplete) {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.done">
                /// <summary locid="WinJS.PromiseStateMachine.done">
                /// Allows you to specify the work to be done on the fulfillment of the promised value,
                /// the error handling to be performed if the promise fails to fulfill
                /// a value, and the handling of progress notifications along the way.
                ///
                /// After the handlers have finished executing, this function throws any error that would have been returned
                /// from then() as a promise in the error state.
                /// </summary>
                /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.done_p:onComplete">
                /// The function to be called if the promise is fulfilled successfully with a value.
                /// The fulfilled value is passed as the single argument. If the value is null,
                /// the fulfilled value is returned. The value returned
                /// from the function becomes the fulfilled value of the promise returned by
                /// then(). If an exception is thrown while executing the function, the promise returned
                /// by then() moves into the error state.
                /// </param>
                /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onError">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument. If it is null, the error is forwarded.
                /// The value returned from the function is the fulfilled value of the promise returned by then().
                /// </param>
                /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.done_p:onProgress">
                /// the function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// </signature>
                if (!onComplete) { return; }
                try {
                    var result = onComplete(this._value);
                    if (result && typeof result === "object" && typeof result.done === "function") {
                        result.done();
                    }
                } catch (ex) {
                    // force the exception to be thrown asynchronously to avoid any try/catch blocks
                    WinJS.Utilities.Scheduler.schedule(function () {
                        throw ex;
                    }, WinJS.Utilities.Scheduler.Priority.normal, null, "WinJS.Promise._throwException");
                }
            },
            then: function CompletePromise_then(onComplete) {
                /// <signature helpKeyword="WinJS.PromiseStateMachine.then">
                /// <summary locid="WinJS.PromiseStateMachine.then">
                /// Allows you to specify the work to be done on the fulfillment of the promised value,
                /// the error handling to be performed if the promise fails to fulfill
                /// a value, and the handling of progress notifications along the way.
                /// </summary>
                /// <param name='onComplete' type='Function' locid="WinJS.PromiseStateMachine.then_p:onComplete">
                /// The function to be called if the promise is fulfilled successfully with a value.
                /// The value is passed as the single argument. If the value is null, the value is returned.
                /// The value returned from the function becomes the fulfilled value of the promise returned by
                /// then(). If an exception is thrown while this function is being executed, the promise returned
                /// by then() moves into the error state.
                /// </param>
                /// <param name='onError' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onError">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument. If it is null, the error is forwarded.
                /// The value returned from the function becomes the fulfilled value of the promise returned by then().
                /// </param>
                /// <param name='onProgress' type='Function' optional='true' locid="WinJS.PromiseStateMachine.then_p:onProgress">
                /// The function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.PromiseStateMachine.then_returnValue">
                /// The promise whose value is the result of executing the complete or
                /// error function.
                /// </returns>
                /// </signature>
                try {
                    // If the value returned from the completion handler is the same as the value
                    // provided to the completion handler then there is no need for a new promise.
                    //
                    var newValue = onComplete ? onComplete(this._value) : this._value;
                    return newValue === this._value ? this : new CompletePromise(newValue);
                } catch (ex) {
                    return new ExceptionPromise(ex);
                }
            }
        }, {
            supportedForProcessing: false
        }
    );

    //
    // Promise is the user-creatable WinJS.Promise object.
    //

    function timeout(timeoutMS) {
        var id;
        return new WinJS.Promise(
            function (c) {
                if (timeoutMS) {
                    id = setTimeout(c, timeoutMS);
                } else {
                    setImmediate(c);
                }
            },
            function () {
                if (id) {
                    clearTimeout(id);
                }
            }
        );
    }

    function timeoutWithPromise(timeout, promise) {
        var cancelPromise = function () { promise.cancel(); }
        var cancelTimeout = function () { timeout.cancel(); }
        timeout.then(cancelPromise);
        promise.then(cancelTimeout, cancelTimeout);
        return promise;
    }

    var staticCanceledPromise;

    var Promise = WinJS.Class.derive(PromiseStateMachine,
        function Promise_ctor(init, oncancel) {
            /// <signature helpKeyword="WinJS.Promise">
            /// <summary locid="WinJS.Promise">
            /// A promise provides a mechanism to schedule work to be done on a value that
            /// has not yet been computed. It is a convenient abstraction for managing
            /// interactions with asynchronous APIs.
            /// </summary>
            /// <param name="init" type="Function" locid="WinJS.Promise_p:init">
            /// The function that is called during construction of the  promise. The function
            /// is given three arguments (complete, error, progress). Inside this function
            /// you should add event listeners for the notifications supported by this value.
            /// </param>
            /// <param name="oncancel" optional="true" locid="WinJS.Promise_p:oncancel">
            /// The function to call if a consumer of this promise wants
            /// to cancel its undone work. Promises are not required to
            /// support cancellation.
            /// </param>
            /// </signature>

            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.promise))) {
                this._stack = WinJS.Promise._getStack();
            }

            this._oncancel = oncancel;
            this._setState(state_created);
            this._run();

            try {
                var complete = this._completed.bind(this);
                var error = this._error.bind(this);
                var progress = this._progress.bind(this);
                init(complete, error, progress);
            } catch (ex) {
                this._setExceptionValue(ex);
            }
        }, {
            _oncancel: null,

            _cancelAction: function () {
                if (this._oncancel) {
                    try { this._oncancel(); } catch (ex) { }
                }
            },
            _cleanupAction: function () { this._oncancel = null; }
        }, {

            addEventListener: function Promise_addEventListener(eventType, listener, capture) {
                /// <signature helpKeyword="WinJS.Promise.addEventListener">
                /// <summary locid="WinJS.Promise.addEventListener">
                /// Adds an event listener to the control.
                /// </summary>
                /// <param name="eventType" locid="WinJS.Promise.addEventListener_p:eventType">
                /// The type (name) of the event.
                /// </param>
                /// <param name="listener" locid="WinJS.Promise.addEventListener_p:listener">
                /// The listener to invoke when the event is raised.
                /// </param>
                /// <param name="capture" locid="WinJS.Promise.addEventListener_p:capture">
                /// Specifies whether or not to initiate capture.
                /// </param>
                /// </signature>
                promiseEventListeners.addEventListener(eventType, listener, capture);
            },
            any: function Promise_any(values) {
                /// <signature helpKeyword="WinJS.Promise.any">
                /// <summary locid="WinJS.Promise.any">
                /// Returns a promise that is fulfilled when one of the input promises
                /// has been fulfilled.
                /// </summary>
                /// <param name="values" type="Array" locid="WinJS.Promise.any_p:values">
                /// An array that contains promise objects or objects whose property
                /// values include promise objects.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.any_returnValue">
                /// A promise that on fulfillment yields the value of the input (complete or error).
                /// </returns>
                /// </signature>
                return new Promise(
                    function (complete, error, progress) {
                        var keys = Object.keys(values);
                        var errors = Array.isArray(values) ? [] : {};
                        if (keys.length === 0) {
                            complete();
                        }
                        var canceled = 0;
                        keys.forEach(function (key) {
                            Promise.as(values[key]).then(
                                function () { complete({ key: key, value: values[key] }); },
                                function (e) {
                                    if (e instanceof Error && e.name === canceledName) {
                                        if ((++canceled) === keys.length) {
                                            complete(WinJS.Promise.cancel);
                                        }
                                        return;
                                    }
                                    error({ key: key, value: values[key] });
                                }
                            );
                        });
                    },
                    function () {
                        var keys = Object.keys(values);
                        keys.forEach(function (key) {
                            var promise = Promise.as(values[key]);
                            if (typeof promise.cancel === "function") {
                                promise.cancel();
                            }
                        });
                    }
                );
            },
            as: function Promise_as(value) {
                /// <signature helpKeyword="WinJS.Promise.as">
                /// <summary locid="WinJS.Promise.as">
                /// Returns a promise. If the object is already a promise it is returned;
                /// otherwise the object is wrapped in a promise.
                /// </summary>
                /// <param name="value" locid="WinJS.Promise.as_p:value">
                /// The value to be treated as a promise.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.as_returnValue">
                /// A promise.
                /// </returns>
                /// </signature>
                if (value && typeof value === "object" && typeof value.then === "function") {
                    return value;
                }
                return new CompletePromise(value);
            },
            /// <field type="WinJS.Promise" helpKeyword="WinJS.Promise.cancel" locid="WinJS.Promise.cancel">
            /// Canceled promise value, can be returned from a promise completion handler
            /// to indicate cancelation of the promise chain.
            /// </field>
            cancel: {
                get: function () {
                    return (staticCanceledPromise = staticCanceledPromise || new ErrorPromise(new WinJS.ErrorFromName(canceledName)));
                }
            },
            dispatchEvent: function Promise_dispatchEvent(eventType, details) {
                /// <signature helpKeyword="WinJS.Promise.dispatchEvent">
                /// <summary locid="WinJS.Promise.dispatchEvent">
                /// Raises an event of the specified type and properties.
                /// </summary>
                /// <param name="eventType" locid="WinJS.Promise.dispatchEvent_p:eventType">
                /// The type (name) of the event.
                /// </param>
                /// <param name="details" locid="WinJS.Promise.dispatchEvent_p:details">
                /// The set of additional properties to be attached to the event object.
                /// </param>
                /// <returns type="Boolean" locid="WinJS.Promise.dispatchEvent_returnValue">
                /// Specifies whether preventDefault was called on the event.
                /// </returns>
                /// </signature>
                return promiseEventListeners.dispatchEvent(eventType, details);
            },
            is: function Promise_is(value) {
                /// <signature helpKeyword="WinJS.Promise.is">
                /// <summary locid="WinJS.Promise.is">
                /// Determines whether a value fulfills the promise contract.
                /// </summary>
                /// <param name="value" locid="WinJS.Promise.is_p:value">
                /// A value that may be a promise.
                /// </param>
                /// <returns type="Boolean" locid="WinJS.Promise.is_returnValue">
                /// true if the specified value is a promise, otherwise false.
                /// </returns>
                /// </signature>
                return value && typeof value === "object" && typeof value.then === "function";
            },
            join: function Promise_join(values) {
                /// <signature helpKeyword="WinJS.Promise.join">
                /// <summary locid="WinJS.Promise.join">
                /// Creates a promise that is fulfilled when all the values are fulfilled.
                /// </summary>
                /// <param name="values" type="Object" locid="WinJS.Promise.join_p:values">
                /// An object whose fields contain values, some of which may be promises.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.join_returnValue">
                /// A promise whose value is an object with the same field names as those of the object in the values parameter, where
                /// each field value is the fulfilled value of a promise.
                /// </returns>
                /// </signature>
                return new Promise(
                    function (complete, error, progress) {
                        var keys = Object.keys(values);
                        var errors = Array.isArray(values) ? [] : {};
                        var results = Array.isArray(values) ? [] : {};
                        var undefineds = 0;
                        var pending = keys.length;
                        var argDone = function (key) {
                            if ((--pending) === 0) {
                                var errorCount = Object.keys(errors).length;
                                if (errorCount === 0) {
                                    complete(results);
                                } else {
                                    var canceledCount = 0;
                                    keys.forEach(function (key) {
                                        var e = errors[key];
                                        if (e instanceof Error && e.name === canceledName) {
                                            canceledCount++;
                                        }
                                    });
                                    if (canceledCount === errorCount) {
                                        complete(WinJS.Promise.cancel);
                                    } else {
                                        error(errors);
                                    }
                                }
                            } else {
                                progress({ Key: key, Done: true });
                            }
                        };
                        keys.forEach(function (key) {
                            var value = values[key];
                            if (value === undefined) {
                                undefineds++;
                            } else {
                                Promise.then(value,
                                    function (value) { results[key] = value; argDone(key); },
                                    function (value) { errors[key] = value; argDone(key); }
                                );
                            }
                        });
                        pending -= undefineds;
                        if (pending === 0) {
                            complete(results);
                            return;
                        }
                    },
                    function () {
                        Object.keys(values).forEach(function (key) {
                            var promise = Promise.as(values[key]);
                            if (typeof promise.cancel === "function") {
                                promise.cancel();
                            }
                        });
                    }
                );
            },
            removeEventListener: function Promise_removeEventListener(eventType, listener, capture) {
                /// <signature helpKeyword="WinJS.Promise.removeEventListener">
                /// <summary locid="WinJS.Promise.removeEventListener">
                /// Removes an event listener from the control.
                /// </summary>
                /// <param name='eventType' locid="WinJS.Promise.removeEventListener_eventType">
                /// The type (name) of the event.
                /// </param>
                /// <param name='listener' locid="WinJS.Promise.removeEventListener_listener">
                /// The listener to remove.
                /// </param>
                /// <param name='capture' locid="WinJS.Promise.removeEventListener_capture">
                /// Specifies whether or not to initiate capture.
                /// </param>
                /// </signature>
                promiseEventListeners.removeEventListener(eventType, listener, capture);
            },
            supportedForProcessing: false,
            then: function Promise_then(value, onComplete, onError, onProgress) {
                /// <signature helpKeyword="WinJS.Promise.then">
                /// <summary locid="WinJS.Promise.then">
                /// A static version of the promise instance method then().
                /// </summary>
                /// <param name="value" locid="WinJS.Promise.then_p:value">
                /// the value to be treated as a promise.
                /// </param>
                /// <param name="onComplete" type="Function" locid="WinJS.Promise.then_p:complete">
                /// The function to be called if the promise is fulfilled with a value.
                /// If it is null, the promise simply
                /// returns the value. The value is passed as the single argument.
                /// </param>
                /// <param name="onError" type="Function" optional="true" locid="WinJS.Promise.then_p:error">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument.
                /// </param>
                /// <param name="onProgress" type="Function" optional="true" locid="WinJS.Promise.then_p:progress">
                /// The function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.then_returnValue">
                /// A promise whose value is the result of executing the provided complete function.
                /// </returns>
                /// </signature>
                return Promise.as(value).then(onComplete, onError, onProgress);
            },
            thenEach: function Promise_thenEach(values, onComplete, onError, onProgress) {
                /// <signature helpKeyword="WinJS.Promise.thenEach">
                /// <summary locid="WinJS.Promise.thenEach">
                /// Performs an operation on all the input promises and returns a promise
                /// that has the shape of the input and contains the result of the operation
                /// that has been performed on each input.
                /// </summary>
                /// <param name="values" locid="WinJS.Promise.thenEach_p:values">
                /// A set of values (which could be either an array or an object) of which some or all are promises.
                /// </param>
                /// <param name="onComplete" type="Function" locid="WinJS.Promise.thenEach_p:complete">
                /// The function to be called if the promise is fulfilled with a value.
                /// If the value is null, the promise returns the value.
                /// The value is passed as the single argument.
                /// </param>
                /// <param name="onError" type="Function" optional="true" locid="WinJS.Promise.thenEach_p:error">
                /// The function to be called if the promise is fulfilled with an error. The error
                /// is passed as the single argument.
                /// </param>
                /// <param name="onProgress" type="Function" optional="true" locid="WinJS.Promise.thenEach_p:progress">
                /// The function to be called if the promise reports progress. Data about the progress
                /// is passed as the single argument. Promises are not required to support
                /// progress.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.thenEach_returnValue">
                /// A promise that is the result of calling Promise.join on the values parameter.
                /// </returns>
                /// </signature>
                var result = Array.isArray(values) ? [] : {};
                Object.keys(values).forEach(function (key) {
                    result[key] = Promise.as(values[key]).then(onComplete, onError, onProgress);
                });
                return Promise.join(result);
            },
            timeout: function Promise_timeout(time, promise) {
                /// <signature helpKeyword="WinJS.Promise.timeout">
                /// <summary locid="WinJS.Promise.timeout">
                /// Creates a promise that is fulfilled after a timeout.
                /// </summary>
                /// <param name="timeout" type="Number" optional="true" locid="WinJS.Promise.timeout_p:timeout">
                /// The timeout period in milliseconds. If this value is zero or not specified
                /// setImmediate is called, otherwise setTimeout is called.
                /// </param>
                /// <param name="promise" type="Promise" optional="true" locid="WinJS.Promise.timeout_p:promise">
                /// A promise that will be canceled if it doesn't complete before the
                /// timeout has expired.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.timeout_returnValue">
                /// A promise that is completed asynchronously after the specified timeout.
                /// </returns>
                /// </signature>
                var to = timeout(time);
                return promise ? timeoutWithPromise(to, promise) : to;
            },
            wrap: function Promise_wrap(value) {
                /// <signature helpKeyword="WinJS.Promise.wrap">
                /// <summary locid="WinJS.Promise.wrap">
                /// Wraps a non-promise value in a promise. You can use this function if you need
                /// to pass a value to a function that requires a promise.
                /// </summary>
                /// <param name="value" locid="WinJS.Promise.wrap_p:value">
                /// Some non-promise value to be wrapped in a promise.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.wrap_returnValue">
                /// A promise that is successfully fulfilled with the specified value
                /// </returns>
                /// </signature>
                return new CompletePromise(value);
            },
            wrapError: function Promise_wrapError(error) {
                /// <signature helpKeyword="WinJS.Promise.wrapError">
                /// <summary locid="WinJS.Promise.wrapError">
                /// Wraps a non-promise error value in a promise. You can use this function if you need
                /// to pass an error to a function that requires a promise.
                /// </summary>
                /// <param name="error" locid="WinJS.Promise.wrapError_p:error">
                /// A non-promise error value to be wrapped in a promise.
                /// </param>
                /// <returns type="WinJS.Promise" locid="WinJS.Promise.wrapError_returnValue">
                /// A promise that is in an error state with the specified value.
                /// </returns>
                /// </signature>
                return new ErrorPromise(error);
            },

            _veryExpensiveTagWithStack: {
                get: function () { return tagWithStack; },
                set: function (value) { tagWithStack = value; }
            },
            _veryExpensiveTagWithStack_tag: tag,
            _getStack: function () {
                try { throw new Error(); } catch (e) { return e.stack; }
            },

            _cancelBlocker: function Promise__cancelBlocker(input) {
                //
                // Returns a promise which on cancelation will still result in downstream cancelation while
                //  protecting the promise 'input' from being  canceled which has the effect of allowing 
                //  'input' to be shared amoung various consumers.
                //
                if (!Promise.is(input)) {
                    return Promise.wrap(input);
                }
                var complete;
                var error;
                var output = new WinJS.Promise(
                    function (c, e) {
                        complete = c;
                        error = e;
                    },
                    function () {
                        complete = null;
                        error = null;
                    }
                );
                input.then(
                    function (v) { complete && complete(v); },
                    function (e) { error && error(e); }
                );
                return output;
            },

        }
    );
    Object.defineProperties(Promise, WinJS.Utilities.createEventProperties(errorET));

    var SignalPromise = WinJS.Class.derive(PromiseStateMachine,
        function (cancel) {
            this._oncancel = cancel;
            this._setState(state_created);
            this._run();
        }, {
            _cancelAction: function () { this._oncancel && this._oncancel(); },
            _cleanupAction: function () { this._oncancel = null; }
        }, {
            supportedForProcessing: false
        }
    );

    var Signal = WinJS.Class.define(
        function Signal_ctor(oncancel) {
            this._promise = new SignalPromise(oncancel);
        }, {
            promise: {
                get: function () { return this._promise; }
            },

            cancel: function Signal_cancel() {
                this._promise.cancel();
            },
            complete: function Signal_complete(value) {
                this._promise._completed(value);
            },
            error: function Signal_error(value) {
                this._promise._error(value);
            },
            progress: function Signal_progress(value) {
                this._promise._progress(value);
            }
        }, {
            supportedForProcessing: false,
        }
    );

    // Publish WinJS.Promise
    //
    WinJS.Namespace.define("WinJS", {
        Promise: Promise,
        _Signal: Signal
    });

}(this));

 /***********************************************************
 * winjs-promise.js end
 **********************************************************/
//globalHolder.WinJS.Promise.all = globalHolder.WinJS.Promise.join;

 /***********************************************************
 * assign to global Class
 **********************************************************/
Promise = WinJS.Promise;
;var CoreUtilities;
(function (CoreUtilities) {
    // Contains utility functions that are common to Threshold clients - Cortana, Spartan OneBox etc.
    // Do not include client specfic code here.
    function deferFunction(functionPointer) {
        var originalArgs = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            originalArgs[_i - 1] = arguments[_i];
        }
        return deferMethod.apply(null, [null, functionPointer].concat(originalArgs));
    }
    CoreUtilities.deferFunction = deferFunction;
    function deferMethod(sourceObject, functionPointer) {
        var originalArgs = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            originalArgs[_i - 2] = arguments[_i];
        }
        return function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i - 0] = arguments[_i];
            }
            if (!args || args.length === 0) {
                args = originalArgs;
            }
            else {
                for (var i in originalArgs) {
                    if (originalArgs.hasOwnProperty(i)) {
                        args.push(originalArgs[i]);
                    }
                }
            }
            return functionPointer.apply(sourceObject, args);
        };
    }
    CoreUtilities.deferMethod = deferMethod;
    // gets a property out of an object. 
    // should be used in cases where object has a lot of layers of properties.
    // the arguments will be object, list of properties. 
    // it works recursively so it will keep calling itself with the current object and the rest of the properties.
    // e.g. var a = { b: { c: { d: "e" } } } to get to "e", you can call getProperty(a, b, c, d)
    // will return null if any of the layers don't have what was passed in (e. g. getProperty(a, b, d))
    function getProperty() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i - 0] = arguments[_i];
        }
        var currentState = args[0];
        for (var i = 1; i < args.length; i++) {
            if (currentState) {
                currentState = currentState[args[i]];
            }
            else {
                return null;
            }
        }
        return currentState;
    }
    CoreUtilities.getProperty = getProperty;
    // Legacy Support
    window["sj_df"] = deferFunction;
    window["sj_dm"] = deferMethod;
    window["sj_gp"] = getProperty;
})(CoreUtilities || (CoreUtilities = {}));
;/// <reference path="..\Declarations\Shared.d.ts"/>
/// <reference path="..\Declarations\Threshold.Utilities.d.ts"/>
var ThresholdDiagnosticsProd = (function () {
    function ThresholdDiagnosticsProd() {
        this.debugStrings = [];
        this.submitCallbackBound = false;
        sj_evt.bind("ajax.WindowsFeedback.Form.Shown", sj_dm(this, this.onFeedbackFormShown));
        sj_evt.bind("ajax.threshold.pageStart", sj_dm(this, this.clearDebugStrings));
    }
    ThresholdDiagnosticsProd.prototype.recordApiString = function (debugString) {
        console.log(debugString);
        this.debugStrings.push(debugString);
    };
    ThresholdDiagnosticsProd.prototype.clearDebugStrings = function () {
        this.debugStrings.length = 0;
    };
    ThresholdDiagnosticsProd.prototype.onFeedbackFormShown = function () {
        var form = _ge("fdbkfrm");
        if (form) {
            if (!this.submitCallbackBound) {
                var deferredSubmitCallback = sj_dm(this, this.onFeedbackFormSubmit, form);
                var formButtons = form.getElementsByClassName("fdbkactionbtns");
                if (formButtons && formButtons.length == 1) {
                    // onFeedbackFormSubmit is bound to a parent of the submit button (the div containing the submit/cancel buttons).
                    // It is bound with useCapture=true to ensure that a click on the submit button reaches our callback before the feedback 
                    // form's normal submission callback (which is bound to "click" on the button itself).
                    sj_be(formButtons[0], "click", deferredSubmitCallback, true);
                    this.submitCallbackBound = true;
                }
            }
        }
        else {
            // If the form is missing, a new method would need to be created and bound
            this.submitCallbackBound = false;
        }
    };
    ThresholdDiagnosticsProd.prototype.onFeedbackFormSubmit = function (event, form) {
        var apiDebug = "apiDebug";
        var pageDebug = _w["PageDebug"];
        var screenshotCheckbox = form.elements["screenshot"];
        // We assume that if there was no screenshot input element we didn't need the user's permission to get one
        if (!screenshotCheckbox || screenshotCheckbox.checked) {
            pageDebug[apiDebug] = this.debugStrings.toString();
        }
        else if (pageDebug[apiDebug]) {
            delete pageDebug[apiDebug];
        }
    };
    return ThresholdDiagnosticsProd;
})();
_w["ThresholdDiagnostics"] = new ThresholdDiagnosticsProd();
;
//]]></script><script type="text/javascript" src="/rms/rms%20answers%20Shared%20Threshold$Threshold.UtilitiesM2/nj/ebdb5391/c4a005fe.js"></script><script type="text/javascript">//<![CDATA[
// ------------------------------------------------------------------------------
// <copyright file="SearchAppAndroid.ts" company="Microsoft Corporation">
//     Copyright (c) Microsoft Corporation. All Rights Reserved.
//     Information Contained Herein is Proprietary and Confidential.
// </copyright>
// ------------------------------------------------------------------------------
/// <reference path="Declarations\CortanaSearch.d.ts" />
/// <reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Promise.Mock.d.ts" />
/// <reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Threshold.Utilities.d.ts" />
var WrapApi;
(function (WrapApi) {
    function completePromise(completionFunction) {
        if (WrapApi.AndroidReturnAsync) {
            // Set a timeout to finish resolution after the current call stack of execution finished.
            sb_st(function () { return completionFunction(); }, 0);
        }
        else {
            // To maintain current behavior, resolve synchronously.
            completionFunction();
        }
    }
    // This method clones an object while providing a wrapMethod bridges between one implementation of a function and another.
    // We use it to make sure the object we get back from Cortana API calls can fall back to our mock implementations if Cortana APIs fail or are not implemented.
    function wrapAndroidApi(cortanaObject) {
        if (cortanaObject) {
            // we don't implement the following as QF and device search are not part of CoA
            // searchResultsView: ISearchResultsView;
            // searchBox: ISearchBox;
            cortanaObject.isCortanaEnabled = cortanaObject.getIsCortanaEnabled();
            cortanaObject.isBingEnabled = cortanaObject.getIsBingEnabled();
            cortanaObject.isMobile = cortanaObject.getIsMobile();
            cortanaObject.region = cortanaObject.getRegion(); // The country code for the current region  
            cortanaObject.uiLanguage = cortanaObject.getUiLanguage(); // the language code for localized resources  
            cortanaObject.sessionId = cortanaObject.getSessionId(); // Logged in the Client to identify App open -> App close "sessions"  
            cortanaObject.impressionId = cortanaObject.getImpressionId(); // Produced by the client & logged by the server to identify each Keystroke  
            if (typeof cortanaObject.getCurrentState === 'function') {
                cortanaObject.currentState = cortanaObject.getCurrentState();
            }
            cortanaObject.launcher = cortanaObject.launcher || {
                launchUriAsync: function (uri, options) {
                    return new Promise(function (resolve, reject) {
                        var result = cortanaObject.launchUriSync(uri, options);
                        completePromise(function () { return resolve(result); });
                    });
                },
                launchRAFAsync: function (rawQuery, formCode) {
                    cortanaObject.launchRAFSync(rawQuery, formCode);
                },
                startPhoneCallAsync: function (phoneNumber, displayName) {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.startPhoneCallSync(phoneNumber, displayName);
                        completePromise(function () { return resolve(true); });
                    });
                },
                navigateReactiveViewAsync: function (rawQuery, formCode) {
                    return new Promise(function (resolve, reject) {
                        var result = false;
                        if (cortanaObject.navigateReactiveViewSync) {
                            result = cortanaObject.navigateReactiveViewSync(rawQuery, formCode);
                        }
                        completePromise(function () { return resolve(result); });
                    });
                }
            };
            cortanaObject.proactiveView = cortanaObject.proactiveView || {
                invalidateCacheAsync: function () {
                    return new Promise(function (resolve, reject) {
                        var result = false;
                        if (cortanaObject.invalidateCacheSync) {
                            result = cortanaObject.invalidateCacheSync();
                        }
                        completePromise(function () { return resolve(result); });
                    });
                },
                perfMetrics: {
                    lookup: function (perfMetricKey) {
                        var result = 0;
                        if (cortanaObject.perfMetricLookup) {
                            result = cortanaObject.perfMetricLookup(perfMetricKey);
                        }
                        return new Date(result);
                    }
                }
            };
            cortanaObject.getQueryHeadersAsync = function () {
                return new Promise(function (resolve, reject) {
                    var headerString = cortanaObject.getQueryHeadersSync();
                    var headers = JSON.parse(headerString);
                    completePromise(function () { return resolve(headers); });
                });
            };
            if (typeof cortanaObject.navigateWebViewSync === 'function') {
                cortanaObject.navigateWebViewAsync = function (uri) {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.navigateWebViewSync(uri);
                        completePromise(function () { return resolve(true); });
                    });
                };
            }
            cortanaObject.navigateWebViewWithPostAsync = function (uri, parameters) {
                return new Promise(function (resolve, reject) {
                    var postDataStringified = JSON.stringify(parameters);
                    cortanaObject.navigateWebViewWithPostSync(uri, postDataStringified);
                    completePromise(function () { return resolve(true); });
                });
            };
            cortanaObject.navigateWebViewBackAsync = function (frameCount) {
                return new Promise(function (resolve, reject) {
                    cortanaObject.navigateWebViewBackSync(frameCount);
                    completePromise(function () { return resolve(true); });
                });
            };
            cortanaObject.showWebViewAsync = function () {
                return new Promise(function (resolve, reject) {
                    cortanaObject.showWebViewSync();
                    completePromise(function () { return resolve(true); });
                });
            };
            cortanaObject.launchExperienceByName = function (experienceName, parameters) {
                var experienceDataStringified = JSON.stringify(parameters);
                cortanaObject.launchExperienceByNameSync(experienceName, experienceDataStringified);
            };
            var eventListenerMap = {};
            function triggerElement(element, index, array) {
                element();
            }
            ;
            cortanaObject.addEventListener = function (eventName, cb) {
                if (eventListenerMap[eventName] === undefined) {
                    eventListenerMap[eventName] = [];
                }
                eventListenerMap[eventName].push(cb);
            };
            cortanaObject.triggerEventListener = function (eventName) {
                if (eventListenerMap[eventName] !== undefined) {
                    eventListenerMap[eventName].forEach(triggerElement);
                }
            };
            function doneablePromise(fn) {
                var promise = new Promise(fn);
                if (typeof Promise.prototype.done !== 'function') {
                    promise.done = function (onFulfilled, onRejected) {
                        promise.then(onFulfilled, onRejected);
                    };
                }
                return promise;
            }
            var Screenshot = function (fileName, content, type) {
                this.fileName = fileName;
                this.contentType = type;
                var base64Content = content;
                this.getBase64ContentAsync = function () {
                    return doneablePromise(function (resolve, reject) {
                        completePromise(function () { return resolve(base64Content); });
                    });
                };
            };
            cortanaObject.getFeedbackFilesAsync = function () {
                return doneablePromise(function (resolve, reject) {
                    var data = JSON.parse(cortanaObject.getFeedbackFilesSync());
                    if (!data) {
                        completePromise(function () { return reject("Get feedback files failed."); });
                        return;
                    }
                    var screenshots = data.screenshots;
                    var files = {};
                    var i = 0;
                    var iLength = 0;
                    if (screenshots && screenshots.length > 0) {
                        for (i = 0, iLength = screenshots.length; i < iLength; i++) {
                            files[i] = new Screenshot(screenshots[i].fileName, screenshots[i].content, screenshots[i].type);
                        }
                    }
                    files['size'] = iLength;
                    completePromise(function () { return resolve(files); });
                });
            };
            //TFS 5227831: [CoA] In order to support proactive peek, implement cortanaApp.logMeasure() and cortanaApp.setNonAnimatingCortanaText()
            cortanaObject.logMeasure = function () {
            };
            cortanaObject.setNonAnimatingCortanaText = function () {
            };
            cortanaObject.processNLCommandAsync = function (commandTaskFrame, impressionId) {
                return new Promise(function (resolve, reject) {
                    var result = cortanaObject.processNLCommandSync(commandTaskFrame, impressionId);
                    completePromise(function () { return resolve(result); });
                });
            };
            cortanaObject.searchResultsView = {};
            cortanaObject.searchResultsView.executeSearchAsync = function (query) {
                return new Promise(function (resolve, reject) {
                    var result = cortanaObject.executeSearchSync(query);
                    completePromise(function () { return resolve(result); });
                });
            };
            cortanaObject.searchResultsView.deviceSearch = {};
            cortanaObject.searchResultsView.deviceSearch.findAppsAsync = function (appIds, impressionId) {
                return new Promise(function (resolve, reject) {
                    var appMapString = cortanaObject.findAppsSync(appIds, impressionId);
                    var appMap;
                    if (appMapString) {
                        try {
                            appMap = JSON.parse(appMapString);
                        }
                        catch (e) {
                            alert(e);
                        }
                    }
                    completePromise(function () { return resolve(appMap); });
                });
            };
            // SPA - Potable Cortana
            var spaEventListenerMap = {};
            cortanaObject.spaDialogRuntime = cortanaObject.spaDialogRuntime || {
                // NL APIs
                // Doing
                startLanguageUnderstandingFromVoiceAsync: function (cuInput) {
                    return new Promise(function (resolve, reject) {
                        var result = cortanaObject.startLanguageUnderstandingFromVoiceSync(cuInput);
                        completePromise(function () { return resolve(result); });
                    });
                },
                startDictationAsync: function (cuInput) {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.startDictationSync(cuInput);
                        completePromise(function () { return resolve(true); });
                    });
                },
                endpointAudio: function (operationId) {
                    cortanaObject.endpointAudio(operationId);
                },
                dialogComplete: function (completionState) {
                    cortanaObject.dialogComplete(completionState);
                },
                // TTS APIs
                playEarconAsync: function (earConType) {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.playEarconSync(earConType);
                        completePromise(function () { return resolve(true); });
                    });
                },
                // 
                speakAsync: function (ssmlData) {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.speakSync(ssmlData);
                        completePromise(function () { return resolve(true); });
                    });
                },
                // 
                stopSpeakingAsync: function () {
                    return new Promise(function (resolve, reject) {
                        cortanaObject.stopSpeakingSync();
                        completePromise(function () { return resolve(true); });
                    });
                },
                // UI update APIs
                // 
                updateTrex: function (trexText) {
                    cortanaObject.updateTrex(trexText);
                },
                // 
                updateGui: function (uiState) {
                    cortanaObject.updateGui(uiState);
                },
                changeSticMode: function (isEnabled) {
                    cortanaObject.changeSticMode(isEnabled);
                },
                changeSticStateAndInputMode: function (spaSticState, spaSticInputMode) {
                    cortanaObject.changeSticStateAndInputMode(spaSticState, spaSticInputMode);
                },
                addEventListener: function (eventName, handler) {
                    if (!eventName) {
                        return;
                    }
                    eventName = eventName.toLowerCase();
                    if (spaEventListenerMap[eventName]) {
                        return;
                    }
                    spaEventListenerMap[eventName] = handler;
                    cortanaObject.registerEventListener(eventName, "CortanaApp.spaDialogRuntime.triggerEventListener");
                },
                triggerEventListener: function (eventName, params) {
                    if (!eventName) {
                        return;
                    }
                    eventName = eventName.toLowerCase();
                    var eventHandler = spaEventListenerMap[eventName];
                    if (!eventHandler) {
                        return;
                    }
                    var jsonParams = {};
                    try {
                        jsonParams = JSON.parse(params);
                    }
                    catch (e) {
                    }
                    if (typeof eventHandler === 'function') {
                        eventHandler.call(null, jsonParams);
                    }
                },
                removeEventListener: function (eventName, handler) {
                    if (!eventName) {
                        return;
                    }
                    eventName = eventName.toLowerCase();
                    if (!spaEventListenerMap[eventName]) {
                        return;
                    }
                    delete spaEventListenerMap[eventName];
                    cortanaObject.removeEventListener(eventName);
                }
            };
            return cortanaObject;
        }
    }
    WrapApi.wrapAndroidApi = wrapAndroidApi;
})(WrapApi || (WrapApi = {}));
var SearchAppWrapper = {
    CortanaApp: (_w['CortanaApp'] ? WrapApi.wrapAndroidApi(_w['CortanaApp']) : _w['MockCortanaAppInstance'])
};
;///<reference path="..\Declarations\Shared.d.ts"/>
var sj_b = _d.body;
;///<reference path="queue.ts"/>
BM.trigger();
;_G.AppVer="8_1_2_4917958";
//]]></script><script type="text/javascript">//<![CDATA[
_G.FCT=new Date;
//]]></script><script type="text/javascript">//<![CDATA[
_G.BCT=new Date;
//]]></script><style type="text/css">/*
    Use the javascipt methods in Animation.ts to toggle the animation instead of directly setting the class.      
        
    b_slide - Use this class when an element may slide up/down via animation.  Used by toggleSlide in Animation.ts.
    b_fade - Use this class when an element may fade in/out via animation. Upon completion of animation, element will completely disappear and occupies no space in view. Used by toggleFade in Animation.ts
    b_fadeUp - Use this class when an element may fade up/down via animation. Upon completion of animation, element will completely disappear and occupies no space in view. Used by toggleFadeUp in Animation.ts
    b_slideListUp - Use this class to animate a list of items slide up from bottom and arrive at destination one by one. Used by cascadeList in Animation.ts
    b_anim - Use this class when an element may show/hide via animation.     
    Animate by toggling the b_hide class. We override the default behavior of b_hide here.
*/

.b_fade,
.b_slide,
.b_anim,
.b_fadeUp,
.b_slideListHide,
.b_slideTranslate {
  overflow: hidden;
}
.b_fade.b_hide,
.b_slide.b_hide,
.b_slideTranslate.b_hide,
.b_anim.b_hide,
.b_fadeUp.b_hide,
.b_slideListHide {
  display: block;
  /* Needs to be important to override the values from other classes */
  padding-top/* bingcss-ignore */: 0 !important;
  padding-bottom/* bingcss-ignore */: 0 !important;
  margin-top/* bingcss-ignore */: 0 !important;
  margin-bottom/* bingcss-ignore */: 0 !important;
  border-top/* bingcss-ignore */: 0 !important;
  border-bottom/* bingcss-ignore */: 0 !important;
}
.b_slide.b_hide,
.b_anim.b_hide,
.b_slideListHide {
  /* Needs to be important to override the values from other classes */
  height/* bingcss-ignore */: 0 !important;
}
/* slide up/down the element with fixed/known height */

.b_anim {
  -webkit-transition: all 250ms;
  -moz-transition: all 250ms;
  -o-transition: all 250ms;
  transition: all 250ms;
}
/* fade out the element and makes sure no space is occupied upon completion*/

.b_fade {
  opacity: 1;
  max-height: 9999px;
  /* open up the container first, then fade in the content*/
  -webkit-transition: opacity linear 250ms, max-height linear 0ms 0ms;
  -moz-transition: opacity linear 250ms, max-height linear 0ms 0ms;
  -o-transition: opacity linear 250ms, max-height linear 0ms 0ms;
  transition: opacity linear 250ms, max-height linear 0ms 0ms;
}
.b_fade.b_hide {
  opacity: 0;
  max-height: 0;
  /* fade out the content first, then collapse the container*/
  -webkit-transition: opacity linear 250ms, max-height linear 0ms 250ms;
  -moz-transition: opacity linear 250ms, max-height linear 0ms 250ms;
  -o-transition: opacity linear 250ms, max-height linear 0ms 250ms;
  transition: opacity linear 250ms, max-height linear 0ms 250ms;
}
/* fade up the element and makes sure no space is occupied upon completion.  This is usually used for text animation*/

.b_fadeUp {
  opacity: 1;
  max-height: 9999px;
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -o-transform: translateY(0);
  transform: translateY(0);
  -webkit-transition: opacity linear 170ms, -webkit-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms;
  -moz-transition: opacity linear 170ms, -moz-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms;
  -o-transition: opacity linear 170ms, -o-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms;
  transition: opacity linear 170ms, transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms;
}
.b_fadeUp.b_hide {
  opacity: 0;
  max-height: 0;
  -webkit-transform: translateY(10px);
  -moz-transform: translateY(10px);
  -o-transform: translateY(10px);
  transform: translateY(10px);
  -webkit-transition: opacity linear 170ms, -webkit-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms 500ms;
  -moz-transition: opacity linear 170ms, -moz-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms 500ms;
  -o-transition: opacity linear 170ms, -o-transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms 500ms;
  transition: opacity linear 170ms, transform cubic-bezier(0.15, 0.85, 0.35, 1) 500ms, max-height linear 0ms 500ms;
}
/* slide up/down the element */

.b_slide,
.b_slide.b_hide {
  -webkit-transition: height cubic-bezier(0.15, 0.85, 0.35, 1) 250ms;
  -moz-transition: height cubic-bezier(0.15, 0.85, 0.35, 1) 250ms;
  -o-transition: height cubic-bezier(0.15, 0.85, 0.35, 1) 250ms;
  transition: height cubic-bezier(0.15, 0.85, 0.35, 1) 250ms;
}
.b_slideTranslate {
  max-height: 9999px;
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -o-transform: translateY(0);
  transform: translateY(0);
  -webkit-transition: -webkit-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 0ms;
  -moz-transition: -moz-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 0ms;
  -o-transition: -o-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 0ms;
  transition: transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 0ms;
}
.b_slideTranslate.b_hide {
  max-height: 0;
  -webkit-transform: translateY(-200px);
  -moz-transform: translateY(-200px);
  -o-transform: translateY(-200px);
  transform: translateY(-200px);
  -webkit-transition: -webkit-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 250ms;
  -moz-transition: -moz-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 250ms;
  -o-transition: -o-transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 250ms;
  transition: transform cubic-bezier(0.15, 0.85, 0.35, 1) 250ms, max-height linear 0ms 250ms;
}
.b_fadeAnim {
  -webkit-animation: fadeAnim linear 330ms;
  -moz-animation: fadeAnim linear 330ms;
  -o-animation: fadeAnim linear 330ms;
  animation: fadeAnim linear 330ms;
}
/* slide up a list of items from below the viewport into the canvas. Starting translations will be set in Animation.ts.
   Items will arrive one by one, starting from the top. */

.b_slideListHide > li {
  opacity: 0;
}
.b_slideUp.b_slideListHide {
  opacity: 0;
  -webkit-transform: translateY(200px);
  -moz-transform: translateY(200px);
  -o-transform: translateY(200px);
  transform: translateY(200px);
}
.b_slideUp:not(.b_slideListHide),
.b_slideListUp:not(.b_slideListHide) {
  opacity: 1;
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -o-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  -webkit-transition: -webkit-transform cubic-bezier(0.15, 0.85, 0.35, 1) 400ms, opacity linear 250ms;
  -moz-transition: -moz-transform cubic-bezier(0.15, 0.85, 0.35, 1) 400ms, opacity linear 250ms;
  -o-transition: -o-transform cubic-bezier(0.15, 0.85, 0.35, 1) 400ms, opacity linear 250ms;
  transition: transform cubic-bezier(0.15, 0.85, 0.35, 1) 400ms, opacity linear 250ms;
}
/* Keyframes animation */

@keyframes fadeAnim {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeAnim {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-moz-keyframes fadeAnim {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-o-keyframes fadeAnim {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
.bucket:disabled
{
    border-width: 1px;
    border-color: Aqua;
}

.bucket:disabled:Hover
{
	border-width: 2px;
	border-color: ChromeHigh;
}

.bucket:disabled:focus
{
	border-width: 1px;
	border-color: Aqua;
	background-color: AltMediumLow;
}

.bucket:active
{
	border-width: 2px;
	border-color: Aqua;
}

.bucket:active:Hover
{
	border-width: 2px;
	border-color: ChromeHigh;
	background-color: Aqua;
}

.bucket:active:focus
{
	background-color: Aqua;
	opacity: 0.7;
}

.bucket[contenteditable]:empty::before
{
    content: attr(data-content);
    color:gray;
}

.srmt
{
	float: bottom;
	margin-bottom: 224px;
}

.vt
{
	float:right;
}

#tail1 {
    position:absolute;
    bottom:-20px;
    right:20px;
    width:0;height:0;
    border-color:#a0c7ff transparent transparent transparent;
    border-width:6px;
    border-style:solid;
}

#tail2 {
    position:absolute;
    bottom:-18px;
    right:20px;
    width:0;height:0;
    border-color:#f9f9f9 transparent transparent transparent;
    border-width:6px;
    border-style:solid;
}

#remindTitle, #remindDate, #remindTime{
    margin-bottom: 1px;
}

#remindTitle 
{
    display: inline-block;
    border: solid 1px rgb(187, 187, 187);
    word-break: break-word;
    line-height: 41px;
    margin-top: 5px;
}

#remindOccurrences{
    width: auto;
    overflow: hidden;
}

#remindTitle, #remindDate, #remindTime{
    font-size: 24pt;
    padding-left: 4px;
    padding-right: 4px;
    padding-bottom: 4px;
}/*This file is intentionally left empty*/
.imse 
{
    
}/* Do nothing. */

z {
  a: 1;
}
p > .news_dt {
  color: #737373;
}
.sb_doct_txt {
  color: #3366bb;
  font-size: 11px;
  line-height: 22px;
  margin-right: 3px;
}
.mb_doct_txt {
  color: #737373;
}
.b_vList > li.b_annooverride {
  padding-bottom: 0;
}
.sa_uc{clear:both;padding:0 0 10px}.sa_uc:after{clear:both;content:'.';display:block;height:0;visibility:hidden}.sb_meta cite a,.sb_meta cite a:visited{color:#388222}.b_factrownosep {
  margin-left: -4px;
}
.b_factrownosep > li {
  color/* bingcss-ignore: algo fact row experience  */: #666666;
  font-family: 'Segoe UI', Arial, Helvetica, Sans-Serif;
  display: inline;
}
.b_factrownosep > li:not(.b_sritem) {
  background-color/* bingcss-ignore: algo fact row experience  */: #f9f9f9;
  padding/* bingcss-ignore: padding text inside the fact row */: 1px 4px;
  margin: 1px 0;
}
.b_factrownosep > li.b_sritem {
  font-weight: bold;
  padding-left: 4px;
}
.b_factrownosep > li.b_sritem .csrc {
  margin-left: 5px;
}
.b_factrownosep > li:not(:last-child) {
  margin-right: 8px;
}
.b_factrownosep {
  margin-bottom: 2px;
}
.b_sritem .csrc {
  padding-right: 0;
  padding-top/* bingcss-ignore: padding star icon inside the fact row */: 1px;
  vertical-align: top;
}
#b_results .b_factrownosep > li a,
#b_results .b_factrownosep > li a:visited {
  color: #1020d0;
}
.b_sritem.b_srtxtstarcolor {
  color/* bingcss-ignore: algo fact row experience */: #f94f2a;
}
.b_factrow,
.b_factrownosep
{
    display: -webkit-box;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
}

.b_factrow > li
{
    display: inline;
}

.b_factrownosep > li
{
    display: inline-block;
    /* this is needed to compensate the fact that tailing space of separator is trimmed of for inline-block */
    margin-right: 4px;
}.b_capmedia
{
    padding-top: 3px;
}

.b_capmedia p
{
    -webkit-line-clamp: 4;
}
.wr_cm{padding-left:118px;clear:left}.wr_cm .sa_cm{float:left;margin:1px 0 0 -119px;*padding-bottom:7px;_display:inline;width:108px;border:1px solid transparent;_border-color:#fff}.wr_cm:after{clear:both;content:'.';display:block;height:0;visibility:hidden}.wr_cm .b_factrow,.wr_cm .b_factrownosep{-webkit-line-clamp:3}.vt_con{position:relative}.vt_con .vt_tl{display:-moz-inline-stack;display:inline-block;position:relative;border:1px solid #525051;margin:1px;background:#000;text-align:center}.vt_vsm{width:100%;display:none;position:absolute;top:15px;left:0;color:#fff;text-decoration:underline;cursor:pointer}.vt_tl:hover{text-decoration:none}a:hover .vt_vsm{display:inline}a:hover .vt_vsp{display:none}.vt_vsp{position:absolute;bottom:0;right:0;height:20px;width:20px}.vt_pl{background-image:url("/s/a/mm_pl.png");background-repeat:no-repeat}.vt_vp,.vt_vph{position:absolute;width:100%;height:100%;cursor:pointer;z-index:1;padding:2px;top:-2px;left:-2px;_padding:0;_top:0;_left:0}.vt_stl:hover img,.vt_vph{opacity:.5;filter:alpha(opacity=50)}.vt_vph{background:#000 url(/fd/s/mm/vld.gif) no-repeat center center}.vt_con object{width:100%;height:100%}.vtbb{border:1px solid #04c;padding:1px}.vtbb a.vt_tl{margin:0}.vtv2{border:1px solid transparent;_border:0;position:relative;margin:3px 0 6px 0;display:inline-block;*zoom:1;*display:inline}.vtv2:hover{border:1px solid #36b;z-index:1}.vtv2 a{border:1px solid #ccc;display:block;text-decoration:none}.vtv2 a:hover{border-color:#fff;background-color:#000}.vtv2 a:hover img{opacity:.35;filter:alpha(opacity=35)}.mask{width:100%;height:100%}.vtv2 a:hover .mask{background-color:#000;opacity:.65;filter:alpha(opacity=65)}.vthv{display:none;position:absolute;left:0;top:13px;width:100%;cursor:pointer;color:#fff;font-size:13px;text-align:center;text-decoration:underline}.vthv span{margin:2px}a:hover .vthv{display:inline}.vtmu,.vtpl{position:absolute;bottom:1px;left:1px;width:20px;height:20px;cursor:pointer;background:url(/fd/s/mm1.png)}.vtmu{background-position:-67px -44px}.vtpl{background-position:-45px -44px}.irhc .vt_tl{text-align:center}.irhc .vt_vsm{display:inline;color:#fff;background:#000}.irhc .vt_tl img{left:0}.vt_con{position:relative}.vt_con .vt4{width:104px;height:58px}.vt_con .vt4 .vt_vsm{top:10px}.irhc{padding:10px;background:#fff;border:1px solid #000;position:absolute;text-decoration:none;color:#000;z-index:1002}.irhc span{display:block;position:relative}.irhc img{display:block;position:absolute;top:0}.irhld{width:30px;height:30px;z-index:-1}.irhcs{margin-top:10px}.irhcs span{display:block;width:100%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.irhcs1{font-weight:bold}.irhcs2{color:#898994}.irhcs3{color:#568e1a}.vt_text{position:absolute;bottom:2px;left:0;background:transparent}.vt_text .b_lLeft{margin-right:1px;position:relative;display:inline-block;height:20px;line-height:20px;padding:0 4px;top:2px;background:#000;background:rgba(0,0,0,.7)}.b_caption .vt_text .b_lLeft{top:1px;left:1px}.vt_text .plc{width:15px;color:transparent;text-align:center}.vtv2 a:hover .vt_text,.vt_tl:hover .vt_text{display:none;background:transparent}#vidans2 {
  margin-top/*bingcss-ignore*/: -10px;
}
#vidans2 .vidr {
  position: relative;
  height: auto;
  width: 100%;
  padding/*bingcss-ignore*/: 3px 0;
  border-top: 1px solid #eeeeee;
  background-color: white;
}
#vidans2 .vidr:last-child {
  border-bottom: 1px solid #eeeeee;
}
#vidans2 .vidr.idx2 {
  margin-bottom: 0;
}
#vidans2 .vidr .videoThumb {
  position: relative;
  float: left;
  margin-right: 10px;
}
#vidans2 .vidr > a {
  margin-left: 131px;
  height: 74px;
}
#vidans2 .vidrc.stitched .vidr > a {
  margin-left: 120px;
  height: 68px;
}
#vidans2 .vidr .videoDetail {
  padding/*bingcss-ignore*/: 10px;
}
#vidans2 .vidr .videoDetail .si {
  position: absolute;
  bottom: 6px;
}
#vidans2 .vidrc.stitched .vidr .videoDetail .si {
  left: initial;
}
#vidans2 .vidr .videoTitle {
  color: #1020d0;
  margin-bottom: 3px;
  line-height: 17px;
  overflow: hidden;
}
#vidans2 .vidr cite.videoSource {
  display: inline-block;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  max-width: 100%;
  bottom: 0;
  position: absolute;
  padding-left: 20px;
  left: 10px;
  right: 60px;
  color: #008900;
}
#vidans2 .vidrc.stitched .vidr cite.videoSource {
  right: 10px;
}
#vidans2 .vidr cite.noIcon {
  padding-left: 0;
}
#vidans2 .vidr cite.noPreview {
  padding-right: 0;
}
#vidans2 .vtv2 {
  margin: 0;
  font-size: 11px;
  font-family: HelveticaNeue, Roboto, Arial, sans-serif;
}
#vidans2 .vtv2 a.vt3b {
  width: 100%;
  height: 74px;
}
#vidans2 .vtv2 a.vtst {
  width: 120px;
  height: 68px;
}
.vidr .vtv2:hover {
  border: 0;
}
#vidans2 .vidr a:hover .VideoAnswer.MM_Mask,
#vidans2 .vidr a:hover .VideoAnswer.MM_MaskText {
  display: block;
}
#vidans2 .vidr .vtv2 .b_lLeft.vidPaid {
  padding/*bingcss-ignore*/: 4px 0;
  top: 2px;
}
#vidans2 .vidr .vtv2 .b_lLeft.vidPaid img {
  margin-bottom: -6px;
}
.vtv2 > a > .vt_text > .b_lLeft {
  display: initial;
  padding/*bingcss-ignore*/: 4px;
  color: white;
}
#vidans2 .ans3 {
  position: relative;
  margin-bottom: -2px;
}
.vidr {
  float: left;
  width: 172px;
  height: 147px;
  background-color: #eeeeee;
  margin: 0 1px 1px 0;
}
.vidr.idx2 {
  margin-bottom: 12px;
}
.vidr:last-child {
  margin-bottom: 5px;
}
.vidr > .b_lLeft {
  padding-bottom: 10px;
  padding-right: 10px;
  line-height: 15px;
}
.vidr a {
  position: relative;
  display: block;
  text-decoration: none;
}
.vidr a:hover {
  text-decoration: none;
}
.vidr cite {
  color: #444444;
}
.vid2 .vidr {
  overflow: hidden;
}
.vid2s .vidr {
  height: 104px;
}
.vidr .vtv2 {
  border: 0;
}
.vidr .vtv2 a {
  border: 0;
  height: 97px;
  width: 172px;
}
.vidr .vtv2 a:hover {
  border-color: white;
  background-color: white;
}
.vidr .vtv2 a .vthv {
  top: 39px;
}
.vidr a:hover .VideoAnswer.MM_Mask,
.vidr a:hover .VideoAnswer.MM_MaskText {
  display: none;
}
.vidr a .videoInfoPanel .pubInfo {
  padding/*bingcss-ignore*/: 1px 4px 4px 4px;
  color: #404040;
  line-height: normal;
}
.vidr a .videoInfoPanel .mtc {
  position: absolute;
  width: 162px;
  top: 29px;
  color: #404040;
  padding-left: 3px;
}
.vidr a .videoInfoPanel .mtc > .mti,
.vidr a .videoInfoPanel .mtc > .mt {
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}
.vidr a .videoInfoPanel .mtc > .rms_img {
  float: left;
  margin-right: 3px;
}
.vidr a .videoInfoPanel .ib {
  position: relative;
  display: inline-block;
  margin-right: 4px;
  top: -1px;
}
.vidr a .videoInfoPanel .ib .pl {
  background: url('/s/mm2.png') -31px -54px;
  height: 8px;
  width: 7px;
  display: inline-block;
}
.vidr a .videoInfoPanel .ib .ple {
  background: url('/s/mm2.png') -31px -44px;
  height: 8px;
  width: 12px;
  display: inline-block;
}
.vidrc > .tct > a {
  width: 129px;
  height: 62px;
  display: block;
  position: relative;
  z-index: 1;
}
.vidrc > .tct > a > .title {
  margin-bottom: 10px;
  padding-right: 10px;
  height: 30px;
  overflow: hidden;
}
.vidrc > .tct > .b_1linetrunc {
  position: relative;
  top: -22px;
  padding-bottom: 0;
}
.videoPreview {
  display: table-cell;
  cursor: pointer;
  position: absolute;
  color: #1020d0;
  right: 5px;
  bottom: 5px;
  max-width: 60px;
  text-overflow: ellipsis;
  overflow: hidden;
  font-size: 11px;
  white-space: nowrap;
}
.vt_con{position:relative}.vt_con .vt3b{width:131px;height:74px}.rms_rmsanswersMultimediaVideoAnswer_Bundle{background-image:url(/rms/VideoAnswer_Bundle/c/34bc16aa/8889123d.png?bu=rms+answers+Multimedia+videoanswer_play%2cvideoanswer_externalplay);display:inline-block;background-repeat:no-repeat;}.rms_rmsanswersMultimediaVideoAnswer_Play{height:8px;width:7px;}.mobilevideoitemtitle_mmftb{width:100%;max-width:100%;height:34px;position:relative;overflow:hidden;word-wrap: break-word;word-break:normal;}.mobilevideoitemtitle_mmftb:after{content:"";bottom: 0;right: 0;width: 50px;height: 17px;;position: absolute;}.mobilevideoitemtitle_mmftb:after{background: -webkit-linear-gradient(left, rgba(255,255,255,0),rgba(255,255,255,100));background: -moz-linear-gradient(to right,rgba(255,255,255,0),rgba(255,255,255,100));background: -o-linear-gradient(to right, rgba(255,255,255,0),rgba(255,255,255,100));background: -ms-linear-gradient(to right, rgba(255,255,255,0),rgba(255,255,255,100));background: linear-gradient(to right, rgba(255,255,255,0),rgba(255,255,255,100));}.rms_rmsanswersMultimediaVideoAnswer_ExternalPlay{height:8px;width:13px;background-position:-8px 0;}a{a:1}.sb_pag {
  padding: 0;
  margin: 0;
  width: 100%;
}
.sb_pag span {
  margin: 0;
  padding: 0;
  float: left;
  width: 14.24%;
}
.sb_pag a {
  float: left;
  cursor: pointer;
  text-decoration: none;
  padding/*bingcss-ignore: we aren't stacking elements vertically, so top padding should be OK'*/: 5px 11px;
  margin: 0 6px 0 0;
  text-align: center;
  font-size: 16px;
}
a.sb_pagP,
a.sb_pagN {
  padding/*bingcss-ignore: same as above, with a slight change due to us using a sprite sheet for content in place of numbers*/: 5px 8px;
  border: none;
  text-decoration: none;
  font-weight: bold;
  white-space: nowrap;
}
a.sb_pagS {
  background: #ededed;
  border: 1px solid #c8c8c8;
  font-weight: bold;
  color: #333333;
}
a.sb_pagP {
  margin-right: 11px;
  padding-left: 0;
}
</style><script type="text/javascript">//<![CDATA[
///<reference path="..\Declarations\Shared.d.ts" />
///<reference path="..\Declarations\CssClass.d.ts" />
var Animation;
(function (Animation) {
    var toggleClass = "b_hide";
    // this list need to be kept in sync so that all animations are cleared in toggleHide
    var animClasses = ["b_slideListUp", "b_slide", "b_fade", "b_fadeUp"];
    var elementLogMap = {};
    var curElementKey = 0;
    // these variables keep track of vendor-prefixed css/events
    var transitionEndEvent = "transitionend";
    var transformCss = "transform";
    var vendorEndEvents = {
        o: "oTransitionEnd",
        moz: "transitionend",
        webkit: "webkitTransitionEnd"
    };
    function IsElementHidden(ele) {
        return Lib.CssClass.contains(ele, "b_hide") || getComputedStyle(ele, null).display === "none";
    }
    function setVendorTransitionPrefix() {
        if ("transition" in _d.documentElement.style) {
            return;
        }
        for (var prefix in vendorEndEvents) {
            var cssPrefix = "-" + prefix + "-";
            if (cssPrefix + "transition" in _d.documentElement.style) {
                transitionEndEvent = vendorEndEvents[prefix];
            }
        }
    }
    function setVendorCssPrefix() {
        if ("transform" in _d.documentElement.style) {
            return;
        }
        for (var prefix in vendorEndEvents) {
            var prefixedCss = "-" + prefix + "-" + "transform";
            if (prefixedCss in _d.documentElement.style) {
                transformCss = prefixedCss;
            }
        }
    }
    function setVendorPrefix() {
        setVendorTransitionPrefix();
        setVendorCssPrefix();
    }
    function updateLogEnd(htmlElement) {
        if (htmlElement["AnimationKey"]) {
            var logData = elementLogMap[htmlElement["AnimationKey"]];
            logData.endTime = Date.now();
            if (_w["Log2"]) {
                Log2.LogEvent("ClientInst", { "T": "AnimationTiming", "startTime": logData.startTime, "endTime": logData.endTime, "AnimationName": logData.animationName }, null, null, null, null, null, null);
            }
        }
    }
    function updateLogStart(htmlElement, animation) {
        curElementKey += 1;
        htmlElement["AnimationKey"] = curElementKey;
        elementLogMap[curElementKey] = { startTime: Date.now(), endTime: -1, animationName: animation };
    }
    function cascadeListOld(list) {
        if (!list || !list.children || list.children.length == 0) {
            return;
        }
        var startingOffset = _w.innerHeight;
        list.style[transformCss] = "translateY(" + startingOffset + "px)";
        toggleAnimClass(list, "b_slideListUp");
        Lib.CssClass.remove(list, "b_slideListHide");
        list.style[transformCss] = "";
        var lastAnimatedItem = list.children[list.children.length - 1];
        if (lastAnimatedItem) {
            sj_be(lastAnimatedItem, transitionEndEvent, function (evt) {
                if (evt.target === lastAnimatedItem && evt.propertyName === transformCss) {
                    updateLogEnd(list);
                    for (var i = 0; i < list.children.length; i++) {
                        var item = list.children[i];
                        item.style[transformCss] = "";
                    }
                }
            });
            updateLogStart(list, "cascadeListOld");
        }
    }
    Animation.cascadeListOld = cascadeListOld;
    function cascadeList(list) {
        if (!list || !list.children || list.children.length == 0) {
            return;
        }
        var startingOffset = 200;
        list.style[transformCss] = "translateY(" + startingOffset + "px)";
        toggleAnimClass(list, "b_slideListUp");
        Lib.CssClass.remove(list, "b_slideListHide");
        /*
        * This works because when calling list.style the browser will recalculate all styles
        * and the previous change will occur, before we override the value with ""
        */
        list.style[transformCss] = "";
    }
    Animation.cascadeList = cascadeList;
    function toggleSlideTranslate(ele) {
        if (ele) {
            toggleAnimation(ele, "b_slideTranslate", false, [transformCss, transformCss]);
        }
    }
    Animation.toggleSlideTranslate = toggleSlideTranslate;
    function toggleSlide(ele) {
        if (ele) {
            toggleAnimation(ele, "b_slide", true, ["height", "height"]);
        }
    }
    Animation.toggleSlide = toggleSlide;
    function toggleFade(ele) {
        if (ele) {
            toggleAnimation(ele, "b_fade", false, ["opacity", "opacity"]);
        }
    }
    Animation.toggleFade = toggleFade;
    function toggleFadeUp(ele) {
        if (ele) {
            toggleAnimation(ele, "b_fadeUp", false, [transformCss, transformCss]);
        }
    }
    Animation.toggleFadeUp = toggleFadeUp;
    function toggleHide(ele) {
        if (ele) {
            for (var i = 0; i < animClasses.length; i++) {
                Lib.CssClass.remove(ele, animClasses[i]);
            }
            toggleAnimClass(ele, toggleClass);
            sj_evt.fire("transitionDone", ele);
            // instant animation.  Log both events one after the other
            updateLogStart(ele, "Hide");
            updateLogEnd(ele);
        }
    }
    Animation.toggleHide = toggleHide;
    function forceUpdateStyle(ele) {
        // Due to browser optimization of style update, multiple style changes may go at the same time instead of sequentially.  
        // To force update of styles before applying the animation class, a layout property is accessed, which forces the browser
        // to update the style and layouts.
        var tmp = ele.offsetTop;
    }
    function toggleAnimClass(ele, anim) {
        forceUpdateStyle(ele);
        Lib.CssClass.toggle(ele, anim);
    }
    // to animate on the height of an element, the height needs to be explicitly set on the element.
    function setHeight(ele) {
        var height = ele.clientHeight;
        if (height == 0 && Lib.CssClass.contains(ele, toggleClass)) {
            Lib.CssClass.remove(ele, toggleClass);
            height = ele.clientHeight;
            Lib.CssClass.add(ele, toggleClass);
        }
        if (height > 0) {
            ele.style.height = height + "px";
        }
    }
    function transitionEndHandler(evt, ele, lastProperty, anim) {
        if (evt.target != ele) {
            return;
        }
        // send an event to signal that the ele has finished all transitions
        var prop = Lib.CssClass.contains(ele, "b_hide") ? lastProperty[1] : lastProperty[0];
        if (evt.propertyName === prop) {
            updateLogEnd(ele);
            Lib.CssClass.remove(ele, anim);
            if (evt.propertyName === "height") {
                // upon height finishes animating, it should be cleared out.
                ele.style.removeProperty('height');
            }
            sj_ue(ele, transitionEndEvent, transitionEndHandler);
            sj_evt.fire("transitionDone", ele);
        }
    }
    function toggleAnimation(ele, anim, animateHeight, lastProperty) {
        if (animateHeight) {
            setHeight(ele);
        }
        toggleAnimClass(ele, anim);
        toggleAnimClass(ele, toggleClass);
        sj_be(ele, transitionEndEvent, function (evt) {
            transitionEndHandler(evt, ele, lastProperty, anim);
        });
        // log start of animation
        updateLogStart(ele, anim);
    }
    setVendorPrefix();
})(Animation || (Animation = {}));
;
//]]></script><script type="text/javascript">//<![CDATA[
///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Shared.d.ts" />
///<reference path="..\..\..\..\Threshold\src\Content\Script\Declarations\SearchAppWrapper.d.ts" />
var CUDialog;
(function (CUDialog) {
    function sendAction(response) {
        SearchAppWrapper.CortanaApp.sendAction(response.CuAction);
    }
    CUDialog.sendAction = sendAction;
})(CUDialog || (CUDialog = {}));
;
//]]></script><div id="b_content"><div id="b_pole"><div class="b_poleContent"><div class="b_ans b_cat3a"><div data-emot="Calm"></div><div data-tips="you can say Yes, No, or Cancel"></div><div data-ssml="&lt;speak version=&quot;1.0&quot; xmlns=&quot;http://www.w3.org/2001/10/synthesis&quot; xmlns:mstts=&quot;http://www.w3.org/2001/mstts&quot; xml:lang=&quot;en-US&quot;&gt;&lt;mark name=&quot;TtsService&quot;/&gt;&lt;mstts:audiosegment data=&quot;qlOBUAAAAADOMAEAVCEAAKcrdPeo7knl4CNwQ6crdPepnKei3r8/pyt096mUM6ea5a2Ppyt094Q2lAWcKt23pyt096mcp6Levz+nNh/2tBeop+C7/3jyrEY/q5i85qKXPmKXN9nEa7V7ZCT5WiKxg3/EPBnuM3+jEt3nysMFnf8MoFiZf7XGqeodifcc16sCs3UhhIXmJRtKdzIxKo3GTDtCCKKl52F+b+8ogh2oEHVSpp8wkLkjZBfm+r5bKnte21ukxpQbxCVhdG6sRoZgKx06itpIoYLDVgKbGIiiQwSL/0gyR7moHrOMxAhgtIQSTooa6EtmK/qqjgz8oKcnpaXNffA864gkMhn65rUE48+54esfyjEBVJBi9HApWCXXB8RAAgxPRxqanwL0X8wFNxkAl8VxuLgfdXZluheZvvA8w7igZ2JzxsMQSgiP2xeW6R8evkXicaKw5w27Cr0hsf/3cN+512RP8X3qmBcD1RaCLYtWCMg2wb5/sb9NaYEmzAcN51PBNgN/2dpqB2u5MEEK4o/mZEjov7fxrHRWxFX01TT/N6vq6sd49alpEHj6TbK8C2UI+5gYBUp2Fvg/SCHc1HsfiHqHocuKckSH9B3EGVXzjBiXXpk2SR2Ek/LV7g6byFATgZkVzMnnT/+Wo0/i/F4aDDU0j2pwUcDm4HoAAOTkn8LzAG805/Uhqcr06NcsCjxjcpGG6v+V0uBEgaC3w0L39ZTmDeClpeJvuasaoctB0JJd/dbc63XNgu+JgGwv/5RxmlGN0/6/ROZSDkTyAIzVzJaIEUSwS/Tenm+7vuu0bxqIKfTjhoSRIW2FXb+TGYeeHnoIlYUWoG+L1RRik9gsAoEJp0ZIdqGncP137oQS/QL5kHzrkxlvvfJSyz/KQDn5EZWar8mO3djesYIeG7Zc/fWBPsMjH2h7bfp+YX1B8s+TCqGF/pTUTAe6GNbjQa0+cgdiz4IA2VqNmhPT+U/H0DLrksJU7Hji4pnxpkUYY5NSTRyjqnT+Bo2C86RhuBDVmcdP+cIH8LAemDK+Z0DWveAm5ffnxcxS3ueq22Mj0wXhoweVylMHvVp60R7eYoBMBudeF/RkdcbawM8j8lIyDcVrmtWLJL/+pEENzWvZv/TflX/uzZ/NV5i4JKr7xHR2GYMieSCJeD3NzhCygQJ/8agNrzBg1jfqehyMUvjDgT//lG6uXJOhQ1p7R/q/HQFznp8AiA5Dvv8NDeRSPAQTIzDTT9RhPofuS5hJRCAvlH0MBDmNw2pVSjZ7BpAF0PeznpC/n0F6aOSTY1JOsJa8FvsP53cBt8lVQbuGv5RFmitc3Wq6ZEHbbrWCVaCDAt2Ebp6fQRPJQpuBezexodlWPjignL5G1PfFxOc8i5MF2GXNUlLCiTnP+CeQhzQS6lS0ZBSB4umr1UjJ6G1LQ36S0+0I58Hx6RDcPEI5QxUNHidgscBFv5GVtnMIFnZaZpoUNRTsIoWg5ADsR8zD1IVxGnrjwPTAAYWYm69PYzwVjpfMlpD+60wTH0a/Z2f/kPTBToNI4VPjB3IoGk0RqMBdWsjpoMWPMkNz8tDtKVb3U2OC0GmIqlByhwRnGcBhWuqyNXmM7N4g8/c3xnt7Bc+0u2+rbVn4Q4bbK1PB6mn01OhRY8EGXUfwZxFITzT4P7GODcscndVm662WPz0Dmvqol6zK/3pgEkCgbFSrmoEcrnsH4186ut2Ycns0BICmZ8HF1UqTiYrCEzgW7I+sF11BOmlnS7HQt52UAsT6fImh/6c9fwyhuZvy+yN+Hidtpng2Fs1/pyt09aaxM90/gX+nK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qc4rmgXT02Qb+r8wjgJxYkQBlYCeLxVCMTHgy8TV11fpkLQF2b4nDR46B7HUhEUlvt7dspkOCrYQMrfmfP81IzCHd0Q4M40vZS0frZWUPOormw/RLxzxH7SY0gyUGKDaHfebtejIIdDf5ml9JJ2ZrGZGCdTvSeTerWJVWu4xX4eZIxMWEC+p2D909mVt2OZpdqXJlOvNZzLR/3BzzHX3x3q8bH0AZ8H9dqIy+5VS3/WGTpQNxPx/UVlSSE2Z7+Z9HLBw7FG4FZWD2Rkp8MckIBZ10pdpvd19ImwDNpWkb46nBBTHT2XDWx6s7+oGVZKTPrZf5ycetkVR7JqnMcm7PJ9NtiIcgGGYCfyzsbQ+WiWoR7A2oJJbHZXWuWD/ogyU3E4ckLfnVXzu2Qa2SjJmvp4e3QGiLt4OpX32AdReDQnKbc63+2f/HJhR/MNvG1+185XV50loYset2YaG0DqGgCJzpDt1WRoAqLMJAtvdHtBmNSxYWDsfdpo48a/nG+XsPwShllXGcgEIjkVnozKJR5H0OADHXV18sR9fHtFwfRlBXDLyCj/m7iCwu+X8OkU3R4dt7gcb4kwJVUb4byXxKdKZrl0BmgeyYP11r9/m4vuYW4bcVm8P1hgHgKNgJ12oHWsaZ24EdjMUD9IpCtAFaqfl9cnNa8Q8qac8XvIffVy9MfdSmA2XnAv9r6gCVJOmzTxv+76bjRDwgmRy3+QO4aBCitS+a2Xyd6cGj899lnwKMczkZrTGWf9wsz5gpqfG/LXPWzw/1SP0g+ATwoQk0JmsWn8sONK/FrOXD6ABICJBAv2+K/gG73ZEovmKQ4CbWyD/fugVTAbIy+Qhy3t+z0mmq6VHkj4cdHsM50Q5aWmYaBRGT7wMQycewsY9qITu1IhOwPOO405lJTHBMIxYCe5kP5g8v5BhaAleX71zgVrFeLAOB1JKGTkaGZpFPS7f5Xax1/p1FhQiRGQ2n7AHfTifH9USWzPNuohhX2O10oRwuO53VrLH4ozRF+Vdw/4LCrKOrtAwJ7n9zx8FwRMjUqR+hFRR7TDVSG0YAVNN1Xyx820GhKA6joYh5rjn4+yHuGUz+CKbfu4KtOOMnDtaErimECTGMsIAo+3/u2kx6I7SsdySOSspGQOREK3GV9L/m3/tpx2R3+Ng27Wo8tYASX7D/m+cp7+3BhoC+Ioq/IFsi951TecAJvdOpm1hBhRA8jtn44Bn/eWbAxJ+Bgm9fzZOcfqNYAcAq/78BKdJQ/o1Jccyga0Kpp12QVSuepm5uGUj5edkJla6LDh2oUVS63sGr60pHGPoj7b87fjmV5gQ86/2cQv14T4ydguLEDeswKmCa8nQ/+btADW4vq+cFZwPROIPvJahM11N7cbS3Cw3tJXi73jyBwARSdvHmC/nH+br0SimrelhkYkh3AilkHv5sUV2su4QKeKFfrsBa0LJPTaufqbs920OwCGyQHXA9FrsdwzxleYt66NeOKjE/GwW8Dse4n4byGSHdsnzEH0FX+b0ZkPLohkY8DjmGGrZeJX6h9vubgN/98N55tiuX4gfCjUNObNmsbuhYGBTZ+czxQyLLvY3wOgy/L1bv5oMA7pEOiAB3+RYgX6NBkLo3apBiunFD6zr12YoniidZ3TP2PAwijIAZisobNrYwGjjwSG2auWR4n0ExPpkCcJebvV0R6zMkdHH50Ha6q5wF6HNRcHhBwRsxTvntcVAYGT/EjYSDV/eXr/P50NlBQ3c/JoAWR7nCtVQfDZAT0W2tLc8bp9yMbtSQtOSu5cQXcSlVxiKPnEzO43XneY+P+tRfNMeb6DzgCvNtrJgqThlpQW49OtkdQTxI5rfSpnvIFOo79eklbxKNUO5ItzinpWwgxOfxCbEWBtfD06pDxsJWAWQ/SRBsPesWd21gJvwual2QEYej+J3B/rH1w0kBgBs2D+qG1+h7RL2Oqbm+E5gUVWt4pn5VDftiqKclVJnef0U/nov5nCyky16/dRSgxK5Tm5PcyWLkvV3OdFJeK4qaV2nZRj4g//uO4swgS+bHLwXT9JnfQ5b99wCVajbZj9AiBkFq2Twu5f5WKUWMdWMFaUuKFWOVU5kpsZSHge0ZSjoSxaaAznl5cjVXwj3aI6iQBER++fochR2SilnDmrjGui6CeXfc1serCnzlJBR1viFT6NbJGSRwZJg8TrxHnFUR5hfYfMWCVu/5pF2a7P5fblqZqwTMtI+iJYQ4K+5GatsOUkP9E+CH9AJUEvmZu2jK2TBHVniQboi/FZ/iydyUI8iQ6kINhoyPOnVG0Hv5mWrcfMWMAFevyteqnv6qMXZEkJ0ymz5CL72tlQikLt5IaYFLhAId2tU5coXas+gi1iBz5wz88altrcMhFKycB52xldf5XCsSi2tF0b7onwvv3lRr/cBFHXugMr0WNLLPPMJwk2OwLtBtBIhV9pR/MER6Fru59/j4WCiWnhOjZkkplHOFRZP5Bjc6ziTkuKRxP6gmWfHkqjMWCooFKih2v2RXXICHBxalpMSrr4tS+WdZTq1TA7CgoZOtOIasO5zMN6y5qBfBbZnsobpxFWHSREELABNCtqFXrNu9vKZWCF5leUSH+mrVvxMk/xc1GJ8Spcwd3hkZAp5ZXJcAeEtFscXhKWvai0eaimblSUkkm1yxVPmtav1+kojvEBTuMjAmWI2E1q1Jjm+hq55LR5LrOkbyUzw9hUudRb9gyg1IGDq5pwWEd8du1n+50phv3FL+Ka37xPX5TGzsFgIO8d1cjZiRxiFos7mewKeShEk/4VXOHJgU8KQEPglmiN0Ta38SkOXHaTOtWmV5QxAobojJZa/QSP6kZ0J5uH8m1+FVIgqY2tr4oTDA3c18WRRpa3rmnxRNc+O/4kNYw8ZBornDDy2pvTD5pQKt/POWwmurjqMqO//7XlPP7XADxHkWwQDNrTyvCNHNQXyvD1jsKQqCM7l74vgB1NyLc2t4tueX9ZcEkdzUQuJywFDqvmYfC5QkNMrfgILSP5sjorsXpaP7E+UcpSLiLFR/kZfHqtw6iS7+n6aXzeS+XYFPZNjXM0hnuDrjhI/6Vb00l8ZKLQx81Kx9vrFUN4mEqRNORbdDMYUJoC0CPQZzvC14tt0oiQcIfeMQO1Zp15mKbXZJJbXIQVAHJQO5xPBwrkjUw2BjaXvZttuKKF5XQjxwAc34s1aO7mWIil0+axoPp2Ac+m7IT06Wj0+lTILYZGRYmFHXBb5Uu+X75+oklnlQWQSs46KJcamtpHtROEGq1aC3SLESqP3U8O8Em/Qtg8az8eJAVBFGI82+I54/DOD67XaUiu4en/nYQ4Wu2guQ3x/atbqRwCfmSPo2UFzdFVBhpe7tjMfFTUYwm1nu55qrJTL54ALoVpSdw8YJvHI6udJKvGqaXI93iGkk0kYm0SZhhtPEVB4b8K4b+d4sIcc2jhfqXWOzl/WHY9yJcxS+Oj2jIftLSwm4QxzV42vZ0oMTynWqcnpnv3O9sCLBQ0snHUNqAabbFaezw8IViObyCk79d6TnVVKcZKfr+d+YaFmqunzU75lxpk0itNL5ONwoZwEGwQijxHGdwpejShnG7hxMltrw4NqFc/na/XAHe26qZ6SflDwUn4X7Hf6CUhGWgx3eDX6/NHzsUF+T4vCgOE3FDt/5kk3s6eErhnvRGATaMwJ0O8TipFEDC9nV8PYzk7xSiAhUinCFGfl8ZQkHZBZytw/8p9urrnhorbY7hm1zgPySiiFY8HLxxWyI7cjbZX16TJmKt7jdekbxaE919Ni2g7KFq0zU0Q+xQwK3lIQcWz3rCuitkR4rQSVz81jXOa35zXb/P9Y/PeD36m6gilZ9lahHuZBTLhVT4ZrkdxVsxsirKRawSppNYwyV395/Zu8Qqevq5bnvyOWOvjOAUdfz30PrH6cmL/EEgwe8rHjq8uo/0uyreHEwAi1NFVD2mC5f65o8Kvkkkbaj2LapVy3c+7WKQUyaeq/RZU9Gnmgq3j8qbiH4DV6gneh8Uk2fruLnrCa3IyTbxteUmKIZEAMQBX67KVnw9kCc7ZpLUn6Bp8yv+ehtJTWywDTkeMiWsF8a1HFRi5muIDDMlBtmTWpaxJr4kgtCBnvbb8YrxeP55R+F8hqFVUfh1OFuvJByyYBvMcJRwmpADVdbB9nBwqHYDcGmyhQclPnIzjddhNrqjoIUsT7QaFKt56ruR+jUnY0qtVv7YN8Xd71hJ1/5yM5/UztlpaYxhBt0EBGC89rt3jzoQC3tNKhAxTOF2cwg8hXRYgLveJsE+dUdzWyTqbLT1q8jKFQ9LILTL9EfPjDE9DTuMKre0bdclgOaZ1g11LtNw/nVHl/LCBgB7e96t2mnAfjt2FKelMwpoUVVpRO7Ra9IseraV45G+KaC6vnP1rLybZPXjYVitgX8eoNHDOX9k2zUu2azFsXQTTIP3/rEDvFZzobZzDtqi3JIYOwhACzpTNpAGLLsvcRireaLqWdXjxhGs4dCCso08Zv5uvH+/PQ9QuzSBW9suEJBjyECx4rkjdoYhdXsSexyPr34/L+yz/mQ8XVGMWz0B0MGobiQEtH13wVshHyPCEwB6h6Hm0SBU+kIyWDNveJp3EkPQbEb+NAxswOBXQJZHVS8xyrzgtNy265gWONwUeKOES8Jscg0/xvj0O6YicbdhvqQ/ujHc/iUccofoEiK7kUtgxxpwzOmMKf8MmqMdfi1QfEa0+4RzUiZlK0JQMt40vsf7gFd8tGEMoCA9pRtn1zdREWrXqxVd2gOiZSoj9EAGKdP+mTiJqksDd1WUnxaFtXqtISi5x71NWA1RsVSwSpEnFFnJRItpB2IpyKT+5n9N3P69sIoxKfWdbK5v0kaaDYw3K/H3M23tDg01exVPLlhTHDaJ9Scro+lLfuXlt8x7Zpblqhr9/A6R9hlYAS2AOBsoXMXBZuYoAZyBjyz6ArcL1zTqLf5qbJAooNRlc64tEMwMUfnP3oe5+ruF8GZoP0Z0SArlXFsncW2I0UWUzSA9n7g2njZhRUtP9Vj4/m37RZM8y0CEO+BnMm6CSeN1pU+hiZmVV2NZrNNuGzO+eamjmMzNU+sl0CzdtFH+VG+u0LfoLjxHt57UJ/Z09wcw6GY1JJyHGgqFGLq3MejSc+hdVEehbgLepjwc3tFMGHtpMOm+NenJefqAtjkOdricv1LzFMDD4pnEySqPjbi6O8CTENBuZ9z+N/SMcsEwZz0CQsZY9odBDrPcYKWTGyhlgzteWAnLaWUeEp8mGpUfxRpLgnUuQvt87sYtCX8IOyO8EdIYH3Rm5VovZRePJF2XWMwp9oIePcWLulX7hqZcMwmfezprECptzogi/lcGkLB/OGwBqq9a7xMzsU4uRSTFQeW0FCbizEVpOoFgF0X8D5Cx8SnP3t7Cpf5XSlkhA8Qc7jqOIAYO/nn9ghSU8W0X1Ab1j+Rc6UIuQGVSOuIItmQAo+ReV0owfKA339CZHRB8xfrA4KHCPntT1hTK4fLkrWRpdG18XUzMcoSMvlc2JlfJUMGTQusnM6wggYNSXYQJELAR+ickHwBAAjxW50JayyH+js8HflHCl2Dard2SUFtTaOqfVeaGk/8FcmdDUOGZP/JwQ/wqm37saFCHyrN+MjiIMP5REhu+M+6kVP0PlRtS0iQefzUeJbJ3w+NaRydATxpOIMmoXH5FcGtqQkzi/leXPZ7AbFXf5gHYeg/a/BkH3Wvav5P6GLF3MlvGjsuLB+qPO1GWO+PvegTEtVNcLnnT7bfXkYxnWur2cfsRif7XC5d/Wlpayj5crAHUy6gn/jvwkYcjNapAbINxau5bRYKp8UNmq9RhoIOqfDWKMaPlA0rhv2yYTsar6SV2Hjw/cWFgD+h/CTCzM/huqKxhadDHPu3Oc3ax+RjSaSaDDp1oUPcpR003g8aOQkrSrNWK2kHfxSEYufMnZEZT64qJi+l4ehuZz8ket0glU/GyJux3TWmwtecD3nDMKnWBhCb+S4uZTeYFbYZN/+akUszAthgRsLIi9dFcPb+Q3HWLlAAtbmqY958mQ4BiTC1edGJc36i96xH91W2Gkml87KiE1k0WkTUXCkUkjEl/QZ48MmAjBylP/kV8yGn1HG+xnkpQyKCZFcCfzYn4ihYO1v7JXsRySazD9/74D1x3/j7nntDci8qIxooYfehQUdc/+uZ0T2hHoQuGlYFOF30aStnnqfuNmH46XIFjDjLsjnLSlSl6ORXSVu0XyFQjOXSseLJHTVgh3n4muyUAJUCrycBV/jBWIQZqDr6sorOs+HIm0T40AsRuofALFo6gkftfTi1VtJWLwdkwYwSd+rpsR6Fvqu0JfiGpKdWV/rLXqETq+eI4ajoADcUsNV3Mtn7xsHciqMCySUqLEM1cmudzvJguYyN+G7afR9xfXcY9tn72sO0Oasy0hgBsUXR2NzyoizHhTDg8SEb66Ap62rMHUf4P9ULU0sl/Kbazj3jex20jz3QSM2o6eSpr9fFV/EWgOpAClypLBoRrLo8Ufr1l2/ozA0IwAJboW1laA4b1JqvE5R+HuV7ila9M3rYHrEBjXRNy/i21QmignDIASLYiZi6c+qI7tKgQrqDx5NZyxnF+nK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPXjJJ+NdC7/pyt09ePDocvc6PunK3T15D9H2LHk1qcrdPepnKei3r8/pyt096mUM6ea5a2Ppyt094Q2lAWcKt23pyt096mcp6Levz+nK3T3qZynot6/P6crdPepnKei3r8/pyt096mcp6Levz+nK3T3qZynot6/P6crdPepnKei3r8/pyt096mcp6Levz+nK3T3qZynot6/P6crdPepnKei3r8/pyt096mcp6Levz+nK3T3qZynot6/P6crdPepnKei3r8/pyt096mcp6Levz+nK3T3qZynot6/P6crdPepnKei3r8/pyt096mcp6Levz+nNiBXoOV9vqwVfoonYxxghFeEOr+si6rXRZP3SutgrxBou18cb0oRG44RZRvmsYcZ+zxMwzhEx8l2n4Ox5g/ljkHEQZ+PnPWycdZ5VMXJljBQdVZimUi5uyVqGJAJr9kKjmxH/+OwqbW8u54bof6x287XwUTxwM4NR+iW6bnAu4lG7mU3BvQAPWWi7PJkGvTValK7om+2dTmE8omy/LjJ0PsqzMkW2tDbILwVnnbeJF8j1X8kE3y9vnYMRGOlt5OEknG0aMUect/kfNxzsjJXUQ5Gpm9NHg3lbOOiPjLQrX5WXJHIdjjvposMN+C38Ye6RlioFmwtl7VNv83N2IIskONkRJi5KZy3XC6W1o6HAvv/nNdBsCkQfW4eAfD73KfnDNzqzBLjXzxHFEnyATNTSxniLeuKQmdKIZ+hNOeQQR+egtJ3Ndkfyo1iFHQLRkJ2IgjYMoigWzwB7F/15tRlKQaPX536CjzgfpgBkxXvYme/tAOp4kJheco8r3u8NvhkpVSN4colfJQ/ngAJBhy+OdcrvZIn5jKeMRet6hlWo+g4IJ8dQULkiHL/2YXfnc4W91hY0iOs8Y023PvHYGiPYtUQibp7XncjgbmmZ+N5CF9Cf7+cLLtsad1gdK7+UBL4PgbE8mBd1weSxpcey4mcJhhLdqFsxknW4UFdLzHnwtPnl9gb4YM5dTmrqFEqJwX6QvTDO2qOqWHqKiIXzTFN+/6SpsaoNY/x+V+Txsq4+MVaHK+D6gZn/FUqoQDCcX38ExyfiD9/QmTGiJEb3NOIV1WK+8mmwI0DHgZelDell3lht74TrRXvlrePwDKV+33YUbNMPLGiHAmpFrTzNwu2JX+JJyjQ55DZwwewqklnZlvNOpjhyc3CAVAwoIsLRo+suqHDATmxuGxbSpG+36agIvLYUPa1Z7pU7Cwm8mtqNqWfoZoO1YlTshiI2NYcogvTacghNRJ7+eU2Wuu0/yqQZkQGIrcc3A6/KPNc7lunTisH9fuLak7VXpKHr2KDio5mcAla20fOaq1a4p3fHRup+6jYqt3Ox9bkRbkRa62atpCUcalB65rOZjS3vGnmwrdTyH6PU1+maxWpNjBsmEnwnUpmAeD37awVuCPysoUy/lVTWny0UTvSaz4+wfOWbLb/TZnJHFpPQPZHtRbIYYaUoqFUQ7zI834Sn2nD/HfCc4x4paeoivu6Ny6onogcZChE0XOp6zSycIJwr5vwV+WJt3gb52iUTvHGL2DPGc436Y8Q5jKFhBL4nRgm4xHeqCjIFWP0nIOlCcIMkkXV14T00qI4KWAFFaIJ3i3vi+PixEmOzJUHL5ghTilOk42OP5w3prBNuDyO1oGtkhBItSpIOwW3NW0hSvnF2uNwAsWQ+7G/m6qS30LFzwOIf368s+NTmcWtIVIEBKx2pI+TnQteIWc65oMcfoO5qZuqk9qT/ea3Qv4aVstT17kqweHyYJQ0doteIZ0xIg9xx5Efn4oTpqXLm4iqk0oYZp/zgRggjZ0hgmXh8yZ8e8CkP/omCkeibcWSRBCFR1cvmtjPKvIMDfnpbShqKidYhgmsdPhK7LW2+e0AaobK/IiCAzLS06PPA1yHnGzhP5IpAYHZe/TSzv4QFb02XmbWli3Rmm7+2MM9r5OtvE9GOzZa+5uqRhIB0pIwWPWjEwq/R/Q7n8Oy/MzhUhgRX7R41RU1oZ6i46AGRTfYG349MIttH7GUn5s8aHwfIeciMo6/OJj2g6aQ1yX5Ow7qDBkfUO7Q2wLvm2QxJNBI1Hn/oZez4zQNvWGX55Dkeskat2TJS0d85JE+Q09LN3/YMe5CZq85jSXlwK9jBcU9XCinv28ks1qgno5oIxLSkIE265XfcOt5XQpMPo+lEIGO6dY5NM+900x5z+vXALkGVUYj7Uafp5SQUf0R1yMV/tRGkcBzQL+xyJ/6qGT/X7Ywxdsdq5s+/PkGabetwgPvXrYj6wUfyLcVKjn3XOOS2fLI6zJa1Mja0v+0WcqI57+vQKvGDZ1EVKpetjM5qvPUlSxsEn6mtbOj5FWx/acPathbWsRfs8jFvwZQR0Tk54a4GJPFpWAzwCkL/lmy48wFLhdJhhSAWOKrno/SnuS5DB3nK7GIFEoiVwjAdpk/6qlFr69x3DfHvBTzvcBfJPLp2LzCLEsdaIK/rnHngfysNFNX/KGUDapFQ8NiTEgiUSjjZO5agw==&quot;&gt;Sure, I'll remind you to at 9:00 AM tomorrow. Sound good?&lt;/mstts:audiosegment&gt;&lt;/speak&gt;" data-postssmlaction="waitforuserinput"></div><h2 class="b_anno b_anim">Remind you about this?</h2><div class="b_vPanel b_narrow"><div><div class="b_focusLabel">Reminder</div></div></div><div class="b_vPanel b_narrow"><div><span contenteditable="true" id="remindTitle" class="bucket" data-content="Remember to...">buy milk</span></div><div> <input type="text" id="remindDate" value="2016-05-21" maxlength="20" style="width:160px" class="ctxt" data-gt="" /></div><div> <input type="text" id="remindTime" value="09:00:00" maxlength="20" style="width:115px" class="ctxt" data-gt="" /></div></div><ul class="b_hList"><li><span class="cbtn b_highlighted"><a href="" Id="cancelButtonLink" class="b_accentColorBackground" onclick="ReminderClickAction.cancelRedminderAction()" autofocus="" h="ID=SERP,5356.1">Cancel</a></span></li><li><span class="cbtn b_highlighted"><a href="" Id="remindButtonLink" class="b_accentColorBackground" onclick="ReminderClickAction.createReminderAction()" autofocus="" h="ID=SERP,5355.1">Remind</a></span></li></ul><div class="standardtext standardcolor experiencedetailsdescription"><p><a href="#" id="legacyRecourse" onclick="SearchFallback.ResetCortana();" h="ID=SERP,5357.1,Reminder">Search Remind me to.</a></p></div><div class="b_hide" id="CUDialogResponse">{&quot;Uri&quot;:&quot;action://CuOutput&quot;,&quot;SystemAction&quot;:{&quot;CachedQueryUri&quot;:&quot;https://www.bing.com/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;input=1&amp;nclid=5843B1284CE21CF49556CE1C9F256103&amp;FORM=&quot;,&quot;Uri&quot;:&quot;action://Conversation/ShowUrlContent&quot;,&quot;Version&quot;:&quot;1.0&quot;},&quot;ConversationId&quot;:&quot;42286d7b-847c-e0c5-83b0-1a1829576a20&quot;,&quot;TraceId&quot;:&quot;BD173DDF797A4F5BA406E39519A96088&quot;,&quot;ImpressionId&quot;:&quot;eb79d25414acf5972aaf91eb2256152c&quot;,&quot;LgObject&quot;:{&quot;Uri&quot;:&quot;action://LgObject&quot;,&quot;Ssml&quot;:null,&quot;DisplayText&quot;:null,&quot;SuggestionText&quot;:null,&quot;SecondaryDisplayTextSmall&quot;:null,&quot;SecondaryDisplayTextMedium&quot;:null,&quot;SecondaryDisplayTextLarge&quot;:null}}</div></div></div></div><ol id="b_results"><li class="b_algo"><h2><a href="http://www.windowsphone.com/en-us/how-to/wp8/cortana/remind-me-cortana" h="ID=SERP,5110.1"><strong>Remind me</strong>, <strong>Cortana</strong> for <strong>Windows Phone</strong> | <strong>Windows Phone</strong> How ...</a></h2><div class="b_caption"><div class="b_attribution" u="0|5033|4748182412460579|9Ma8k0HdXllvOTORsFGOKy-53zlrFXYA"><cite><strong>www.windowsphone.com</strong>/en-us/how-to/wp8/<strong>cortana</strong>/<strong>remind</strong>-<strong>me</strong>-<strong>cortana</strong></cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5111.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;Need <strong>a reminder</strong> at 7:30 A.M. <strong>tomorrow</strong>? 10:00 P.M. every night? 4:33 A.M. on Tuesdays? It's up to you. Place ... and then tap <strong>Cortana</strong>'s Notebook &gt; <strong>Remind me</strong>.</p></div></li><li class="b_algo"><h2><a href="http://m.dummies.com/how-to/content/how-to-use-siri-reminders.html" h="ID=SERP,5126.1"><strong>How to Use Siri Reminders</strong> - <strong>For Dummies</strong></a></h2><div class="b_caption"><div class="b_attribution" u="1|5034|4932110049673641|_jU_rrhiY1zC3SHrNnCysM5J23gFEcYa"><cite>m.<strong>dummies.com</strong>/how-to/content/<strong>how-to-use-siri-reminders</strong>.html</cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5127.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;<strong>How to Use Siri Reminders</strong>. ... &quot;<strong>Remind me to buy milk</strong>, bread, ... For example, say, &quot;<strong>Remind me to buy</strong> flowers and wine when I </p></div></li><li class="b_algo"><h2><a href="https://discussions.apple.com/thread/4265770?start=0&amp;tstart=0" h="ID=SERP,5149.1">When I say to <strong>Siri &quot;remind me to buy milk</strong> at 11... | Apple ...</a></h2><div class="b_caption"><div class="b_attribution" u="2|5035|4703437430526151|rJInGpoet8ta4G8Bldu3xOanx0Q7hf80"><cite class="sb_crmb"><span><strong>discussions.apple.com</strong>&nbsp;&#8250;&#32;</span><span><a href="https://discussions.apple.com/community/iphone" h="ID=SERP,5145.1">iPhone</a>&nbsp;&#8250;&#32;</span><span><a href="https://discussions.apple.com/community/iphone/using_iphone" h="ID=SERP,5146.1">Using iPhone</a></span></cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5150.1"></span></span></div><ul class="b_factrownosep"><li>9 POSTS</li><li>FIRST POST: SEP 03, 2012</li></ul><p><span class="news_dt">Sep 24, 2012</span>&nbsp;&#0183;&#32;When I say to <strong>Siri &quot;remind me to buy milk</strong> at 11 AM,&quot; the transcription will say exactly what I said and Siri will say &quot;Here ... 397 Views <strong>9</strong> </p></div></li><li class="b_algo"><h2><a href="http://www.techrepublic.com/article/okay-google-now-remind-me-of-how-awesome-you-are/" h="ID=SERP,5164.1">Okay Google Now <strong>remind me</strong> of how awesome you are ...</a></h2><div class="b_caption"><div class="b_attribution" u="3|5036|5019611393491225|IcZXQ_oi_wPqp4dVIanzTbTTZNFaY37T"><cite><strong>www.techrepublic.com</strong>/article/okay-google-now-<strong>remind</strong>-<strong>me</strong>-of-how...</cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5165.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;... <strong>remind me to buy milk</strong>.&quot; ... Okay Google Now <strong>remind me to buy</strong> toilet paper at Target. ... Jack Wallen is an award-winning writer for <strong>TechRepublic</strong> </p></div></li><li class="b_algo"><div class="b_title"><span class="sb_doct_txt b_float">[VIDEO]</span><h2><a href="http://m.youtube.com/watch?v=5RsShcOT4e4" h="ID=SERP,5193.1"><strong>Windows Phone</strong> 8.1 <strong>Cortana</strong> - <strong>Cortana</strong> Commands - Windows ...</a></h2></div><div class="b_caption b_capmedia"><div Class="wr_cm"><div class="sa_cm"><div class="vtv2" vhk="" sh="/th?id=OVP.V47cc6a6483f31da7271f35a7405ebd4a&amp;w=300&amp;h=168&amp;c=4&amp;rs=1&amp;pid=6.1" t1="No preview available"><a href="/videos/search?speech=1&amp;input=2&amp;cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1&amp;ru=%2fsearch%3fspeech%3d1%26input%3d2%26cc%3dus%26setlang%3den-us%26mkt%3den-us%26setflight%3dremindercox%26uncrunched%3d1&amp;view=detail&amp;mmscn=vwrc&amp;mid=8A580C8C889EEFB6C3B08A580C8C889EEFB6C3B0&amp;FORM=WRVORC" class="vt4" h="ID=SERP,5382.1"><img width="104" height="58" id="emb598B1C46" class="rms_img" src="/th?id=OVP.V47cc6a6483f31da7271f35a7405ebd4a&amp;w=104&amp;h=58&amp;c=4&amp;rs=1&amp;vt=4&amp;pid=6.1" /><span class="vthv b_foregroundText"><span>Click to view on Bing</span></span><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft">0:21</span></div></a></div></div><div class="b_attribution" u="4|5037|4977335999599000|wLikEjcklkbXbmEDhgjdml8nvU9z2PUt"><cite><strong>www.youtube.com</strong>/watch?v=5RsShcOT4e4</cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5194.1"></span></span></div><ul class="b_factrownosep"><li>BY VINE INSIDE</li><li>1K VIEWS</li><li>ADDED MAY 17, 2014</li></ul></div></div></li><li class="b_algo"><h2><a href="https://support.google.com/websearch/answer/3122344?hl=en" h="ID=SERP,5212.1">Create or delete <strong>a reminder</strong> - Search Help - <strong>Google Support</strong></a></h2><div class="b_caption"><div class="b_attribution" u="5|5038|4649711703359699|VeXIcU0lmBRCcZTwvhGq6r_CYfu-3_HG"><cite class="sb_crmb"><span><strong>support.google.com</strong>&nbsp;&#8250;&#32;</span><span>&nbsp;&#8250;&#32;</span><span>...&nbsp;&#8250;&#32;<a href="https://support.google.com/websearch/topic/6032673?hl=en&amp;ref_topic=4409793" h="ID=SERP,5209.1">How to use the app</a></span></cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5213.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;When you create <strong>a reminder</strong>, youll be able to edit where or when it shows up. Delete <strong>a reminder</strong>. Open the Google app . ... For example, <strong>remind me to buy milk</strong> </p></div></li><li class="b_algo"><h2><a href="http://m.windowscentral.com/how-to-location-reminder-cortana" h="ID=SERP,5233.1">How to set a <strong>location-based reminder with Cortana</strong> ...</a></h2><div class="b_caption"><div class="b_attribution" u="6|5039|4515708719664884|uV2O2yxnOu4FgeKiXJeapdwbsUbBfnoE"><cite>m.windowscentral.com/how-to-location-<strong>remind</strong>er-<strong>cortana</strong></cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5234.1"></span></span></div><ul class="b_factrownosep"><li>3 MIN</li></ul><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;<span class="news_dt">Video embedded</span>&nbsp;&#0183;&#32;How to set a <strong>location-based reminder with Cortana</strong>. By Mark Guim ... <strong>Remind me to buy</strong> a tripod when I leave the house. <strong>Remind me to buy milk</strong> </p></div></li><li class="b_algo"><h2><a href="https://www.remind.com/" h="ID=SERP,5248.1"><strong>Remind</strong></a></h2><div class="b_caption"><div class="b_attribution" u="7|5040|4577027965715681|p8kPnqCFqBkhZF6cfZNTfMgqnfLnSbF7"><cite>https://www.<strong>remind</strong>.com</cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5249.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;<strong>Remind</strong> is a communication tool that helps teachers reach students and parents where they are. <strong>Remind</strong> Log in Log in Sign up. </p></div></li><li class="b_algo"><h2><a href="http://m.windowscentral.com/how-to-time-based-reminder-cortana" h="ID=SERP,5266.1">How to set a <strong>time-based reminder with Cortana</strong> | Windows ...</a></h2><div class="b_caption"><div class="b_attribution" u="8|5041|4801680499082187|d3kOHi7_S4SHjV_AGq_TUqC6h23o6xtE"><cite>m.windowscentral.com/how-to-time-based-<strong>remind</strong>er-<strong>cortana</strong></cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5267.1"></span></span></div><p><span class="mb_doct_txt">Mobile-friendly</span>&nbsp;&#0183;&#32;<span class="news_dt">Video embedded</span>&nbsp;&#0183;&#32;<strong>Remind me</strong> to call the plumber <strong>tomorrow</strong> morning; ... How to set a <strong>time-based reminder with Cortana</strong>. 73 </p></div></li><li class="b_algo"><div class="b_title"><span class="sb_doct_txt b_float">[VIDEO]</span><h2><a href="http://m.youtube.com/watch?v=7qzhngp7jh8" h="ID=SERP,5295.1">Brad Paisley - <strong>Remind Me</strong> ft. <strong>Carrie Underwood</strong> - <strong>YouTube</strong></a></h2></div><div class="b_caption b_capmedia"><div Class="wr_cm"><div class="sa_cm"><div class="vtv2" vhk="" sh="/th?id=OVP.V409c289d68ebb570edd74951e0a0c6db&amp;w=520&amp;h=292&amp;c=4&amp;rs=1&amp;pid=6.1" t1="No preview available"><a href="/videos/search?speech=1&amp;input=2&amp;cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1&amp;ru=%2fsearch%3fspeech%3d1%26input%3d2%26cc%3dus%26setlang%3den-us%26mkt%3den-us%26setflight%3dremindercox%26uncrunched%3d1&amp;view=detail&amp;mmscn=vwrc&amp;mid=C8012E01A8EA35445ABFC8012E01A8EA35445ABF&amp;FORM=WRVORC" class="vt4" h="ID=SERP,5383.1"><img width="104" height="58" id="emb16D9F9D09" class="rms_img" src="/th?id=OVP.V409c289d68ebb570edd74951e0a0c6db&amp;w=104&amp;h=58&amp;c=4&amp;rs=1&amp;vt=4&amp;pid=6.1" /><span class="vthv b_foregroundText"><span>Click to view on Bing</span></span><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft">4:07</span></div></a></div></div><div class="b_attribution" u="9|5042|4998016318113201|cOmup-YTTPng1fSeDT_KkxTNbpHdkKjd"><cite><strong>www.youtube.com</strong>/watch?v=7qzhngp7jh8</cite><span class="c_tlbxTrg"><span class="c_tlbxH" H="BASE:CACHEDPAGEDEFAULT" K="SERP,5296.1"></span></span></div><ul class="b_factrownosep"><li>BY BRADPAISLEYVEVO</li><li>45M VIEWS</li></ul></div></div></li><li class="b_ans" data-id=""><h2 class="b_groupLabel">Videos</h2><div class="b_rich"><div id="vidans2"><div class="vidrc"><div class="vidr idx0 videoResult"><div class="videoThumb"><div class="vtv2"><a href="/videos/search?q=&amp;view=detail&amp;mid=63FBAFBE0C547A8FFB6263FBAFBE0C547A8FFB62&amp;FORM=VIRE" class="vt3b" h="ID=SERP,5340.1"><img data-src-hq="/th?id=VK.425416918938&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=90" width="131" height="74" id="emb235D2F133" class="rms_img" src="/th?id=VK.425416918938&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=30" /><div class="vtbc" id="vtbc0"></div><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft plc"><div class="rms_img rms_rmsanswersMultimediaVideoAnswer_Play rms_rmsanswersMultimediaVideoAnswer_Bundle"></div></span><span class="b_lLeft">2:41</span></div></a></div></div><a href="/videos/search?q=&amp;view=detail&amp;mid=63FBAFBE0C547A8FFB6263FBAFBE0C547A8FFB62&amp;FORM=VIRE" h="ID=SERP,5340.2"><div class="videoDetail"><div class="videoTitle"><div class="mobilevideoitemtitle_mmftb"><span>Bad Moms | Official Trailer | STX Entertainment</span></div></div><cite class="videoSource noIcon noPreview">YouTube</cite></div></a></div><div class="vidr idx1 videoResult"><div class="videoThumb"><div class="vtv2"><a href="http://www.thesun.co.uk/sol/homepage/" class="vt3b" h="ID=SERP,5341.1"><img data-src-hq="/th?id=OVP.V67e61e92b2745dab192a9e3cb695f30b&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=90" width="131" height="74" id="emb37D22B814" class="rms_img" src="/th?id=OVP.V67e61e92b2745dab192a9e3cb695f30b&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=30" /><div class="vtbc" id="vtbc1"></div><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft plc"><div class="rms_img rms_rmsanswersMultimediaVideoAnswer_ExternalPlay rms_rmsanswersMultimediaVideoAnswer_Bundle"></div></span></div></a></div></div><a href="http://www.thesun.co.uk/sol/homepage/" h="ID=SERP,5341.2"><div class="videoDetail"><div class="videoTitle"><div class="mobilevideoitemtitle_mmftb"><span>The Sun | The Best for News, Sport, Showbiz, Celebrities</span></div></div><cite class="videoSource noIcon noPreview">thesun.co.uk</cite></div></a></div><div class="vidr idx2 videoResult"><div class="videoThumb"><div class="vtv2"><a href="/videos/search?q=&amp;view=detail&amp;mid=5A88F0337071948F14F65A88F0337071948F14F6&amp;FORM=VIRE" class="vt3b" h="ID=SERP,5342.1"><img data-src-hq="/th?id=OVP.Vd24b1e57de6300f87225d3c43e62b526&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=90" width="131" height="74" id="emb470C31DDD" class="rms_img" src="/th?id=OVP.Vd24b1e57de6300f87225d3c43e62b526&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=30" /><div class="vtbc" id="vtbc2"></div><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft plc"><div class="rms_img rms_rmsanswersMultimediaVideoAnswer_Play rms_rmsanswersMultimediaVideoAnswer_Bundle"></div></span><span class="b_lLeft">3:57</span><span class="b_lLeft">HD</span></div></a></div></div><a href="/videos/search?q=&amp;view=detail&amp;mid=5A88F0337071948F14F65A88F0337071948F14F6&amp;FORM=VIRE" h="ID=SERP,5342.2"><div class="videoDetail"><div class="videoTitle"><div class="mobilevideoitemtitle_mmftb"><span>Mike Posner - I Took A Pill In Ibiza (Seeb Remix) (Explicit)</span></div></div><cite class="videoSource noIcon noPreview">YouTube</cite></div></a></div><div class="vidr idx3 videoResult"><div class="videoThumb"><div class="vtv2"><a href="http://www.bbc.co.uk/sport" class="vt3b" h="ID=SERP,5343.1"><img data-src-hq="/th?id=OVP.Ve9cfea7c0c1f7393e4089e86b77a4e50&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=90" width="131" height="74" id="emb54758546B" class="rms_img" src="/th?id=OVP.Ve9cfea7c0c1f7393e4089e86b77a4e50&amp;w=131&amp;h=74&amp;c=7&amp;rs=1&amp;pid=4.1&amp;qlt=30" /><div class="vtbc" id="vtbc3"></div><div class="vt_text b_lRight b_smText b_foregroundText"><span class="b_lLeft plc"><div class="rms_img rms_rmsanswersMultimediaVideoAnswer_ExternalPlay rms_rmsanswersMultimediaVideoAnswer_Bundle"></div></span><span class="b_lLeft">2:00:00</span></div></a></div></div><a href="http://www.bbc.co.uk/sport" h="ID=SERP,5343.2"><div class="videoDetail"><div class="videoTitle"><div class="mobilevideoitemtitle_mmftb"><span>Wrestling Morning session, BBC Sport Stream Testing, Red ...</span></div></div><cite class="videoSource noIcon noPreview">BBC</cite></div></a></div></div></div></div><a href="/videos/search?q=remind+me+to+buy+milk+at+9+o'clock+tomorrow.&amp;FORM=VQFRML" title="" class="b_moreLink" h="ID=SERP,5344.1">See more videos</a></li><li class="b_msg"><div class="rc_msg">Your results are personalized. <a href="http://go.microsoft.com/fwlink/?LinkID=618196" h="ID=SERP,5373.1">Learn more</a></div></li><li class="b_pag"><div class="sb_pag clrfix"><span><a class="sb_pagS">1</a></span><span><a href="/search?cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1&amp;q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;first=11&amp;FORM=PERE" h="ID=SERP,5360.1">2</a></span><span><a href="/search?cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1&amp;q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;first=25&amp;FORM=PERE1" h="ID=SERP,5361.1">3</a></span><span><a href="/search?cc=us&amp;setlang=en-us&amp;mkt=en-us&amp;setflight=remindercox&amp;uncrunched=1&amp;q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.&amp;first=11&amp;FORM=PORE" class="sb_pagN" h="ID=SERP,5362.1"><div class="sb_pagIconN"><span class="sw_next">Next</span></div></a></span></div></li></ol></div><footer class="b_footer" role="contentinfo"><div id="CntFtr"><p id="fti3">&#169; 2016 Microsoft</p><ul id="ftrLnks"><li><a href="http://go.microsoft.com/fwlink/?LinkId=521839&amp;CLCID=0409" h="ID=SERP,5026.1">Privacy</a></li><li><a href="http://go.microsoft.com/fwlink/?LinkID=246338&amp;CLCID=0409" h="ID=SERP,5027.1">Legal</a></li><li><a href="http://go.microsoft.com/fwlink/?LinkID=286759&amp;CLCID=409" h="ID=SERP,5028.1">Ad info</a></li><div class="clrall"></div></ul></div></footer><script type="text/javascript">//<![CDATA[
(function (_onload, si_PP) {
    onload = function () {
        _G.BPT = new Date();
        if (_onload) {
            _onload();
        }
        if (!_w.sb_ppCPL && si_PP) {
            sb_st(function () {
                si_PP(new Date);
            }, 0);
        }
    };
})(_w.onload, _w.si_PP);
;///<reference path="queue.ts"/>
BM.trigger();
;///<reference path="..\..\..\..\..\Answers\services\Shared\Content\Content\Script\Declarations\Shared.d.ts" />
var Lib;
(function (Lib) {
    var CssClass;
    (function (CssClass) {
        var supportsClassList = typeof (document.body.classList) !== 'undefined';
        function indexOf(elems, elem) {
            if (elems.indexOf) {
                return elems.indexOf(elem);
            }
            var length = elems.length;
            for (var i = 0; i < length; i++) {
                if (elems[i] === elem) {
                    return i;
                }
            }
            return -1;
        }
        function add(elem, className) {
            if (contains(elem, className)) {
                return;
            }
            if (supportsClassList) {
                elem.classList.add(className);
            }
            else {
                elem.className += ' ' + className;
            }
        }
        CssClass.add = add;
        function remove(elem, className) {
            if (!contains(elem, className)) {
                return;
            }
            if (supportsClassList) {
                elem.classList.remove(className);
            }
            else {
                var classList = elem.className.split(' ');
                var classId = indexOf(classList, className);
                if (classId >= 0) {
                    classList.splice(classId, 1);
                }
                elem.className = classList.join(' ');
            }
        }
        CssClass.remove = remove;
        function toggle(elem, className) {
            if (supportsClassList) {
                elem.classList.toggle(className);
            }
            else {
                if (contains(elem, className)) {
                    remove(elem, className);
                }
                else {
                    add(elem, className);
                }
            }
        }
        CssClass.toggle = toggle;
        function contains(elem, className) {
            if (supportsClassList) {
                return elem.classList.contains(className);
            }
            else {
                var classList = elem.className.split(' ');
                return indexOf(classList, className) >= 0;
            }
        }
        CssClass.contains = contains;
    })(CssClass = Lib.CssClass || (Lib.CssClass = {}));
})(Lib || (Lib = {}));
; 
sj_evt.bind("onP1", function () {
    var images = _d.getElementsByTagName("img");

    for (var i = 0; i < images.length; i++) {
        var image = images[i];
        var highQualityImage = image.getAttribute("data-src-hq");
        if (highQualityImage) {
            image.src = highQualityImage;
        }
    }
});_w.rms.js({'A:0':0},{'A:rms:answers:BoxModel:Framework':'\/rms\/Framework\/nj\/92342395\/b2d8ec0a.js?bu=rms+answers+BoxModel+config.threshold%2ccore%2ccore%24viewport%2ccore%24layout%2ccore%24metrics%2cmodules%24mutation%2cmodules%24error%2cmodules%24network%2cmodules%24cursor%2cmodules%24keyboard%2cmodules%24bot'},{'A:MMRichHover':'\/rms\/rms%20serp%20MMRichHover_c.source\/nj\/44cf79e1\/359283a7.js'},{'A:MMRichHoverInst':'\/rms\/rms%20serp%20MMRichHoverInst_c.source\/nj\/d894585a\/02e15e50.js'},{'A:vthumbLazyLoad':'\/rms\/rms%20serp%20vthumb_c.source\/nj\/42774b66\/f4c8c021.js'},{'A:VideoRichHover':'\/rms\/rms%20serp%20VideoRichHover_c.source\/nj\/f2ea398c\/a2fa1a3a.js'});;
//]]></script><div id="aRmsDefer"><div style="display:none"><!--//<![CDATA[
/// <reference path="../../../../Shared/Content/Content/script/Declarations/Shared.d.ts"/>
/// <reference path="../../../../Shared/Content/Content/script/Declarations/Threshold.Utilities.d.ts"/>
(function () {
    var kValueExtractionRegex = /ID=(\w+),(\d+(?:\.\d+)*)(&PR=(.*))?/i;
    function sendRequest(linkInfo, el, evt, typeOfClick) {
        if (linkInfo) {
            var gpingData = getGPingData(linkInfo, typeOfClick);
            var clickConfig = _w["ClickConfig"] || {};
            if (_w["Log2"]) {
                Log2.LogEvent(gpingData.eventType, gpingData.data, null, null, null, null, null, null);
                if (_w["ThresholdUtilities"]) {
                    var utilities = _w["ThresholdUtilities"];
                    utilities.uploadApiTimes("PCE");
                }
                if (clickConfig.ForceFlushOnClick || ((typeOfClick === 0) && clickLeavesPage())) {
                    // if we are leaving the page with this click we will flush all relevant logs
                    sj_evt.fire("visibility", document["hidden"]);
                    if (clickConfig.FlushSkipAbort) {
                        Log2.FlushMainQueueDontForce();
                    }
                    else {
                        Log2.ForceFlush();
                    }
                    _w["clickFlushedTime"] = sb_gt();
                }
            }
        }
    }
    _w["si_T"] = sendRequest;
    function clickLeavesPage() {
        if (_w.event && _w.event.srcElement) {
            var linkToCheck = _w.event.srcElement;
            while (!linkToCheck.href) {
                if (linkToCheck.parentElement) {
                    linkToCheck = linkToCheck.parentElement;
                }
                else {
                    // we have no further up to go, this means the user didn't click on a link
                    return false;
                }
            }
            if (linkToCheck.href.split("#")[0] !== _d.URL.split("#")[0]) {
                return true;
            }
        }
        return false;
    }
    function getGPingData(linkInfo, typeOfClick) {
        var matches = linkInfo.match(kValueExtractionRegex);
        if (matches) {
            var gpingData = {
                eventType: "Click",
                data: {
                    AppNS: matches[1],
                    K: matches[2],
                    Case: typeOfClick
                }
            };
            if (matches[4]) {
                gpingData.data.Properties = JSON.parse(matches[4]);
            }
            return gpingData;
        }
        throw new Error("hValue passed to click tracking was unable to be parsed: " + linkInfo);
    }
})();
;///<amd-module name="onHTML" />
define("onHTML", ["require", "exports", "event.custom"], function (require, exports, customEvents) {
    customEvents.fire("onHTML");
});
;///<reference path="Declarations\Shared.d.ts"/>
// Prevent zooming via ctrl + mousewheel
sj_be(_d, "mousewheel", function (evt) {
    if (evt.ctrlKey == true) {
        sj_pd(evt);
    }
});
// Prevent zooming via ctrl +/-
sj_be(_d, "keydown", function (evt) {
    if (evt.ctrlKey == true && (evt.keyCode == 107 || evt.keyCode == 109 || evt.keyCode == 187 || evt.keyCode == 189)) {
        sj_pd(evt);
    }
});
;///<reference path="Declarations\Shared.d.ts" />
/*
Instrumentation library for server and client powered apps in Windows smartsearch
Per this design, Server sets the visibility to false (v=0) on all the app links and client sends the Merge update through MergeInstruction format
setting v=1 on link being shown and also sends the Datasource merge event setting correct installstate of the app.
*/
var AppInst;
(function (AppInst) {
    var kValueExtractionRegex = /ID=([\w]+),([\d]+\.[\d]+)/i;
    var kValueNew = 1;
    AppInst.layoutJson = [];
    AppInst.datasourceJson = [];
    (function (InstallState) {
        InstallState[InstallState["Installed"] = 0] = "Installed";
        InstallState[InstallState["NotInstalled"] = 1] = "NotInstalled";
    })(AppInst.InstallState || (AppInst.InstallState = {}));
    var InstallState = AppInst.InstallState;
    // queues for submission or submits the instrumentation log for server powered apps in smartsearch
    function queueServerAppLog(hVisibleLayout, appInfoDsKValue, installState, hideIfNotInstalled, canSubmit) {
        if (canSubmit === void 0) { canSubmit = true; }
        var namespace = "";
        if (hVisibleLayout) {
            var matches = hVisibleLayout.match(kValueExtractionRegex);
            if (matches && matches.length >= 3) {
                // Store the namespace and K value.
                namespace = matches[1];
                var kValue = matches[2];
                if (installState !== 1 /* NotInstalled */ || !hideIfNotInstalled) {
                    AppInst.layoutJson.push({
                        "T": "L.MI",
                        "Action": "Update",
                        "AppNS": namespace,
                        "K": kValue,
                        "V": "1"
                    });
                }
            }
        }
        if (appInfoDsKValue) {
            AppInst.datasourceJson.push({
                "T": "D.MI",
                "Action": "Update",
                "AppNS": namespace,
                "K": appInfoDsKValue,
                "InstallState": getInstallStateString(installState)
            });
        }
        if (canSubmit) {
            submitLog();
        }
    }
    AppInst.queueServerAppLog = queueServerAppLog;
    function getInstallStateString(installState) {
        switch (installState) {
            case 0 /* Installed */:
                return "Installed";
            case 1 /* NotInstalled */:
                return "NotInstalled";
            default:
                return "Unknown";
        }
    }
    function getUniqueId() {
        return kValueNew++;
    }
    AppInst.getUniqueId = getUniqueId;
    // submits the instrumentation log in Merge instruction (MI) format.
    function submitLog() {
        var data = [];
        if (AppInst.layoutJson.length > 0) {
            data.push({
                "Page": AppInst.layoutJson
            });
            AppInst.layoutJson = [];
        }
        if (AppInst.datasourceJson.length > 0) {
            data.push(AppInst.datasourceJson);
            AppInst.datasourceJson = [];
        }
        if (data.length > 0) {
            postLog(JSON.stringify(data));
        }
    }
    AppInst.submitLog = submitLog;
    function postLog(data) {
        if (data) {
            if (_w["Log2"]) {
                Log2.LogEvent("ClientInst", JSON.parse(data), null, null, null, null, null, null);
            }
            else {
                // If ClientInstV2 is not supported
                var time = sb_gt();
                var payload = "<E><T>Event.ClientInst</T><IG>" + _G.IG + "</IG><TS>" + time + "</TS><D>" + data + "</D></E>";
                var xml = "<ClientInstRequest><Events>" + payload + "</Events><STS>" + time + "</STS></ClientInstRequest>";
                var request = sj_gx();
                request.open("POST", "/fd/ls/lsp.aspx", true);
                request.setRequestHeader("Content-Type", "text/xml");
                request.send(xml);
            }
        }
    }
})(AppInst || (AppInst = {}));
;///<reference path="..\Declarations\Shared.d.ts"/>
///<reference path="..\AppInst.ts"/>
// this module is used to initialize the Hose page to have app context sense
var AppApi;
(function (AppApi) {
    // Adds a handler for the specified control name
    function AddControlHandler(controlName, handler) {
        if (!controlHandlers[controlName]) {
            controlHandlers[controlName] = handler;
        }
    }
    AppApi.AddControlHandler = AddControlHandler;
    // The map of handlers for each control type
    var controlHandlers = {};
    // holding a cache of current page apps
    var pageApps = null;
    var instrumentationEnabled = typeof (AppInst) != 'undefined';
    // update app
    function updateApp(app) {
        if (pageApps && app) {
            var elements = pageApps[app.id];
            if (elements) {
                for (var i = 0; i < elements.length; ++i) {
                    updateAppElement(elements[i], app);
                }
            }
        }
    }
    // Invokes the control-specific handler
    function updateAppElement(element, app) {
        var hideIfNotInstalled = Boolean(element.getAttribute("data-hideIfNotInstalled"));
        if (instrumentationEnabled) {
            // Setting canSubmit to 'false' here so that single payload can be submitted later for all the Apps through explicit call to AppInst.SubmitLog function.
            var canSubmit = false;
            var installState = app.installed ? 0 /* Installed */ : 1 /* NotInstalled */;
            AppInst.queueServerAppLog(element.getAttribute("h"), element.getAttribute("data-appInfoDsK"), installState, hideIfNotInstalled, canSubmit);
        }
        var controlName = element.getAttribute("data-controlName");
        if (controlName) {
            var handler = controlHandlers[controlName];
            if (handler) {
                var minVersionStr = element.getAttribute("data-minVersion");
                var additionalPropsStr = element.getAttribute("data-additionalProps");
                var installedVersion = app.installedAppVersion ? stringToVersion(app.installedAppVersion) : null;
                var requiredMinVersion = minVersionStr ? stringToVersion(minVersionStr) : null;
                var eventArgs = {
                    appElement: element,
                    appInfo: app,
                    installedVersion: installedVersion,
                    requiredMinVersion: requiredMinVersion,
                    // if the min version is not specified, no update is needed
                    updateRequired: requiredMinVersion && installedVersion ? compareAppVersions(installedVersion, requiredMinVersion) < 0 : false,
                    updateAvailable: app.updateAvailable,
                    hideIfNotInstalled: hideIfNotInstalled,
                    additionalProps: null
                };
                try {
                    eventArgs.additionalProps = additionalPropsStr ? JSON.parse(additionalPropsStr) : null;
                    handler(eventArgs);
                }
                catch (ex) {
                    // Nothing we can do, really...
                    Log.Log("Error", "AppApi", "Handler_" + controlName, false, "Tx", ex.message);
                }
                if (app.installed && hideIfNotInstalled) {
                    // Show previously hidden apps
                    element.classList.remove('b_hide');
                }
            }
        }
    }
    // Reads the app from current page
    function readApps() {
        // We create the list of apps on first call to UpdateApp
        if (pageApps) {
            return;
        }
        pageApps = {};
        var dataAttr = "data-appid";
        // Scrape the DOM to get all the DOM Elements related to apps
        var appLinks = _d.querySelectorAll("[" + dataAttr + "]");
        for (var i = 0; i < appLinks.length; i++) {
            var appLink = appLinks[i];
            if (appLink) {
                // Get the value of data - appid attribute
                var appId = appLink.getAttribute(dataAttr);
                // If the app id is valid, then add it to the collection
                if (appId) {
                    var appElementList = pageApps[appId];
                    if (appElementList) {
                        // add it to the existing collection
                        appElementList.push(appLink);
                    }
                    else {
                        // create a new list to hold apps
                        pageApps[appId] = [appLink];
                    }
                }
            }
        }
    }
    // Make an element a launch link with proper instrumentation
    function setLaunchLink(targetElement, appElement, appId, launchUrl) {
        targetElement.setAttribute("href", launchUrl);
        // This code sets proper instrumentation attribute on the launch link
        // We cannot have two identical apps within the same DOM element, for example in the same pivot. We can have two
        // identical apps on different pivots, e.g. OpenTable on About and Apps, however they will have different K values
        // so we need to select the correct sibling element which contains the launch K value to use.
        var siblingInstElement = querySelector(appElement.parentElement, "[data-launchappid='" + appId + "']");
        if (siblingInstElement) {
            var hAttr = "h";
            // data-inst will only be present behind FD
            var hValue = siblingInstElement.getAttribute(hAttr);
            if (hValue && hValue.length > 0) {
                targetElement.setAttribute(hAttr, hValue);
            }
        }
    }
    AppApi.setLaunchLink = setLaunchLink;
    function instrumentUpgradeLink(appElement) {
        // If upgrade link is instrumented with it's own InstLink and h value, then set that to be the h value of rendered link.
        // This is currently applicable for Windows app links which use separate link for upgrade state.
        var upgradeLinkElement = querySelector(appElement.parentElement, "[data-linkRole='Upgrade']");
        if (upgradeLinkElement) {
            var hUpgradeLink = upgradeLinkElement.getAttribute("h");
            if (hUpgradeLink) {
                appElement.setAttribute("h", hUpgradeLink);
            }
        }
    }
    AppApi.instrumentUpgradeLink = instrumentUpgradeLink;
    // Shell will call this method to update app info with app list
    // This function name and its namespace can't be changed.
    function UpdateAppInfo(apps) {
        if (apps) {
            // This will only read the app element list once, caching it for all subsequent calls
            readApps();
            for (var i = 0; i < apps.length; ++i) {
                updateApp(apps[i]);
            }
        }
        // At this point, we have enqueued the logs for all the app links through AppInst.queueServerAppLog function calls.
        // For perf reasons, we submit them all at once in single payload through the following function call.
        if (instrumentationEnabled) {
            AppInst.submitLog();
        }
    }
    AppApi.UpdateAppInfo = UpdateAppInfo;
    function stringToVersion(versionStr) {
        return versionStr.split('.').map(function (s) { return Number(s); });
    }
    // Version comparison function
    function compareAppVersions(version1, version2) {
        var commonLength = Math.min(version1.length, version2.length);
        for (var i = 0; i < commonLength; i++) {
            var diff = version1[i] - version2[i];
            if (diff != 0) {
                return diff;
            }
        }
        // The longer version number is considered greater
        return version1.length - version2.length;
    }
    function querySelector(element, query) {
        return element.querySelector(query);
    }
})(AppApi || (AppApi = {}));
;// ------------------------------------------------------------------------------
// <copyright file="SmartSearch.Navigation.ts" company="Microsoft Corporation">
//     Copyright (c) Microsoft Corporation. All Rights Reserved.
//     Information Contained Herein is Proprietary and Confidential.
// </copyright>
// ------------------------------------------------------------------------------
///<reference path="..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Threshold.Utilities.d.ts" />
///<reference path="SearchApp.Mock.ts" />
///<reference path="Declarations\CortanaEnums.d.ts" />
var CachedDeviceItems = {};
var SmartSearch;
(function (SmartSearch) {
    var cortanaApp = SearchAppWrapper.CortanaApp;
    var _supportedPaths = null;
    var baseProtocol = null;
    var baseHostname = null;
    var launchApiAllowedLatency = 100;
    var apiNameAbbreviator = /(^.)|([A-Z])/g;
    function isSupportedPath(path, search) {
        var supportedPathsCollection = getSupportedPaths();
        path = cleanPath(path);
        // Cut off the leading ? in the search parameters
        if (search && search.substring) {
            search = search.substring(1);
        }
        // A path is supported if it's not blocked and there is a supported path for it
        // Check block lists first as they should be shorter
        return (!isPathSatisfied(supportedPathsCollection.Blocked, path, search) && isPathSatisfied(supportedPathsCollection.Supported, path, search));
    }
    SmartSearch.isSupportedPath = isSupportedPath;
    /// Called by test code to reset cached state between tests
    function reset() {
        _supportedPaths = null;
    }
    SmartSearch.reset = reset;
    function cleanPath(path) {
        var cleanPath = path;
        if (cleanPath) {
            var cleanPath = cleanPath.toLowerCase();
            var cutIndex = -1;
            for (var i = 0; i < cleanPath.length && cleanPath[i] === "/"; i++) {
                cutIndex = i;
            }
            if (cutIndex >= 0) {
                cleanPath = cleanPath.substring(cutIndex + 1);
            }
        }
        return cleanPath;
    }
    function getSupportedPaths() {
        if (!_supportedPaths) {
            var thresholdConfig = _TC;
            if (thresholdConfig) {
                var supportedPaths = null;
                var blockedPaths = null;
                if (thresholdConfig.SP) {
                    supportedPaths = parsePathList(thresholdConfig.SP);
                }
                if (thresholdConfig.BP) {
                    blockedPaths = parsePathList(thresholdConfig.BP);
                }
                _supportedPaths = { Supported: supportedPaths, Blocked: blockedPaths };
            }
        }
        return _supportedPaths;
    }
    function isPathSatisfied(supportedPathsMap, path, search) {
        for (var i in supportedPathsMap) {
            if (path.indexOf(i) >= 0) {
                var requiredParameters = supportedPathsMap[i];
                var allParametersPresent = true;
                // Check if this path requires specific querystring parameters
                if (requiredParameters.length > 0) {
                    // If we require some parameters we assume we don't have them until we succeed with parsing
                    allParametersPresent = false;
                    if (search) {
                        var parsedPathParameters = cleanArray(search.split("&"));
                        // If we require some parameters and have parameters in the input path then we assume we've got what we need until we find a parameter is missing
                        allParametersPresent = parsedPathParameters.length >= requiredParameters.length;
                        if (allParametersPresent) {
                            for (var requiredParameterIndex in requiredParameters) {
                                if (parsedPathParameters.indexOf(requiredParameters[requiredParameterIndex]) < 0) {
                                    // We've failed to find a required parameter, so we know this is not a match
                                    allParametersPresent = false;
                                    break;
                                }
                            }
                        }
                    }
                }
                // We found all required parameters or there were no required parameters.  This is a match.
                if (allParametersPresent) {
                    return true;
                }
            }
        }
        return false;
    }
    function parsePathList(supportedPaths) {
        var parsedPaths = {};
        supportedPaths = supportedPaths.toLowerCase();
        var supportedFullPaths = supportedPaths.split(",");
        var defaultRequiredQueryStrings = [];
        for (var supportedFullPathIndex in supportedFullPaths) {
            var pathAndQuery = cleanArray(supportedFullPaths[supportedFullPathIndex].split("?"));
            var requiredQueryStrings = defaultRequiredQueryStrings;
            if (pathAndQuery.length > 1) {
                requiredQueryStrings = cleanArray(pathAndQuery[1].split("&"));
            }
            parsedPaths[cleanPath(pathAndQuery[0])] = requiredQueryStrings;
        }
        return parsedPaths;
    }
    function cleanArray(inputArray) {
        var returnValue = inputArray;
        if (inputArray) {
            var startIndex = 0;
            var foundItemToClean = false;
            for (var i = startIndex; i < inputArray.length; i++) {
                if (!inputArray[i]) {
                    if (!foundItemToClean) {
                        returnValue = [];
                        foundItemToClean = true;
                    }
                    if (i > startIndex) {
                        returnValue.push.apply(returnValue, inputArray.slice(startIndex, i));
                    }
                    startIndex = i + 1;
                }
            }
        }
        return returnValue;
    }
    function signalComplete() {
        sj_evt.fire("NavigationComplete");
    }
    function navigateTo(targetElement, event) {
        var preventDefault = true;
        // Check if target element link is internal or external
        if (targetElement) {
            var searchUtils = ThresholdUtilities;
            var destinationPath = targetElement.pathname;
            var destinationHostname = getHostname(targetElement);
            var destinationProtocol = targetElement.protocol;
            var destinationSearch = targetElement.search;
            var destinationHash = targetElement.hash;
            if (!baseHostname || !baseProtocol) {
                getBaseUrl();
            }
            var destinationLink = targetElement.href;
            // If the link is really a javascript invocation (like "javascript:void(0)"), bail out.
            if (destinationProtocol.toLowerCase() === "javascript:") {
                return;
            }
            if (destinationPath.toLowerCase() === _w.location.pathname.toLowerCase() && destinationSearch.toLowerCase() === _w.location.search.toLowerCase() && destinationHash.toLowerCase() === _w.location.hash.toLowerCase()) {
                SharedLogHelper.LogWarning("SelfNavigate");
            }
            else if (destinationLink) {
                if (!destinationHostname) {
                    destinationHostname = baseHostname; // automatically accquire current domain for relative links
                }
                // Determine if a link is relative.
                // Handle a weird case where the url is ms-windows-store:PDP?PFN=..., no host, and "ms-windows-store:" protocol
                var isRelative = (!destinationProtocol || destinationProtocol.indexOf("http") === 0) && (destinationHostname === baseHostname || destinationHostname === getHostname(location));
                var urlType = getUrlType(destinationPath, destinationSearch, destinationHostname, isRelative);
                var launcher = cortanaApp.launcher;
                switch (urlType) {
                    case 5 /* Search */:
                    case 3 /* Navigation */:
                        if (isRelative) {
                            rebaseLink(targetElement);
                            // Need to refresh after changing the link properties
                            destinationLink = targetElement.href;
                        }
                        if (urlType === 5 /* Search */) {
                            // Force Cat3b (search)
                            var joiningChar = destinationLink.indexOf("?") === -1 ? "?" : "&";
                            destinationLink += joiningChar + "persona=0";
                        }
                        var navigateWebViewFunctionName = "navigateWebViewAsync";
                        var launchWebContentFunctionName = "launchWebContent";
                        var thresholdConfig = _TC;
                        if (thresholdConfig && thresholdConfig.NW && launcher[launchWebContentFunctionName]) {
                            var launchOptions = launcher.createWebContentLaunchOptions();
                            launchOptions.uri = destinationLink;
                            searchUtils.wrapSynchronousApiCall(launcher, launchWebContentFunctionName, createInstrumentationKey(launchWebContentFunctionName), null, launchOptions);
                            signalComplete();
                        }
                        else if (cortanaApp[navigateWebViewFunctionName]) {
                            searchUtils.wrapApiCallWithTimeout(cortanaApp, navigateWebViewFunctionName, createInstrumentationKey(navigateWebViewFunctionName), destinationLink, launchApiAllowedLatency, null, destinationLink).done(signalComplete);
                        }
                        else {
                            // We're in charge of the actual navigation
                            preventDefault = false;
                        }
                        break;
                    case 0 /* App */:
                        var options = null;
                        var appContext = targetElement.getAttribute("data-appcontext");
                        if (appContext) {
                            options = launcher.createAppLaunchOptions();
                            options.appContext = appContext;
                        }
                        var itemId = targetElement.getAttribute("data-appid");
                        if (itemId) {
                            var itemSource = targetElement.getAttribute("data-source");
                            var deviceItem = CachedDeviceItems[itemId + ":" + itemSource];
                            if (deviceItem) {
                                var launchSearchItemAsyncPromise;
                                var functionName = "launchSearchItemAsync";
                                if (options) {
                                    launchSearchItemAsyncPromise = searchUtils.wrapApiCallWithTimeout(launcher, functionName, createInstrumentationKey(functionName), deviceItem.id, launchApiAllowedLatency, null, deviceItem, options);
                                }
                                else {
                                    launchSearchItemAsyncPromise = searchUtils.wrapApiCallWithTimeout(launcher, functionName, createInstrumentationKey(functionName), deviceItem.id, launchApiAllowedLatency, null, deviceItem);
                                }
                                launchSearchItemAsyncPromise.done(signalComplete);
                            }
                            else {
                                var itemType = targetElement.getAttribute("data-itemtype");
                                var functionName = itemType && itemType === "settings" ? "findSettingsAsync" : "findAppsAsync";
                                searchUtils.wrapApiCallWithTimeout(cortanaApp.searchResultsView.deviceSearch, functionName, createInstrumentationKey(functionName), "Navigation", launchApiAllowedLatency, null, [itemId]).then(sj_df(launchFirstFoundItem, options));
                            }
                        }
                        break;
                    case 4 /* Experience */:
                        var experienceName = targetElement.getAttribute("data-experiencename");
                        if (experienceName) {
                            SearchAppWrapper.CortanaApp.launchExperienceByName(experienceName, null);
                        }
                        break;
                    case 2 /* Explore */:
                        var destination = targetElement.getAttribute("data-dest");
                        if (destination) {
                            var provider = targetElement.getAttribute("data-provider");
                            if (provider) {
                                launcher.launchSearchInApp(destination, ThresholdUtilities.getDecodedQuery(_w.location.toString()), provider);
                            }
                            else {
                                launcher.launchSearchInApp(destination, ThresholdUtilities.getDecodedQuery(_w.location.toString()));
                            }
                            signalComplete();
                        }
                        break;
                    case 1 /* Web */:
                        if (isRelative) {
                            rebaseLink(targetElement);
                            // Need to refresh after changing the link properties
                            destinationLink = targetElement.href;
                            // Instrument the time of the click to allow us to join the impressions. These requests are from two
                            // different apps, so will be seen as 2 different users, making it difficult to measure e2e perf from
                            // app click to browser page load without this query param.
                            var joiningChar = destinationLink.indexOf("?") === -1 ? "?" : "&";
                            destinationLink += joiningChar + "ts=" + sb_gt();
                            if (_G.nclid) {
                                destinationLink += "&nclid=" + _G.nclid;
                            }
                        }
                        var functionName = "launchUriAsync";
                        searchUtils.wrapApiCallWithTimeout(launcher, functionName, createInstrumentationKey(functionName), "Navigation", launchApiAllowedLatency, null, destinationLink).then(signalComplete);
                        break;
                }
            }
        }
        if (event && preventDefault) {
            event.preventDefault();
        }
    }
    ;
    function createInstrumentationKey(apiName) {
        return apiName.match(apiNameAbbreviator).join("").toUpperCase();
    }
    function launchFirstFoundItem(result, options) {
        if (result != null) {
            for (var i in result) {
                var currentResult = result[i];
                // This check seems unecessary, but the mapping returned maps IDs to empty objects when it fails to find it on the machine.
                if (currentResult && currentResult.id) {
                    var functionName = "launchSearchItemAsync";
                    ThresholdUtilities.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp.launcher, functionName, createInstrumentationKey(functionName), null, launchApiAllowedLatency, null, currentResult, options).then(signalComplete);
                    break;
                }
            }
        }
    }
    function getUrlType(destinationPath, destinationSearch, destinationHostname, isRelative) {
        if (isRelative && isSupportedPath(destinationPath, destinationSearch)) {
            // This is a requery on search
            if (destinationPath === "search" || destinationPath === "/search") {
                return 5 /* Search */;
            }
            // This is a navigation link to another bing page
            return 3 /* Navigation */;
        }
        else if (destinationHostname === "ms-smartsearch") {
            if (destinationPath === "app" || destinationPath === "/app") {
                return 0 /* App */;
            }
            else if (destinationPath === "searchInApp" || destinationPath === "/searchInApp") {
                return 2 /* Explore */;
            }
            else if (destinationPath === "experience" || destinationPath === "/experience") {
                return 4 /* Experience */;
            }
        }
        // Any other links should be launched in browser.
        return 1 /* Web */;
    }
    ;
    function onClickHandler(evt) {
        if (!evt.defaultPrevented) {
            var element = evt.target;
            var targetElement = getParentContainer(element, "A");
            if (targetElement) {
                navigateTo(targetElement, evt);
            }
        }
    }
    ;
    function getParentContainer(target, tagName) {
        for (; target && target !== document; target = target.parentNode) {
            if (target.tagName === tagName) {
                return target;
            }
        }
    }
    ;
    function getBaseUrl() {
        if (_w["_TH_BU"]) {
            var baseUrlPieces = _TH_BU.split("//", 2);
            if (baseUrlPieces.length === 2) {
                baseProtocol = baseUrlPieces[0];
                baseHostname = baseUrlPieces[1];
                return;
            }
        }
        baseProtocol = location.protocol;
        baseHostname = getHostname(location);
    }
    function rebaseLink(element) {
        element.protocol = baseProtocol;
        element.hostname = baseHostname;
        element.port = baseProtocol === "https:" ? "443" : "80";
    }
    function getHostname(element) {
        if (!element) {
            return null;
        }
        var hostname = element.hostname;
        if (!hostname) {
            return null;
        }
        // Microsoft Edge drops the [ ] for IPv6 urls, and we cannot actually navigate to IPv6 hosts without them.
        // Add them if they're missing.
        if (hostname.indexOf(":") >= 0 && hostname.indexOf("[") < 0) {
            hostname = "[" + hostname + "]";
        }
        return hostname;
    }
    sj_be(_w, "click", onClickHandler);
    var UrlType;
    (function (UrlType) {
        UrlType[UrlType["App"] = 0] = "App";
        UrlType[UrlType["Web"] = 1] = "Web";
        UrlType[UrlType["Explore"] = 2] = "Explore";
        UrlType[UrlType["Navigation"] = 3] = "Navigation";
        UrlType[UrlType["Experience"] = 4] = "Experience";
        UrlType[UrlType["Search"] = 5] = "Search";
    })(UrlType || (UrlType = {}));
})(SmartSearch || (SmartSearch = {}));
;// ------------------------------------------------------------------------------
// <copyright file="SmartSearch.ts" company="Microsoft Corporation">
//     Copyright (c) Microsoft Corporation. All Rights Reserved.
//     Information Contained Herein is Proprietary and Confidential.
// </copyright>
// ------------------------------------------------------------------------------
///<reference path="..\..\..\..\Shared\Content\Content\script\Declarations\AppApi.d.ts"/>
///<reference path="..\..\..\..\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Threshold.Utilities.d.ts" />
///<reference path="SmartSearch.Navigation.ts"/>
///<reference path="SearchApp.Mock.ts"/>
(function () {
    var appIdAttribute = "data-appid";
    if (typeof AppApi === "undefined" || !AppApi.UpdateAppInfo || !SearchAppWrapper.CortanaApp.searchResultsView) {
        return;
    }
    // Get app ids
    var appIds = [];
    var appLinks = document.querySelectorAll("[" + appIdAttribute + "]");
    for (var i = 0; i < appLinks.length; i++) {
        var appId = appLinks[i].getAttribute(appIdAttribute);
        if (appIds.indexOf(appId) < 0) {
            appIds.push(appId);
        }
    }
    var processApplicationMap = function (results) {
        var apps = [];
        for (var index in appIds) {
            var appId = appIds[index];
            if (results.hasKey(appId)) {
                var item = results[appId];
                if (item) {
                    var app = {
                        id: appId,
                        installedAppVersion: item.version,
                        installed: true
                    };
                    apps.push(app);
                    if (CachedDeviceItems && !CachedDeviceItems[appId]) {
                        CachedDeviceItems[appId] = item;
                    }
                }
            }
        }
        AppApi.UpdateAppInfo(apps);
        ThresholdUtilities.uploadApiTimes("ALR");
    };
    // Check the app install state and update app info, only if we have some apps to check
    if (appIds.length > 0) {
        ThresholdUtilities.wrapApiCall(SearchAppWrapper.CortanaApp.searchResultsView.deviceSearch, "findAppsAsync", "AL", "AppLinking", appIds).then(processApplicationMap);
    }
})();
;///<reference path="..\..\..\answers\services\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
// Sets a persistent cookie crumb with javascsript observations.  The browser's inner width and height, the device pixel ratio, and the UTC offset.
(function () {
    var clientCookie = "SRCHHPGUSR";
    function setHeightAndWidthCrumbs() {
        var cwCookie = sj_cook.get(clientCookie, "CW");
        if (!cwCookie || (window["sj_b"] && cwCookie != sj_b.clientWidth)) {
            sj_cook.set(clientCookie, "CW", (sb_de.clientWidth || sj_b.clientWidth).toString(), true, "/", null);
        }
        var chCookie = sj_cook.get(clientCookie, "CH");
        var clientHeight = sb_de.clientHeight.toString();
        if (!chCookie || chCookie !== clientHeight) {
            sj_cook.set(clientCookie, "CH", clientHeight, true, "/", null);
        }
    }
    function setClientCookieDataOnLoad() {
        var dprCookie = sj_cook.get(clientCookie, "DPR");
        var dpr = _w["devicePixelRatio"];
        if (dpr && (!dprCookie || parseInt(dprCookie) !== dpr)) {
            sj_cook.set(clientCookie, "DPR", dpr.toString(), true, "/", null);
        }
        var utcCookie = sj_cook.get(clientCookie, "UTC");
        var utcOffset = (new Date().getTimezoneOffset() * -1).toString();
        if (utcCookie == null || utcCookie !== utcOffset) {
            sj_cook.set(clientCookie, "UTC", utcOffset, true, "/", null);
        }
    }
    function setClientCookie() {
        setHeightAndWidthCrumbs();
        setClientCookieDataOnLoad();
    }
    sj_be(_w, "load", setClientCookie);
    sj_be(_w, "resize", setHeightAndWidthCrumbs);
})();
;/// <reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Shared.d.ts" />
/// <reference path='..\..\..\..\Shared\Content\Content\Script\Declarations\Threshold.Utilities.d.ts' />
/// <reference path="..\..\..\..\Threshold\src\Content\Script\Declarations\SearchAppWrapper.d.ts" />
/*This is a hack and temporary fix. TFS 5405929 tracks its removal as soon as LG issue is fixed for entity carousel from the backend.
invocation of "respond" API is necessary from the Cortana client perspective as it requres this API for removal of thinking canvas.
So this change is to unblock mobile2cortana flight while the right fix is being worked upon from backend side. */
(function () {
    if (SearchAppWrapper && SearchAppWrapper.CortanaApp) {
        var cat3AAnswer = _d.querySelector(".b_cat3a");
        var languageGenerationElement = cat3AAnswer && cat3AAnswer.querySelector("div[data-ssml]");
        if (languageGenerationElement) {
            ThresholdUtilities.wrapSynchronousApiCall(SearchAppWrapper.CortanaApp, "respond", null, "respond", languageGenerationElement.getAttribute("data-ssml"), languageGenerationElement.getAttribute("data-postssmlaction"), languageGenerationElement.getAttribute("data-secondarytext-small"), languageGenerationElement.getAttribute("data-secondarytext-medium"), languageGenerationElement.getAttribute("data-secondarytext-large"));
        }
        else {
            var emptySpaceString = " ";
            ThresholdUtilities.wrapSynchronousApiCall(SearchAppWrapper.CortanaApp, "respond", null, "respond", emptySpaceString, emptySpaceString, emptySpaceString, emptySpaceString, emptySpaceString);
        }
        var emotionElement = cat3AAnswer && cat3AAnswer.querySelector("div[data-emot]");
        if (emotionElement) {
            ThresholdUtilities.wrapSynchronousApiCall(SearchAppWrapper.CortanaApp, "setEmotion", null, "setEmotion", emotionElement.getAttribute("data-emot"), emotionElement.getAttribute("data-emot-size") === "large", emotionElement.hasAttribute("data-emot-overridespeaking"));
        }
    }
})();
;///<reference path="..\Declarations\Shared.d.ts" />
// Please don't change this module name - it's part of Cortana spec
var BMPage;
(function (BMPage) {
    function UpdateUserDisplayName(name) {
        if (!name) {
            return;
        }
        var userNameContainers = _d.querySelectorAll("[data-userDisplayName]");
        for (var i = 0; i < userNameContainers.length; i++) {
            var userNameContainer = userNameContainers[i];
            userNameContainer.innerText = name;
        }
    }
    BMPage.UpdateUserDisplayName = UpdateUserDisplayName;
})(BMPage || (BMPage = {}));
;CUDialog.sendAction({"CuAction":"{\"Uri\":\"action://CuOutput\",\"SystemAction\":{\"CachedQueryUri\":\"https://www.bing.com/search?q=Remind+me+to+buy+milk+at+9+o%27clock+tomorrow.\u0026input=1\u0026nclid=5843B1284CE21CF49556CE1C9F256103\u0026FORM=\",\"Uri\":\"action://Conversation/ShowUrlContent\",\"Version\":\"1.0\"},\"ConversationId\":\"42286d7b-847c-e0c5-83b0-1a1829576a20\",\"TraceId\":\"BD173DDF797A4F5BA406E39519A96088\",\"ImpressionId\":\"eb79d25414acf5972aaf91eb2256152c\",\"LgObject\":{\"Uri\":\"action://LgObject\",\"Ssml\":null,\"DisplayText\":null,\"SuggestionText\":null,\"SecondaryDisplayTextSmall\":null,\"SecondaryDisplayTextMedium\":null,\"SecondaryDisplayTextLarge\":null}}"});;///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Shared.d.ts" />
///<reference path="..\..\..\..\Threshold\src\Content\Script\Declarations\SearchAppWrapper.d.ts" />
///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Threshold.Utilities.d.ts" />
///<reference path="..\..\..\..\..\..\Sparkle\src\content\Sparkle.d.ts" />
var ReminderClickAction;
(function (ReminderClickAction) {
    function createReminderAction(SPAAction, ImpressionId) {
        //var remindButton = <HTMLElement>_ge('remindButton');
        //var title = <string>_ge('remindTitle').nodeValue.toString();
        //var date = <string>_ge('remindDate').nodeValue.toString();
        //var time = <string>_ge('remindTime').nodeValue.toString();
        //remindButton.onclick = ev => {
        //    SearchAppWrapper.CortanaApp.processNLCommandAsync(SPAAction, ImpressionId);
        //};
        //navigateToNewCard("PortableCortanaReminder:PortableCortanaReminderCreate",
        //    "PortableCortanaReminderCreateViewModel",
        //    "remindButton");
        SearchAppWrapper.CortanaApp.processNLCommandAsync(SPAAction, ImpressionId);
    }
    ReminderClickAction.createReminderAction = createReminderAction;
    function cancelReminderAction() {
        navigateToNewCard("PortableCortanaReminder:PortableCortanaReminderCancel", "PortableCortanaReminderCancelViewModel", "cancelButton");
    }
    ReminderClickAction.cancelReminderAction = cancelReminderAction;
    function navigateToNewCard(viewName, viewModel, containerId) {
        Sparkle.render(viewName, {
            uiCulture: SearchAppWrapper.CortanaApp.uiLanguage,
            properties: {
                ViewModel: viewModel
            },
            viewData: {}
        }, _ge(containerId));
    }
    ReminderClickAction.navigateToNewCard = navigateToNewCard;
    function openFirstTurnSearchRemindMeToLink(url) {
        var link = _ge('legacyRecourse');
        link.onclick = function (ev) {
            openUri(url);
        };
    }
    ReminderClickAction.openFirstTurnSearchRemindMeToLink = openFirstTurnSearchRemindMeToLink;
    function openUri(uri) {
        return ThresholdUtilities.wrapApiCall(SearchAppWrapper.CortanaApp.launcher, "launchUriAsync", uri, "SearchRemindMeTo", uri).then(closeCortana);
    }
    function closeCortana() {
        SearchAppWrapper.CortanaApp.dismissApp();
    }
})(ReminderClickAction || (ReminderClickAction = {}));
;(function () {
    function Promote() {
        var isBingSE = _w["isBingCurrentSearchDefault"];
        var setSE = _w["setBingCurrentSearchDefault"];
        if (setSE && isBingSE) {
            var promptNow = false;
            var currDate = new Date();
            if (typeof (Storage) !== "undefined" && _w.localStorage) {
                var tempFlagData = localStorage.getItem("lastSEPromptShownFlag");
                if (tempFlagData != null && tempFlagData != "false") {
                    if (isBingSE() == false) {
                        Log.Log("SetSE", "SetSE", "setBingCurrentSearchDefault", true, "PSE", "Non-Bing", "SE", "Non-Bing", "UA", "Denied");
                    }
                    else {
                        Log.Log("SetSE", "SetSE", "setBingCurrentSearchDefault", true, "PSE", "Non-Bing", "SE", "Bing", "UA", "Accepted");
                    }
                    localStorage.setItem("lastSEPromptShownFlag", false);
                }
                if (!localStorage.getItem("lastSEPromptDate")) {
                    promptNow = true;
                }
                else {
                    if (currDate.getTime() - new Date(localStorage.getItem("lastSEPromptDate")).getTime() > 1000 * 60 * 60 * 24 * 7) {
                        promptNow = true;
                    }
                    else {
                        promptNow = false;
                    }
                }
            }
            if (promptNow && isBingSE() == false) {
                try {
                    localStorage.setItem("lastSEPromptDate", currDate);
                    localStorage.setItem("lastSEPromptShownFlag", true);
                    var result = setSE();
                }
                catch (err) {
                    promptNow = false;
                }
            }
        }
    }
    sj_be(_w, "load", Promote);
})();
;var VRHH=VRHH||{};VRHH.el=VRHH.el||[];VRHH.el.push('b_results');//HoverUtils will previde some common function for hover related 
///<reference path="..\..\..\answers\services\Shared\Content\Content\script\Declarations\Shared.d.ts"/>
var HoverUtils;
(function (HoverUtils) {
    function getClassName(e) {
        if (!e) {
            return "";
        }
        var name = e.className || "";
        if (typeof (name) == "string") {
            return name;
        }
        else {
            return name.baseVal || "";
        }
    }
    HoverUtils.getClassName = getClassName;
    function hasClass(e, name) {
        var className = getClassName(e);
        var re = new RegExp(name, "g");
        return re.test(className);
    }
    HoverUtils.hasClass = hasClass;
    function hasAttribute(element, attr) {
        return element.hasAttribute ? element.hasAttribute(attr) : element[attr] !== undefined;
    }
    HoverUtils.hasAttribute = hasAttribute;
    function getFirstElementByClassName(className, object) {
        var els = getElementsByClassName(className, object);
        if (!els || els.length < 1) {
            return null;
        }
        return els[0];
    }
    HoverUtils.getFirstElementByClassName = getFirstElementByClassName;
    function getElementsByClassName(className, parentElement) {
        var element = (parentElement || document);
        if (typeof element === 'undefined' || element === null) {
            return null;
        }
        if (typeof element.getElementsByClassName === 'function') {
            return element.getElementsByClassName(className);
        }
        else {
            var children = element.getElementsByTagName('*');
            var childElements = [];
            var child;
            for (var i = 0, length = children.length; i < length; i++) {
                child = children[i];
                if (hasClass(child, className)) {
                    childElements.push(child);
                }
            }
            return childElements;
        }
    }
    HoverUtils.getElementsByClassName = getElementsByClassName;
    function hideElementByClassName(element) {
        if (element) {
            if (element.className.indexOf(' hi') < 0) {
                element.className += ' hi';
            }
        }
    }
    HoverUtils.hideElementByClassName = hideElementByClassName;
    function showElementByClassName(element) {
        if (element) {
            if (element.className.indexOf(' hi') >= 0) {
                element.className = element.className.replace(' hi', '');
            }
        }
    }
    HoverUtils.showElementByClassName = showElementByClassName;
    function preventEvent(eventObject) {
        sj_sp(eventObject);
        sj_pd(eventObject);
        return false;
    }
    HoverUtils.preventEvent = preventEvent;
})(HoverUtils || (HoverUtils = {}));
;///<reference path="..\..\..\..\Shared\Content\Content\Script\Declarations\Shared.d.ts" />
///<reference path="Declarations\PageDebug.d.ts" />
/*
 * This module defines methods to set PageDebug properties.
 */
var Feedback;
(function (Feedback) {
    var DebugCollector;
    (function (DebugCollector) {
        'use strict';
        function GetPageDebug() {
            _w["PageDebug"] = (typeof _w["PageDebug"] !== "undefined") ? _w["PageDebug"] : {};
            return _w["PageDebug"];
        }
        function SetFederationDebugInfo(debugInfo) {
            if (debugInfo.length < 1)
                return;
            GetPageDebug().FederationDebugInfo = debugInfo;
        }
        DebugCollector.SetFederationDebugInfo = SetFederationDebugInfo;
    })(DebugCollector = Feedback.DebugCollector || (Feedback.DebugCollector = {}));
})(Feedback || (Feedback = {}));
;Feedback.DebugCollector.SetFederationDebugInfo('QueryID : 4d2c66a560d3466999faf0a27b1706df');;
//]]>--></div></div><script type="text/javascript">//<![CDATA[
_G.HT=new Date;
//]]></script></body></html>